<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>AnalyzingCompiler.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> xsbt

	<span class="keyword">import</span> sbt.ComponentManager
	<span class="keyword">import</span> xsbti.{AnalysisCallback, Logger =&gt; xLogger}
	<span class="keyword">import</span> java.io.File
	<span class="keyword">import</span> java.net.{URL, URLClassLoader}

<span class="comment">/** Interface to the Scala compiler that uses the dependency analysis plugin.  This class uses the Scala library and compiler
* provided by scalaInstance.  This class requires a ComponentManager in order to obtain the interface code to scalac and
* the analysis plugin.  Because these call Scala code for a different Scala version than the one used for this class, they must
* be compiled for the version of Scala being used.*/</span>
<span class="keyword">class</span> <a title="class AnalyzingCompiler extends java.lang.Object with NotNull with ScalaObject" id="7099">AnalyzingCompiler</a>(<span class="keyword">val</span> <a title="xsbt.ScalaInstance" id="15491">scalaInstance</a>: <a href="ScalaInstance.scala.html#7486" title="xsbt.ScalaInstance">ScalaInstance</a>, <span class="keyword">val</span> <a title="sbt.ComponentManager" id="15492">manager</a>: <a href="ComponentManager.scala.html#10410" title="sbt.ComponentManager">ComponentManager</a>, <span class="keyword">val</span> <a title="xsbt.ClasspathOptions" id="15493">cp</a>: <a href="CompilerArguments.scala.html#7348" title="xsbt.ClasspathOptions">ClasspathOptions</a>, <a title="xsbt.CompileLogger" id="15494">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>) <span class="keyword">extends</span> <a title="NotNull" id="193">NotNull</a>
{
	<span class="keyword">def</span> <a title="(xsbt.ScalaInstance,sbt.ComponentManager,xsbt.CompileLogger)xsbt.AnalyzingCompiler" id="14987" class="keyword">this</a>(<a title="xsbt.ScalaInstance" id="16007">scalaInstance</a>: <a href="ScalaInstance.scala.html#7486" title="xsbt.ScalaInstance">ScalaInstance</a>, <a title="sbt.ComponentManager" id="16008">manager</a>: <a href="ComponentManager.scala.html#10410" title="sbt.ComponentManager">ComponentManager</a>, <a title="xsbt.CompileLogger" id="16009">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>) = <a href="#7099" title="AnalyzingCompiler.this.type" class="keyword">this</a>(<a href="#16007" title="xsbt.ScalaInstance">scalaInstance</a>, <a href="#16008" title="sbt.ComponentManager">manager</a>, <a href="CompilerArguments.scala.html#7349" title="object xsbt.ClasspathOptions">ClasspathOptions</a>.<a href="CompilerArguments.scala.html#16014" title="=&gt; xsbt.ClasspathOptions">auto</a>, <a href="#16009" title="xsbt.CompileLogger">log</a>)
	<span class="keyword">def</span> <a title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String],xsbti.AnalysisCallback,Int,xsbt.CompileLogger)Unit" id="14988">apply</a>(<a title="Set[java.io.File]" id="16039">sources</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Set[java.io.File]" id="16040">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="java.io.File" id="16041">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="16042">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="xsbti.AnalysisCallback" id="16043">callback</a>: <a href="xsbti/AnalysisCallback.java.html#7616" title="xsbti.AnalysisCallback">AnalysisCallback</a>, <a title="Int" id="16044">maximumErrors</a>: <span title="Int">Int</span>, <a title="xsbt.CompileLogger" id="16045">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>)
	{
		<span class="keyword">val</span> <a title="Seq[String]" id="16825">arguments</a> = (<a href="CompilerArguments.scala.html#16831" title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String])Seq[String]" class="keyword">new</a> <a href="CompilerArguments.scala.html#7366" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#15493" title="=&gt; xsbt.ClasspathOptions">cp</a>))(<a href="#16039" title="Set[java.io.File]">sources</a>, <a href="#16040" title="Set[java.io.File]">classpath</a>, <a href="#16041" title="java.io.File">outputDirectory</a>, <a href="#16042" title="Seq[String]">options</a>)
		<a href="#14992" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.CompilerInterface&quot;)" class="string">&quot;xsbt.CompilerInterface&quot;</span>, <a href="#16045" title="xsbt.CompileLogger">log</a>)(
			<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[xsbti.AnalysisCallback]">classOf</span>[AnalysisCallback], <span title="java.lang.Class[Int]">classOf</span>[Int], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger] ) (
			<a href="#16825" title="Seq[String]">arguments</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>] : <span title="Array[String]">Array</span>[String], <a href="#16043" title="xsbti.AnalysisCallback">callback</a>, <a href="#16044" title="implicit scala.Predef.int2Integer : (Int)java.lang.Integer">maximumErrors</a>: java.lang.<span title="java.lang.Integer">Integer</span>, <a href="#16045" title="xsbt.CompileLogger">log</a> )
	}
	<span class="keyword">def</span> <a title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String],Int,xsbt.CompileLogger)Unit" id="14989">doc</a>(<a title="Set[java.io.File]" id="17941">sources</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Set[java.io.File]" id="17942">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="java.io.File" id="17943">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="17944">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="Int" id="17945">maximumErrors</a>: <span title="Int">Int</span>, <a title="xsbt.CompileLogger" id="17946">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">val</span> <a title="Seq[String]" id="17947">arguments</a> = (<a href="CompilerArguments.scala.html#16831" title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String])Seq[String]" class="keyword">new</a> <a href="CompilerArguments.scala.html#7366" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#15493" title="=&gt; xsbt.ClasspathOptions">cp</a>))(<a href="#17941" title="Set[java.io.File]">sources</a>, <a href="#17942" title="Set[java.io.File]">classpath</a>, <a href="#17943" title="java.io.File">outputDirectory</a>, <a href="#17944" title="Seq[String]">options</a>)
		<a href="#14992" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.ScaladocInterface&quot;)" class="string">&quot;xsbt.ScaladocInterface&quot;</span>, <a href="#17946" title="xsbt.CompileLogger">log</a>) (<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[Int]">classOf</span>[Int], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger]) (<a href="#17947" title="Seq[String]">arguments</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>] : <span title="Array[String]">Array</span>[String], <a href="#17945" title="implicit scala.Predef.int2Integer : (Int)java.lang.Integer">maximumErrors</a>: java.lang.<span title="java.lang.Integer">Integer</span>, <a href="#17946" title="xsbt.CompileLogger">log</a>)
	}
	<span class="keyword">def</span> <a title="(Set[java.io.File],Seq[String],String,xsbt.CompileLogger)Unit" id="14990">console</a>(<a title="Set[java.io.File]" id="17951">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Seq[String]" id="17952">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="String" id="17953">initialCommands</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="17954">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">val</span> <a title="xsbt.CompilerArguments" id="17955">arguments</a> = <span title="xsbt.CompilerArguments" class="keyword">new</span> <a href="CompilerArguments.scala.html#7366" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#15493" title="=&gt; xsbt.ClasspathOptions">cp</a>)
		<span class="keyword">val</span> <a title="String" id="17956">classpathString</a> = <a href="CompilerArguments.scala.html#7367" title="object xsbt.CompilerArguments">CompilerArguments</a>.<a href="CompilerArguments.scala.html#15465" title="(Set[java.io.File])String">absString</a>(<a href="#17955" title="xsbt.CompilerArguments">arguments</a>.<a href="CompilerArguments.scala.html#16832" title="(Set[java.io.File])Set[java.io.File]">finishClasspath</a>(<a href="#17951" title="Set[java.io.File]">classpath</a>))
		<span class="keyword">val</span> <a title="java.lang.String" id="17957">bootClasspath</a> = <span title="java.lang.String" class="keyword">if</span>(<a href="#15493" title="=&gt; xsbt.ClasspathOptions">cp</a>.<a href="CompilerArguments.scala.html#15473" title="=&gt; Boolean">autoBoot</a>) <a href="#17955" title="xsbt.CompilerArguments">arguments</a>.<a href="CompilerArguments.scala.html#16836" title="=&gt; java.lang.String">createBootClasspath</a> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
		<a href="#14992" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.ConsoleInterface&quot;)" class="string">&quot;xsbt.ConsoleInterface&quot;</span>, <a href="#17954" title="xsbt.CompileLogger">log</a>) (<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger]) (<a href="#17952" title="Seq[String]">options</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>]: <span title="Array[String]">Array</span>[String], <a href="#17957" title="java.lang.String">bootClasspath</a>, <a href="#17956" title="String">classpathString</a>, <a href="#17953" title="String">initialCommands</a>, <a href="#17954" title="xsbt.CompileLogger">log</a>)
	}
	<span class="keyword">def</span> <a title="(xsbt.CompileLogger)Unit" id="14991">force</a>(<a title="xsbt.CompileLogger" id="18150">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> = <a href="#14995" title="(xsbt.CompileLogger)java.io.File">getInterfaceJar</a>(<a href="#18150" title="xsbt.CompileLogger">log</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit" id="14992">call</a>(<a title="String" id="16843">interfaceClassName</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="16844">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>)(<a title="Class[_]*" id="16845">argTypes</a>: <span title="Class[_]*">Class</span>[_]*)(<a title="AnyRef*" id="16846">args</a>: <span title="AnyRef*">AnyRef</span>*)
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="18295">interfaceClass</a> = <a href="#14994" title="(String,xsbt.CompileLogger)java.lang.Class[_]">getInterfaceClass</a>(<a href="#16843" title="String">interfaceClassName</a>, <a href="#16844" title="xsbt.CompileLogger">log</a>)
		<span class="keyword">val</span> <a title="AnyRef" id="18296">interface</a> = <a href="#18295" title="java.lang.Class[_]">interfaceClass</a>.<a title="()Any" id="3917">newInstance</a>.<a title="AnyRef" id="3446">asInstanceOf</a>[<a title="AnyRef" id="1957">AnyRef</a>]
		<span class="keyword">val</span> <a title="java.lang.reflect.Method" id="18297">method</a> = <a href="#18295" title="java.lang.Class[_]">interfaceClass</a>.<a title="(java.lang.String,java.lang.Class[_]*)java.lang.reflect.Method" id="4324">getMethod</a>(<span title="java.lang.String(&quot;run&quot;)" class="string">&quot;run&quot;</span>, <a href="#16845" title="Class[_]*">argTypes</a> : _*)
		<span class="keyword">try</span> { <a href="#18297" title="java.lang.reflect.Method">method</a>.<a title="(Any,java.lang.Object*)java.lang.Object" id="19399">invoke</a>(<a href="#18296" title="AnyRef">interface</a>, <a href="#16846" title="AnyRef*">args</a>: _*) }
		<span class="keyword">catch</span> { <span title="Nothing" class="keyword">case</span> <a title="java.lang.reflect.InvocationTargetException" id="19437">e</a>: java.lang.reflect.<a title="java.lang.reflect.InvocationTargetException" id="3885">InvocationTargetException</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#19437" title="java.lang.reflect.InvocationTargetException">e</a>.<a title="()java.lang.Throwable" id="19442">getCause</a> }
	}
	<span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">def</span> <a title="=&gt; java.net.URLClassLoader" id="14993">loader</a> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="18953">interfaceJar</a> = <a href="#14995" title="(xsbt.CompileLogger)java.io.File">getInterfaceJar</a>(<a href="#15494" title="xsbt.CompileLogger">log</a>)
		<span class="keyword">val</span> <a title="java.lang.ClassLoader" id="18954">dual</a> = <a href="#14997" title="(java.lang.ClassLoader,java.lang.ClassLoader)java.lang.ClassLoader">createDualLoader</a>(<a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#15012" title="=&gt; java.lang.ClassLoader">loader</a>, <a href="#7099" title="()java.lang.Class[_]" id="3454">getClass</a>.<a title="()java.lang.ClassLoader" id="3928">getClassLoader</a>) <span class="comment">// this goes to scalaLoader for scala classes and sbtLoader for xsbti classes</span>
		<span title="java.net.URLClassLoader" class="keyword">new</span> <a title="java.net.URLClassLoader" id="4398">URLClassLoader</a>(<a title="(java.net.URL*)Array[java.net.URL]" id="1037">Array</a>(<a href="#18953" title="java.io.File">interfaceJar</a>.<a title="()java.net.URI" id="16769">toURI</a>.<a title="()java.net.URL" id="19306">toURL</a>), <a href="#18954" title="java.lang.ClassLoader">dual</a>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String,xsbt.CompileLogger)java.lang.Class[_]" id="14994">getInterfaceClass</a>(<a title="String" id="18298">name</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="18299">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>) = <a title="object java.lang.Class" id="1616">Class</a>.<a title="(java.lang.String,Boolean,java.lang.ClassLoader)java.lang.Class[_]" id="3915">forName</a>(<a href="#18298" title="String">name</a>, <span title="Boolean(true)" class="keyword">true</span>, <a href="#14993" title="=&gt; java.net.URLClassLoader">loader</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(xsbt.CompileLogger)java.io.File" id="14995">getInterfaceJar</a>(<a title="xsbt.CompileLogger" id="18151">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>) =
	{
		<span class="comment">// this is the instance used to compile the interface component</span>
		<span class="keyword">val</span> <a title="xsbt.ComponentCompiler" id="18153">componentCompiler</a> = <a href="#14996" title="(xsbt.CompileLogger)xsbt.ComponentCompiler">newComponentCompiler</a>(<a href="#18151" title="xsbt.CompileLogger">log</a>)
		<a href="#18151" title="xsbt.CompileLogger">log</a>.<a href="CompileLogger.scala.html#15487" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Getting &quot;)" class="string">&quot;Getting &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="ComponentCompiler.scala.html#7280" title="object xsbt.ComponentCompiler">ComponentCompiler</a>.<a href="ComponentCompiler.scala.html#18200" title="=&gt; java.lang.String">compilerInterfaceID</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; from component compiler for Scala &quot;)" class="string">&quot; from component compiler for Scala &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#15010" title="=&gt; String">version</a>)
		<a href="ComponentCompiler.scala.html#18163" title="(String)java.io.File">componentCompiler</a>(<a href="ComponentCompiler.scala.html#7280" title="object xsbt.ComponentCompiler">ComponentCompiler</a>.<a href="ComponentCompiler.scala.html#18200" title="=&gt; java.lang.String">compilerInterfaceID</a>)
	}
	<span class="keyword">def</span> <a title="(xsbt.CompileLogger)xsbt.ComponentCompiler" id="14996">newComponentCompiler</a>(<a title="xsbt.CompileLogger" id="18154">log</a>: <a href="CompileLogger.scala.html#6844" title="xsbt.CompileLogger">CompileLogger</a>) = <span title="xsbt.ComponentCompiler" class="keyword">new</span> <a href="ComponentCompiler.scala.html#7279" title="xsbt.ComponentCompiler">ComponentCompiler</a>(<span title="xsbt.RawCompiler" class="keyword">new</span> <a href="RawCompiler.scala.html#7147" title="xsbt.RawCompiler">RawCompiler</a>(<a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="CompilerArguments.scala.html#7349" title="object xsbt.ClasspathOptions">ClasspathOptions</a>.<a href="CompilerArguments.scala.html#16014" title="=&gt; xsbt.ClasspathOptions">auto</a>, <a href="#18154" title="xsbt.CompileLogger">log</a>), <a href="#15492" title="=&gt; sbt.ComponentManager">manager</a>)
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(java.lang.ClassLoader,java.lang.ClassLoader)java.lang.ClassLoader" id="14997">createDualLoader</a>(<a title="java.lang.ClassLoader" id="18955">scalaLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="java.lang.ClassLoader" id="18956">sbtLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> =
	{
		<span class="keyword">val</span> <a title="(String) =&gt; Boolean" id="19448">xsbtiFilter</a> = (<a title="String" id="19451">name</a>: <span title="String">String</span>) =&gt; <a href="#19451" title="String">name</a>.<a title="(java.lang.String)Boolean" id="6374">startsWith</a>(<span title="java.lang.String(&quot;xsbti.&quot;)" class="string">&quot;xsbti.&quot;</span>)
		<span class="keyword">val</span> <a title="(String) =&gt; Boolean" id="19449">notXsbtiFilter</a> = (<a title="String" id="19454">name</a>: <span title="String">String</span>) =&gt; <a title="=&gt; Boolean" id="2690">!</a><a href="#19448" title="(String)Boolean" id="15917">xsbtiFilter</a>(<a href="#19454" title="String">name</a>)
		<span title="xsbt.DualLoader" class="keyword">new</span> <a href="DualLoader.scala.html#7480" title="xsbt.DualLoader">DualLoader</a>(<a href="#18955" title="java.lang.ClassLoader">scalaLoader</a>, <a href="#19449" title="(String) =&gt; Boolean">notXsbtiFilter</a>, <a title="String" id="19491">x</a> =&gt; <span title="Boolean(true)" class="keyword">true</span>, <a href="#18956" title="java.lang.ClassLoader">sbtLoader</a>, <a href="#19448" title="(String) =&gt; Boolean">xsbtiFilter</a>, <a title="String" id="19493">x</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>)
	}
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="14998">toString</a> = <span title="java.lang.String(&quot;Analyzing compiler (Scala &quot;)" class="string">&quot;Analyzing compiler (Scala &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#15491" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#15022" title="=&gt; java.lang.String">actualVersion</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
}
        </pre>
    </body>
</html>