<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/impl/MapUtilities.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> sbt.impl
<span class="keyword">import</span> sbt._

<span class="keyword">import</span> java.util.Properties
<span class="keyword">import</span> java.io.{File, FileInputStream, FileOutputStream, InputStream, OutputStream}
<span class="keyword">import</span> scala.collection.mutable.{HashMap, HashSet, ListBuffer, Map, Set}

<span class="keyword">private</span>[sbt] <span class="keyword">object</span> <a title="object sbt.impl.PropertiesUtilities" id="13475">PropertiesUtilities</a>
{
	<span class="keyword">def</span> <a title="(java.util.Properties,String,sbt.Path,sbt.Logger)Option[String]" id="56312">write</a>(<a title="java.util.Properties" id="56315">properties</a>: <span title="java.util.Properties">Properties</span>, <a title="String" id="56316">label</a>: <span title="String">String</span>, <a title="sbt.Path" id="56317">to</a>: <a href="../Path.scala.html#10152" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="56318">log</a>: <a href="../Logger.scala.html#11784" title="sbt.Logger">Logger</a>) =
		<a href="../FileUtilities.scala.html#9046" title="object sbt.FileUtilities">FileUtilities</a>.<a href="../FileUtilities.scala.html#15307" title="(java.io.File,sbt.Logger)((java.io.OutputStream) =&gt; Option[String])Option[String]">writeStream</a>(<a href="#56317" title="sbt.Path">to</a>.<a href="../Path.scala.html#17865" title="=&gt; java.io.File">asFile</a>, <a href="#56318" title="sbt.Logger">log</a>)(<a title="java.io.OutputStream" id="56325">output</a> =&gt; { <a href="#56315" title="java.util.Properties">properties</a>.<a title="(java.io.OutputStream,java.lang.String)Unit" id="56190">store</a>(<a href="#56325" title="java.io.OutputStream">output</a>, <a href="#56316" title="String">label</a>); <span title="object None">None</span> })
	<span class="keyword">def</span> <a title="(java.util.Properties,sbt.Path,sbt.Logger)Option[String]" id="56313">load</a>(<a title="java.util.Properties" id="58297">properties</a>: <span title="java.util.Properties">Properties</span>, <a title="sbt.Path" id="58298">from</a>: <a href="../Path.scala.html#10152" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="58299">log</a>: <a href="../Logger.scala.html#11784" title="sbt.Logger">Logger</a>): <span title="Option[String]">Option</span>[String] =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="58300">file</a> = <a href="#58298" title="sbt.Path">from</a>.<a href="../Path.scala.html#17865" title="=&gt; java.io.File">asFile</a>
		<span title="Option[String]" class="keyword">if</span>(<a href="#58300" title="java.io.File">file</a>.<a title="()Boolean" id="16021">exists</a>)
			<a href="../FileUtilities.scala.html#9046" title="object sbt.FileUtilities">FileUtilities</a>.<a href="../FileUtilities.scala.html#15309" title="(java.io.File,sbt.Logger)((java.io.InputStream) =&gt; Option[String])Option[String]">readStream</a>(<a href="#58300" title="java.io.File">file</a>, <a href="#58299" title="sbt.Logger">log</a>)( <a title="java.io.InputStream" id="58309">input</a> =&gt; { <a href="#58297" title="java.util.Properties">properties</a>.<a title="(java.io.InputStream)Unit" id="56188">load</a>(<a href="#58309" title="java.io.InputStream">input</a>); <span title="object None">None</span> })
		<span class="keyword">else</span>
			<span title="object None">None</span>
	}
	<span class="keyword">def</span> <a title="(java.util.Properties)Iterable[String]" id="56314">propertyNames</a>(<a title="java.util.Properties" id="58310">properties</a>: <span title="java.util.Properties">Properties</span>): <span title="Iterable[String]">Iterable</span>[String] =
		wrap.<a href="../wrap/Wrappers.scala.html#14084" title="object sbt.wrap.Wrappers">Wrappers</a>.<a href="../wrap/Wrappers.scala.html#18043" title="(java.util.Enumeration[?0])List[?0]">toList</a>(<a href="#58310" title="java.util.Properties">properties</a>.<a title="()java.util.Enumeration[_]" id="56197">propertyNames</a>).<span title="((?0) =&gt; java.lang.String)List[java.lang.String]">map</span>(<a href="#58327" title="?0">_</a>.<a title="()java.lang.String" id="3448">toString</a>)
}

<span class="keyword">private</span>[sbt] <span class="keyword">object</span> <a title="object sbt.impl.MapUtilities" id="13661">MapUtilities</a>
{
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,Value],String,sbt.Path,sbt.Logger)(implicit sbt.Format[Key],sbt.Format[Value])Option[String]" id="26787">write</a>[<a title="&gt;: Nothing &lt;: Any" id="26790">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="26791">Value</a>](<a title="scala.collection.mutable.Map[Key,Value]" id="58329">map</a>: <span title="scala.collection.mutable.Map[Key,Value]">Map</span>[Key, Value], <a title="String" id="58330">label</a>: <span title="String">String</span>, <a title="sbt.Path" id="58331">to</a>: <a href="../Path.scala.html#10152" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="58332">log</a>: <a href="../Logger.scala.html#11784" title="sbt.Logger">Logger</a>)(<span class="keyword">implicit</span> <a title="sbt.Format[Key]" id="58333">keyFormat</a>: <a href="../Format.scala.html#9741" title="sbt.Format[Key]">Format</a>[Key], <a title="sbt.Format[Value]" id="58334">valueFormat</a>: <a href="../Format.scala.html#9741" title="sbt.Format[Value]">Format</a>[Value]): <span title="Option[String]">Option</span>[String] =
	{
		<span class="keyword">val</span> <a title="java.util.Properties" id="58335">properties</a> = <span title="java.util.Properties" class="keyword">new</span> <span title="java.util.Properties">Properties</span>
		<a href="#58329" title="scala.collection.mutable.Map[Key,Value]">map</a> <span title="(((Key, Value)) =&gt; Unit)Unit">foreach</span> { <a title="(Key, Value)" id="58343">pair</a> =&gt; <a href="#58335" title="java.util.Properties">properties</a>.<a title="(java.lang.String,java.lang.String)java.lang.Object" id="56187">setProperty</a>(<a href="#58333" title="sbt.Format[Key]">keyFormat</a>.<a href="../Format.scala.html#16330" title="(Key)String">toString</a>(<a href="#58343" title="(Key, Value)">pair</a>.<a title="=&gt; Key" id="17583">_1</a>), <a href="#58334" title="sbt.Format[Value]">valueFormat</a>.<a href="../Format.scala.html#16330" title="(Value)String">toString</a>(<a href="#58343" title="(Key, Value)">pair</a>.<a title="=&gt; Value" id="17585">_2</a>)) }
		<a href="#13475" title="object sbt.impl.PropertiesUtilities">PropertiesUtilities</a>.<a href="#56312" title="(java.util.Properties,String,sbt.Path,sbt.Logger)Option[String]">write</a>(<a href="#58335" title="java.util.Properties">properties</a>, <a href="#58330" title="String">label</a>, <a href="#58331" title="sbt.Path">to</a>, <a href="#58332" title="sbt.Logger">log</a>)
	}
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,Value],sbt.Path,sbt.Logger)(implicit sbt.Format[Key],sbt.Format[Value])Option[String]" id="26792">read</a>[<a title="&gt;: Nothing &lt;: Any" id="26795">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="26796">Value</a>](<a title="scala.collection.mutable.Map[Key,Value]" id="48160">map</a>: <span title="scala.collection.mutable.Map[Key,Value]">Map</span>[Key, Value], <a title="sbt.Path" id="48161">from</a>: <a href="../Path.scala.html#10152" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="48162">log</a>: <a href="../Logger.scala.html#11784" title="sbt.Logger">Logger</a>)(<span class="keyword">implicit</span> <a title="sbt.Format[Key]" id="48163">keyFormat</a>: <a href="../Format.scala.html#9741" title="sbt.Format[Key]">Format</a>[Key], <a title="sbt.Format[Value]" id="48164">valueFormat</a>: <a href="../Format.scala.html#9741" title="sbt.Format[Value]">Format</a>[Value]): <span title="Option[String]">Option</span>[String] =
	{
		<a href="#48160" title="scala.collection.mutable.Map[Key,Value]">map</a>.<a title="()Unit" id="24192">clear</a>
		<span class="keyword">val</span> <a title="java.util.Properties" id="58346">properties</a> = <span title="java.util.Properties" class="keyword">new</span> <span title="java.util.Properties">Properties</span>
		<a href="#13475" title="object sbt.impl.PropertiesUtilities">PropertiesUtilities</a>.<a href="#56313" title="(java.util.Properties,sbt.Path,sbt.Logger)Option[String]">load</a>(<a href="#58346" title="java.util.Properties">properties</a>, <a href="#48161" title="sbt.Path">from</a>, <a href="#48162" title="sbt.Logger">log</a>) <a title="(=&gt; Option[String])Option[String]" id="19023">orElse</a>
		{
			<span class="keyword">for</span>(<a title="((String) =&gt; Unit)Unit" id="58355">name</a> &lt;- <a href="#13475" title="object sbt.impl.PropertiesUtilities">PropertiesUtilities</a>.<a href="#56314" title="(java.util.Properties)Iterable[String]">propertyNames</a>(<a href="#58346" title="java.util.Properties">properties</a>))
				<a href="#48160" title="scala.collection.mutable.Map[Key,Value]">map</a>.<span title="(Key,Value)Option[Value]">put</span>( <a href="#48163" title="sbt.Format[Key]">keyFormat</a>.<a href="../Format.scala.html#16331" title="(String)Key">fromString</a>(<a href="#58355" title="String">name</a>), <a href="#48164" title="sbt.Format[Value]">valueFormat</a>.<a href="../Format.scala.html#16331" title="(String)Value">fromString</a>(<a href="#58346" title="java.util.Properties">properties</a>.<a title="(java.lang.String)java.lang.String" id="56194">getProperty</a>(<a href="#58355" title="String">name</a>)))
			<span title="object None">None</span>
		}
	}
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Iterable[Value]" id="26797">all</a>[<a title="&gt;: Nothing &lt;: Any" id="26800">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="26801">Value</a>](<a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="28546">map</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]]): <span title="Iterable[Value]">Iterable</span>[Value] =
		<a href="#28546" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<a title="=&gt; Iterator[scala.collection.mutable.Set[Value]]" id="24236">values</a>.<span title="=&gt; List[scala.collection.mutable.Set[Value]]">toList</span>.<a title="((scala.collection.mutable.Set[Value]) =&gt; Iterable[Value])List[Value]" id="17773">flatMap</a>(<a title="scala.collection.mutable.Set[Value]" id="58360">set</a> =&gt; <a href="#58360" title="scala.collection.mutable.Set[Value]">set</a>.<a title="=&gt; List[Value]" id="16093">toList</a>)
	
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Iterable[(Key, scala.collection.Set[Value])]" id="26802">readOnlyIterable</a>[<a title="&gt;: Nothing &lt;: Any" id="26805">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="26806">Value</a>](<a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="29308">i</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]]): <span title="Iterable[(Key, scala.collection.Set[Value])]">Iterable</span>[(Key, scala.collection.Set[Value])] =
		<span class="keyword">for</span>( <a href="#58363" title="(((Key, scala.collection.mutable.Set[Value])) =&gt; (Key, scala.collection.Set[Value]))List[(Key, scala.collection.Set[Value])]" id="17757">(</a><a title="Key" id="58370">key</a>, <a title="scala.collection.mutable.Set[Value]" id="58371">set</a>) &lt;- <a href="#29308" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">i</a>.<a title="=&gt; Iterator[(Key, scala.collection.mutable.Set[Value])]" id="16054">elements</a>.<span title="=&gt; List[(Key, scala.collection.mutable.Set[Value])]">toList</span>) <span class="keyword">yield</span> <a title="(Key,scala.collection.Set[Value])(Key, scala.collection.Set[Value])" id="1327">(</a><a href="#58370" title="Key">key</a>, wrap.<a href="../wrap/Wrappers.scala.html#14084" title="object sbt.wrap.Wrappers">Wrappers</a>.<a href="../wrap/Wrappers.scala.html#18051" title="(scala.collection.mutable.Set[Value])scala.collection.Set[Value]">readOnly</a>(<a href="#58371" title="scala.collection.mutable.Set[Value]">set</a>))<span class="comment">//.readOnly)</span>
		
	<span class="keyword">def</span> <a title="[Key, Value](Key,scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Unit" id="26807">mark</a>[<a title="&gt;: Nothing &lt;: Any" id="26810">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="26811">Value</a>](<a title="Key" id="58404">source</a>: <a href="#26810" title="Key">Key</a>, <a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="58405">map</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]])
	{
		<span title="Unit" class="keyword">if</span>(<a title="=&gt; Boolean" id="2695">!</a><a href="#58405" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<a title="(Key)Boolean" id="24232">contains</a>(<a href="#58404" title="Key">source</a>))
			<a href="#58405" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<span title="(Key,scala.collection.mutable.Set[Value])Option[scala.collection.mutable.Set[Value]]">put</span>(<a href="#58404" title="Key">source</a>, <span title="scala.collection.mutable.HashSet[Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashSet[Value]">HashSet</span>[Value])
	}
	<span class="keyword">def</span> <a title="[Key, Value](Key,Value,scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Unit" id="26812">add</a>[<a title="&gt;: Nothing &lt;: Any" id="26815">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="26816">Value</a>](<a title="Key" id="34600">key</a>: <a href="#26815" title="Key">Key</a>, <a title="Value" id="34601">value</a>: <a href="#26816" title="Value">Value</a>, <a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="34602">map</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]]): <a title="Unit" id="2114">Unit</a> =
		<a href="#34602" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<a title="(Key,=&gt; scala.collection.mutable.Set[Value])scala.collection.mutable.Set[Value]" id="24193">getOrElseUpdate</a>(<a href="#34600" title="Key">key</a>, <span title="scala.collection.mutable.HashSet[Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashSet[Value]">HashSet</span>[Value]) <a title="(Value)scala.collection.mutable.Set[Value]" id="17914">+</a> <a href="#34601" title="Value">value</a>
}
        </pre>
    </body>
</html>