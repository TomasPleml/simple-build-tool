<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/processor/Processor.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt.processor

<span class="keyword">import</span> java.io.File

<span class="comment">/** An interface for code that operates on an sbt `Project`.*/</span>
<span class="keyword">trait</span> <a title="trait Processor extends java.lang.Object with NotNull" id="11927">Processor</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Apply this processor's action to the given `project`.
	* The arguments are passed unparsed as a single String `args`.
	* The return value optionally provides additional commands to run, such as 'reload'.
	* Note: `project` is not necessarily the root project.  To get the root project, use `project.rootProject`.
	* The `label` used to call the processor is provided to allow recursing.*/</span>
	<span class="keyword">def</span> <a title="(String,sbt.Project,Option[String],String)sbt.processor.ProcessorResult" id="31412">apply</a>(<a title="String" id="31414">label</a>: <span title="String">String</span>, <a title="sbt.Project" id="31415">project</a>: <a href="../Project.scala.html#7647" title="sbt.Project">Project</a>, <a title="Option[String]" id="31416">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String" id="31417">args</a>: <span title="String">String</span>): <a href="#11993" title="sbt.processor.ProcessorResult">ProcessorResult</a>
}
<span class="comment">/** An interface for code that operates on an sbt `Project` but doesn't need to modify command processing.*/</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class BasicProcessor extends java.lang.Object with sbt.processor.Processor with ScalaObject" id="12029">BasicProcessor</a> <span class="keyword">extends</span> <a href="#11927" title="sbt.processor.Processor">Processor</a>
{
	<span class="comment">/** Apply this processor's action to the given `project`.
	* The arguments are passed unparsed as a single String `args`.
	* Note: `project` is not necessarily the root project.  To get the root project, use `project.rootProject`.*/</span>
	<span class="keyword">def</span> <a title="(sbt.Project,String)Unit" id="31419">apply</a>(<a title="sbt.Project" id="31422">project</a>: <a href="../Project.scala.html#7647" title="sbt.Project">Project</a>, <a title="String" id="31423">args</a>: <span title="String">String</span>): <a title="Unit" id="2114">Unit</a>

	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,sbt.Project,Option[String],String)sbt.processor.ProcessorResult" id="31420">apply</a>(<a title="String" id="31424">label</a>: <span title="String">String</span>, <a title="sbt.Project" id="31425">project</a>: <a href="../Project.scala.html#7647" title="sbt.Project">Project</a>, <a title="Option[String]" id="31426">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String" id="31427">args</a>: <span title="String">String</span>): <a href="#11993" title="sbt.processor.ProcessorResult">ProcessorResult</a> =
	{
		<a href="#31419" title="(sbt.Project,String)Unit">apply</a>(<a href="#31425" title="sbt.Project">project</a>, <a href="#31427" title="String">args</a>)
		<span title="sbt.processor.Success" class="keyword">new</span> <a href="#11906" title="sbt.processor.Success">Success</a>(<a href="#31425" title="sbt.Project">project</a>, <a href="#31426" title="Option[String]">onFailure</a>)
	}
}

<span class="comment">/** The result of a Processor run.*/</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ProcessorResult extends java.lang.Object with NotNull" id="11993">ProcessorResult</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
<span class="comment">/* Processor success.
* `insertArgs` allows the Processor to insert additional commands to run.
* These commands are run before pending commands.
* 
* For example, consider a Processor bound to 'cleanCompile' that returns
*   `ProcessorResult(&quot;clean&quot;, &quot;compile&quot;)`
* 
* If a user runs:
*   `sbt a cleanCompile b `
* This runs `a`, `cleanCompile`, `clean`, `compile`, and finally `b`.
* Commands are processed as if they were entered at the prompt or from the command line.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Success extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="11906">Success</a>(<span class="keyword">val</span> <a title="sbt.Project" id="31440">project</a>: <a href="../Project.scala.html#7647" title="sbt.Project">Project</a>, <span class="keyword">val</span> <a title="Option[String]" id="31441">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String*" id="31442">insertArgs</a>: <span title="String*">String</span>*) <span class="keyword">extends</span> <a href="#11993" title="sbt.processor.ProcessorResult">ProcessorResult</a>
{
	<span class="keyword">val</span> <a title="List[String]" id="31438">insertArguments</a> = <a href="#31442" title="String*">insertArgs</a>.<span title="=&gt; List[String]">toList</span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Exit extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="11951">Exit</a>(<span class="keyword">val</span> <a title="Int" id="31454">code</a>: <a title="Int" id="2351">Int</a>) <span class="keyword">extends</span> <a href="#11993" title="sbt.processor.ProcessorResult">ProcessorResult</a>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Reload extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="11867">Reload</a>(<a title="String*" id="31462">insertArgs</a>: <span title="String*">String</span>*) <span class="keyword">extends</span> <a href="#11993" title="sbt.processor.ProcessorResult">ProcessorResult</a>
{
	<span class="keyword">val</span> <a title="List[String]" id="31458">insertArguments</a> = <a href="#31462" title="String*">insertArgs</a>.<span title="=&gt; List[String]">toList</span>
}

<span class="comment">/** Manages the processor and repository definitions.*/</span>
<span class="keyword">trait</span> <a title="trait Manager extends java.lang.Object with NotNull" id="11849">Manager</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(sbt.processor.ProcessorDefinition)Unit" id="31463">defineProcessor</a>(<a title="sbt.processor.ProcessorDefinition" id="31471">pdef</a>: <a href="#11858" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>)
	<span class="keyword">def</span> <a title="(String)sbt.processor.Definition" id="31464">removeDefinition</a>(<a title="String" id="31489">label</a>: <span title="String">String</span>): <a href="#11915" title="sbt.processor.Definition">Definition</a>
	<span class="keyword">def</span> <a title="(sbt.processor.RepositoryDefinition)Unit" id="31465">defineRepository</a>(<a title="sbt.processor.RepositoryDefinition" id="31490">repo</a>: <a href="#11873" title="sbt.processor.RepositoryDefinition">RepositoryDefinition</a>)
	<span class="keyword">def</span> <a title="(sbt.processor.ProcessorDefinition)Option[sbt.processor.Processor]" id="31466">processor</a>(<a title="sbt.processor.ProcessorDefinition" id="31499">pdef</a>: <a href="#11858" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>): <span title="Option[sbt.processor.Processor]">Option</span>[Processor]
	<span class="keyword">def</span> <a title="(String)Option[sbt.processor.ProcessorDefinition]" id="31467">processorDefinition</a>(<a title="String" id="31500">label</a>: <span title="String">String</span>): <span title="Option[sbt.processor.ProcessorDefinition]">Option</span>[ProcessorDefinition]
	
	<span class="keyword">def</span> <a title="=&gt; Map[String,sbt.processor.ProcessorDefinition]" id="31468">processors</a>: <span title="Map[String,sbt.processor.ProcessorDefinition]">Map</span>[String, ProcessorDefinition]
	<span class="keyword">def</span> <a title="=&gt; Map[String,sbt.processor.RepositoryDefinition]" id="31469">repositories</a>: <span title="Map[String,sbt.processor.RepositoryDefinition]">Map</span>[String, RepositoryDefinition]
}

<span class="comment">/** Executes a parsed command. */</span>
<span class="keyword">trait</span> <a title="trait Executing extends java.lang.Object with NotNull" id="11879">Executing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(sbt.processor.Command)Unit" id="31503">apply</a>(<a title="sbt.processor.Command" id="31505">command</a>: <a href="#11924" title="sbt.processor.Command">Command</a>)
}
<span class="comment">/** Prints information about processors. */</span>
<span class="keyword">trait</span> <a title="trait Info extends java.lang.Object with NotNull" id="11912">Info</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Prints available processors and defined repositories.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="31506">show</a>()
	<span class="comment">/** Prints usage of processor management commands.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="31507">help</a>()
}

<span class="comment">/** Parses a command String */</span>
<span class="keyword">trait</span> <a title="trait CommandParsing extends java.lang.Object with NotNull" id="11981">CommandParsing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Parses a command String that has been preprocessed.
	* It should have any prefix (like the * used by Main) removed
	* and whitespace trimmed
	*
	* If parsing is successful, a `Command` instance is returned wrapped in `Right`.
	*  Otherwise, an error message is returned wrapped in `Left`.*/</span>
	<span class="keyword">def</span> <a title="(String)Either[String,sbt.processor.Command]" id="31509">parseCommand</a>(<a title="String" id="31511">line</a>: <span title="String">String</span>): <a title="Either[String,sbt.processor.Command]" id="336">Either</a>[String, Command]
}
<span class="comment">/** Parses a definition `String`.*/</span>
<span class="keyword">trait</span> <a title="trait DefinitionParsing extends java.lang.Object with NotNull" id="11882">DefinitionParsing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Parses the given definition `String`.
	* The result is wrapped in `Some` if successful, or `None` if the string is not of the correct form. */</span>
	<span class="keyword">def</span> <a title="(String)Option[sbt.processor.Definition]" id="31512">parseDefinition</a>(<a title="String" id="31514">line</a>: <span title="String">String</span>): <span title="Option[sbt.processor.Definition]">Option</span>[Definition]
}
<span class="comment">/** Handles serializing `Definition`s.*/</span>
<span class="keyword">trait</span> <a title="trait Persisting extends java.lang.Object with NotNull" id="11861">Persisting</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(java.io.File)(Iterable[sbt.processor.Definition])Unit" id="31515">save</a>(<a title="java.io.File" id="31518">file</a>: <span title="java.io.File">File</span>)(<a title="Iterable[sbt.processor.Definition]" id="31519">definitions</a>: <a title="Iterable[sbt.processor.Definition]" id="372">Iterable</a>[Definition])
	<span class="keyword">def</span> <a title="(java.io.File)Seq[sbt.processor.Definition]" id="31516">load</a>(<a title="java.io.File" id="31520">file</a>: <span title="java.io.File">File</span>): <a title="Seq[sbt.processor.Definition]" id="729">Seq</a>[Definition]
}

<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Definition extends java.lang.Object with NotNull" id="11915">Definition</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="=&gt; String" id="31472">label</a>: <span title="String">String</span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ProcessorDefinition extends java.lang.Object with sbt.processor.Definition with ScalaObject" id="11858">ProcessorDefinition</a>(<span class="keyword">val</span> <a title="String" id="31528">label</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="31529">group</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="31530">module</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="31531">rev</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#11915" title="sbt.processor.Definition">Definition</a>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="31486">toString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#31528" title="=&gt; String">label</a>, <span title="java.lang.String(&quot;is&quot;)" class="string">&quot;is&quot;</span>, <a href="#31529" title="=&gt; String">group</a>, <a href="#31530" title="=&gt; String">module</a>, <a href="#31531" title="=&gt; String">rev</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
	<span class="keyword">def</span> <a title="=&gt; String" id="31487">idString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#31529" title="=&gt; String">group</a>, <a href="#31530" title="=&gt; String">module</a>, <a href="#31531" title="=&gt; String">rev</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
	<span class="keyword">def</span> <a title="(String)sbt.ModuleID" id="31488">toModuleID</a>(<a title="String" id="31540">scalaVersion</a>: <span title="String">String</span>) = <a href="../../IvyInterface.scala.html#21925" title="(String,String,String)sbt.ModuleID">ModuleID</a>(<a href="#31529" title="=&gt; String">group</a>, <a href="#31530" title="=&gt; String">module</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;_&quot;)" class="string">&quot;_&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#31540" title="String">scalaVersion</a>, <a href="#31531" title="=&gt; String">rev</a>)
}
<span class="comment">// maven-style repositories only right now</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RepositoryDefinition extends java.lang.Object with sbt.processor.Definition with ScalaObject" id="11873">RepositoryDefinition</a>(<span class="keyword">val</span> <a title="String" id="31549">label</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="31550">url</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#11915" title="sbt.processor.Definition">Definition</a>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="31498">toString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#31549" title="=&gt; String">label</a>, <span title="java.lang.String(&quot;at&quot;)" class="string">&quot;at&quot;</span>, <a href="#31550" title="=&gt; String">url</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
}

<span class="comment">/** Data type representing a runnable command related to processor management.*/</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Command extends java.lang.Object with NotNull" id="11924">Command</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
<span class="comment">/** A command to add the given processor definition. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class DefineProcessor extends java.lang.Object with sbt.processor.Command with ScalaObject" id="11945">DefineProcessor</a>(<span class="keyword">val</span> <a title="sbt.processor.ProcessorDefinition" id="31562">pdef</a>: <a href="#11858" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>) <span class="keyword">extends</span> <a href="#11924" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to remove the processor or repository definition currently associated with the given `label`.
* If the definition is associated with other labels, those are not affected.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RemoveDefinition extends java.lang.Object with sbt.processor.Command with ScalaObject" id="11963">RemoveDefinition</a>(<span class="keyword">val</span> <a title="String" id="31569">label</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#11924" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to register the given repository to be used for obtaining `Processor`s. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class DefineRepository extends java.lang.Object with sbt.processor.Command with ScalaObject" id="11909">DefineRepository</a>(<span class="keyword">val</span> <a title="sbt.processor.RepositoryDefinition" id="31576">repo</a>: <a href="#11873" title="sbt.processor.RepositoryDefinition">RepositoryDefinition</a>) <span class="keyword">extends</span> <a href="#11924" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to show help for processor management command usage. */</span>
<span class="keyword">object</span> <a title="object sbt.processor.Help" id="11853">Help</a> <span class="keyword">extends</span> <a href="#11924" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to show available processors and repositories.*/</span>
<span class="keyword">object</span> <a title="object sbt.processor.Show" id="11856">Show</a> <span class="keyword">extends</span> <a href="#11924" title="sbt.processor.Command">Command</a>

<span class="comment">/** An exception used when a `Processor` wants to terminate with an error message, but the stack trace is not important.
* If a `cause` is provided, its stack trace is assumed to be important.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ProcessorException extends java.lang.RuntimeException with ScalaObject" id="11942">ProcessorException</a>(<span class="keyword">val</span> <a title="String" id="31591">message</a>: <span title="String">String</span>, <a title="Throwable" id="31592">cause</a>: <span title="Throwable">Throwable</span>) <span class="keyword">extends</span> <a title="java.lang.RuntimeException" id="19484">RuntimeException</a>(<a href="#31591" title="String">message</a>, <a href="#31592" title="Throwable">cause</a>)
{
	<span class="keyword">def</span> <a title="(String)sbt.processor.ProcessorException" id="31587" class="keyword">this</a>(<a title="String" id="31608">message</a>: <span title="String">String</span>) = <a href="#11942" title="ProcessorException.this.type" class="keyword">this</a>(<a href="#31608" title="String">message</a>, <span title="Null(null)" class="keyword">null</span>)
}
<span class="keyword">object</span> <a title="object sbt.processor.ProcessorException" id="11943">ProcessorException</a>
{
	<span class="keyword">def</span> <a title="(String)Nothing" id="31617">error</a>(<a title="String" id="31620">msg</a>: <span title="String">String</span>): <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <a href="#31587" title="(String)sbt.processor.ProcessorException" class="keyword">new</a> <a href="#11942" title="sbt.processor.ProcessorException">ProcessorException</a>(<a href="#31620" title="String">msg</a>)
	<span class="keyword">def</span> <a title="(String,Throwable)Nothing" id="31618">error</a>(<a title="String" id="31622">msg</a>: <span title="String">String</span>, <a title="Throwable" id="31623">t</a>: <span title="Throwable">Throwable</span>): <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <span title="sbt.processor.ProcessorException" class="keyword">new</span> <a href="#11942" title="sbt.processor.ProcessorException">ProcessorException</a>(<a href="#31622" title="String">msg</a>, <a href="#31623" title="Throwable">t</a>)
}

        </pre>
    </body>
</html>