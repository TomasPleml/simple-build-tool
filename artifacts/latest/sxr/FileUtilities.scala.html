<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>FileUtilities.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> xsbt

<span class="keyword">import</span> OpenResource._
<span class="keyword">import</span> ErrorHandling.translate

<span class="keyword">import</span> java.io.{ByteArrayOutputStream, BufferedWriter, File, FileInputStream, InputStream, OutputStream}
<span class="keyword">import</span> java.net.{URI, URISyntaxException, URL}
<span class="keyword">import</span> java.nio.charset.Charset
<span class="keyword">import</span> java.util.jar.{Attributes, JarEntry, JarFile, JarInputStream, JarOutputStream, Manifest}
<span class="keyword">import</span> java.util.zip.{GZIPOutputStream, ZipEntry, ZipFile, ZipInputStream, ZipOutputStream}
<span class="keyword">import</span> scala.collection.mutable.HashSet
<span class="keyword">import</span> scala.reflect.{Manifest =&gt; SManifest}
<span class="keyword">import</span> Function.tupled

<span class="keyword">object</span> <a title="object xsbt.FileUtilities" id="6719">FileUtilities</a>
{
	<span class="comment">/** The maximum number of times a unique temporary filename is attempted to be created.*/</span>
	<span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="18208">MaximumTries</a> = <span title="Int(10)" class="int">10</span>
	<span class="comment">/** The producer of randomness for unique name generation.*/</span>
	<span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.util.Random" id="18211">random</a> = <span title="java.util.Random" class="keyword">new</span> java.util.<a title="java.util.Random" id="5940">Random</a>
	<span class="keyword">val</span> <a title="java.io.File" id="18212">temporaryDirectory</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<span title="object java.lang.System">System</span>.<span title="(java.lang.String)java.lang.String">getProperty</span>(<span title="java.lang.String(&quot;java.io.tmpdir&quot;)" class="string">&quot;java.io.tmpdir&quot;</span>))
	<span class="comment">/** The size of the byte or char buffer used in various methods.*/</span>
	<span class="keyword">private</span> <span class="keyword">val</span> <a title="Int" id="18214">BufferSize</a> = <span title="Int(8192)" class="int">8192</span>
	<span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.String" id="18216">Newline</a> = <span title="object java.lang.System">System</span>.<span title="(java.lang.String)java.lang.String">getProperty</span>(<span title="java.lang.String(&quot;line.separator&quot;)" class="string">&quot;line.separator&quot;</span>)

	<span class="keyword">def</span> <a title="=&gt; java.nio.charset.Charset" id="18218">utf8</a> = <a title="object java.nio.charset.Charset" id="6334">Charset</a>.<a title="(java.lang.String)java.nio.charset.Charset" id="45673">forName</a>(<span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span>)

	<span class="keyword">def</span> <a title="(Class[_])java.net.URL" id="18219">classLocation</a>(<a title="Class[_]" id="86107">cl</a>: <span title="Class[_]">Class</span>[_]): <span title="java.net.URL">URL</span> =
	{
		<span class="keyword">val</span> <a title="java.security.CodeSource" id="86111">codeSource</a> = <a href="#86107" title="Class[_]">cl</a>.<a title="()java.security.ProtectionDomain" id="5091">getProtectionDomain</a>.<a title="()java.security.CodeSource" id="62527">getCodeSource</a>
		<span title="java.net.URL" class="keyword">if</span>(<a href="#86111" title="java.security.CodeSource">codeSource</a> <span title="(AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>) <span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;No class location for &quot;)" class="string">&quot;No class location for &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86107" title="Class[_]">cl</a>)
		<span class="keyword">else</span> <a href="#86111" title="java.security.CodeSource">codeSource</a>.<a title="()java.net.URL" id="62538">getLocation</a>
	}
	<span class="keyword">def</span> <a title="(Class[_])java.io.File" id="18220">classLocationFile</a>(<a title="Class[_]" id="86114">cl</a>: <span title="Class[_]">Class</span>[_]): <span title="java.io.File">File</span> = <a href="#18227" title="(java.net.URL)java.io.File">toFile</a>(<a href="#18219" title="(Class[_])java.net.URL">classLocation</a>(<a href="#86114" title="Class[_]">cl</a>))
	<span class="keyword">def</span> <a title="[T](implicit scala.reflect.Manifest[T])java.net.URL" id="18221">classLocation</a>[<a title="&gt;: Nothing &lt;: Any" id="18223">T</a>](<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="86125">mf</a>: <span title="scala.reflect.Manifest[T]">SManifest</span>[T]): <span title="java.net.URL">URL</span> = <a href="#18219" title="(Class[_])java.net.URL">classLocation</a>(<a href="#86125" title="scala.reflect.Manifest[T]">mf</a>.<span title="=&gt; Class[_]">erasure</span>)
	<span class="keyword">def</span> <a title="[T](implicit scala.reflect.Manifest[T])java.io.File" id="18224">classLocationFile</a>[<a title="&gt;: Nothing &lt;: Any" id="18226">T</a>](<span class="keyword">implicit</span> <a title="scala.reflect.Manifest[T]" id="79694">mf</a>: <span title="scala.reflect.Manifest[T]">SManifest</span>[T]): <span title="java.io.File">File</span> = <a href="#18220" title="(Class[_])java.io.File">classLocationFile</a>(<a href="#79694" title="scala.reflect.Manifest[T]">mf</a>.<span title="=&gt; Class[_]">erasure</span>)

	<span class="keyword">def</span> <a title="(java.net.URL)java.io.File" id="18227">toFile</a>(<a title="java.net.URL" id="86118">url</a>: <span title="java.net.URL">URL</span>) =
		<span class="keyword">try</span> { <span title="(java.net.URI)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#86118" title="java.net.URL">url</a>.<a title="()java.net.URI" id="19081">toURI</a>) }
		<span class="keyword">catch</span> { <span title="java.io.File" class="keyword">case</span> _: <a title="java.net.URISyntaxException" id="4386">URISyntaxException</a> =&gt; <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#86118" title="java.net.URL">url</a>.<span title="()java.lang.String">getPath</span>) }

	<span class="comment">/** Converts the given URL to a File.  If the URL is for an entry in a jar, the File for the jar is returned. */</span>
	<span class="keyword">def</span> <a title="(java.net.URL)java.io.File" id="18228">asFile</a>(<a title="java.net.URL" id="86137">url</a>: <span title="java.net.URL">URL</span>): <span title="java.io.File">File</span> =
	{
		<a href="#86137" title="java.net.URL">url</a>.<span title="()java.lang.String">getProtocol</span> <span title="java.io.File" class="keyword">match</span>
		{
			<span title="java.io.File" class="keyword">case</span> <span title="java.lang.String(&quot;file&quot;)" class="string">&quot;file&quot;</span> =&gt; <a href="#18227" title="(java.net.URL)java.io.File">toFile</a>(<a href="#86137" title="java.net.URL">url</a>)
			<span title="java.io.File" class="keyword">case</span> <span title="java.lang.String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span> =&gt;
				<span class="keyword">val</span> <a title="java.lang.String" id="86138">path</a> = <a href="#86137" title="java.net.URL">url</a>.<span title="()java.lang.String">getPath</span>
				<span class="keyword">val</span> <a title="Int" id="86139">end</a> = <a href="#86138" title="java.lang.String">path</a>.<a title="(Int)Int" id="6377">indexOf</a>(<span title="Int(33)" class="char">'!'</span>)
				<span title="(java.net.URI)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<span title="java.net.URI" class="keyword">new</span> <a title="java.net.URI" id="4572">URI</a>(<span title="java.lang.String" class="keyword">if</span>(<a href="#86139" title="Int">end</a> <a title="(Int)Boolean" id="3084">==</a> -<span title="Int(-1)" class="int">1</span>) <a href="#86138" title="java.lang.String">path</a> <span class="keyword">else</span> <a href="#86138" title="java.lang.String">path</a>.<span title="(Int,Int)java.lang.String">substring</span>(<span title="Int(0)" class="int">0</span>, <a href="#86139" title="Int">end</a>)))
			<span title="Nothing" class="keyword">case</span> _ =&gt; <span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;Invalid protocol &quot;)" class="string">&quot;Invalid protocol &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86137" title="java.net.URL">url</a>.<span title="()java.lang.String">getProtocol</span>)
		}
	}
	<span class="keyword">def</span> <a title="(java.io.File)Unit" id="18229">assertDirectory</a>(<a title="java.io.File" id="86159">file</a>: <span title="java.io.File">File</span>) { <a title="(Boolean,Any)Unit" id="6480">assert</a>(<a href="#86159" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span>, (<span title="java.lang.String" class="keyword">if</span>(<a href="#86159" title="java.io.File">file</a>.<span title="()Boolean">exists</span>) <span title="java.lang.String(&quot;Not a directory: &quot;)" class="string">&quot;Not a directory: &quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;Directory not found: &quot;)" class="string">&quot;Directory not found: &quot;</span>) <span title="(Any)java.lang.String">+</span> <a href="#86159" title="java.io.File">file</a>) }
	<span class="keyword">def</span> <a title="(java.io.File*)Unit" id="18230">assertDirectories</a>(<a title="java.io.File*" id="86167">file</a>: <a title="java.io.File*" id="2684">File</a>*) { <a href="#86167" title="java.io.File*">file</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>(<a href="#18229" title="(java.io.File)Unit">assertDirectory</a>) }

	<span class="comment">// &quot;base.extension&quot; -&gt; (base, extension)</span>
	<span class="keyword">def</span> <a title="(String)(String, String)" id="18231">split</a>(<a title="String" id="86170">name</a>: <span title="String">String</span>): <a title="(String, String)" id="1330">(</a>String, String) =
	{
		<span class="keyword">val</span> <a title="Int" id="86171">lastDot</a> = <a href="#86170" title="String">name</a>.<a title="(Int)Int" id="6379">lastIndexOf</a>(<span title="Int(46)" class="char">'.'</span>)
		<span title="(String, String)" class="keyword">if</span>(<a href="#86171" title="Int">lastDot</a> <span title="(Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>)
			<span title="(java.lang.String,java.lang.String)(java.lang.String, java.lang.String)">(</span><a href="#86170" title="String">name</a>.<span title="(Int,Int)java.lang.String">substring</span>(<span title="Int(0)" class="int">0</span>, <a href="#86171" title="Int">lastDot</a>), <a href="#86170" title="String">name</a>.<span title="(Int)java.lang.String">substring</span>(<a href="#86171" title="Int">lastDot</a><span title="(Int)Int">+</span><span title="Int(1)" class="int">1</span>))
		<span class="keyword">else</span>
			<span title="(String,java.lang.String)(String, java.lang.String)">(</span><a href="#86170" title="String">name</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>)
	}

	<span class="keyword">def</span> <a title="(Iterable[java.io.File])Unit" id="18232">touch</a>(<a title="Iterable[java.io.File]" id="86209">files</a>: <span title="Iterable[java.io.File]">Iterable</span>[File]): <span title="Unit">Unit</span> = <a href="#86209" title="Iterable[java.io.File]">files</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>(<a href="#18233" title="(java.io.File)Unit">touch</a>)
	<span class="comment">/** Creates a file at the given location.*/</span>
	<span class="keyword">def</span> <a title="(java.io.File)Unit" id="18233">touch</a>(<a title="java.io.File" id="86211">file</a>: <span title="java.io.File">File</span>)
	{
		<a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#86211" title="java.io.File">file</a>.<span title="()java.io.File">getParentFile</span>)
		<span class="keyword">val</span> <a title="Boolean" id="86215">created</a> = <a href="ErrorHandling.scala.html#19865" title="(=&gt; String)(=&gt; Boolean)Boolean">translate</a>(<span title="java.lang.String(&quot;Could not create file &quot;)" class="string">&quot;Could not create file &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86211" title="java.io.File">file</a>) { <a href="#86211" title="java.io.File">file</a>.<a title="()Boolean" id="16778">createNewFile</a>() }
		<span title="Unit" class="keyword">if</span>(<a href="#86215" title="Boolean">created</a> <span title="(Boolean)Boolean">||</span> <a href="#86211" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span>)
			<span title="Unit">(</span>)
		<span class="keyword">else</span> <span title="Unit" class="keyword">if</span>(<span title="=&gt; Boolean">!</span><a href="#86211" title="java.io.File">file</a>.<a title="(Long)Boolean" id="16789">setLastModified</a>(<span title="object java.lang.System">System</span>.<a title="()Long" id="18115">currentTimeMillis</a>))
			<span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;Could not update last modified time for file &quot;)" class="string">&quot;Could not update last modified time for file &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86211" title="java.io.File">file</a>)
	}
	<span class="keyword">def</span> <a title="(Iterable[java.io.File])Unit" id="18234">createDirectories</a>(<a title="Iterable[java.io.File]" id="86218">dirs</a>: <span title="Iterable[java.io.File]">Iterable</span>[File]): <span title="Unit">Unit</span> =
		<a href="#86218" title="Iterable[java.io.File]">dirs</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>(<a href="#18235" title="(java.io.File)Unit">createDirectory</a>)
	<span class="keyword">def</span> <a title="(java.io.File)Unit" id="18235">createDirectory</a>(<a title="java.io.File" id="86216">dir</a>: <span title="java.io.File">File</span>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="86221">failBase</a> = <span title="java.lang.String(&quot;Could not create directory &quot;)" class="string">&quot;Could not create directory &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86216" title="java.io.File">dir</a>
		<span title="Unit" class="keyword">if</span>(<a href="#86216" title="java.io.File">dir</a>.<span title="()Boolean">isDirectory</span> <span title="(Boolean)Boolean">||</span> <a href="#86216" title="java.io.File">dir</a>.<a title="()Boolean" id="16787">mkdirs</a>())
			<span title="Unit">(</span>)
		<span class="keyword">else</span> <span title="Unit" class="keyword">if</span>(<a href="#86216" title="java.io.File">dir</a>.<span title="()Boolean">exists</span>)
			<span title="(String)Nothing">error</span>(<a href="#86221" title="=&gt; java.lang.String">failBase</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: file exists and is not a directory.&quot;)" class="string">&quot;: file exists and is not a directory.&quot;</span>)
		<span class="keyword">else</span>
			<span title="(String)Nothing">error</span>(<a href="#86221" title="=&gt; java.lang.String">failBase</a>)
	}
	<span class="keyword">def</span> <a title="(java.io.File,java.io.File)Set[java.io.File]" id="18236">unzip</a>(<a title="java.io.File" id="20707">from</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="20708">toDirectory</a>: <span title="java.io.File">File</span>): <span title="Set[java.io.File]">Set</span>[File] = <a href="#18237" title="(java.io.File,java.io.File,xsbt.NameFilter)Set[java.io.File]">unzip</a>(<a href="#20707" title="java.io.File">from</a>, <a href="#20708" title="java.io.File">toDirectory</a>, <a href="NameFilter.scala.html#7322" title="object xsbt.AllPassFilter">AllPassFilter</a>)
	<span class="keyword">def</span> <a title="(java.io.File,java.io.File,xsbt.NameFilter)Set[java.io.File]" id="18237">unzip</a>(<a title="java.io.File" id="20704">from</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="20705">toDirectory</a>: <span title="java.io.File">File</span>, <a title="xsbt.NameFilter" id="20706">filter</a>: <a href="NameFilter.scala.html#7345" title="xsbt.NameFilter">NameFilter</a>): <span title="Set[java.io.File]">Set</span>[File] = <a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.FileInputStream) =&gt; Set[java.io.File])Set[java.io.File]">fileInputStream</a>(<a href="#20704" title="java.io.File">from</a>)(<a title="java.io.FileInputStream" id="86235">in</a> =&gt; <a href="#18238" title="(java.io.InputStream,java.io.File,xsbt.NameFilter)Set[java.io.File]">unzip</a>(<a href="#86235" title="java.io.FileInputStream">in</a>, <a href="#20705" title="java.io.File">toDirectory</a>, <a href="#20706" title="xsbt.NameFilter">filter</a>))
	<span class="keyword">def</span> <a title="(java.io.InputStream,java.io.File,xsbt.NameFilter)Set[java.io.File]" id="18238">unzip</a>(<a title="java.io.InputStream" id="20691">from</a>: <span title="java.io.InputStream">InputStream</span>, <a title="java.io.File" id="20692">toDirectory</a>: <span title="java.io.File">File</span>, <a title="xsbt.NameFilter" id="20693">filter</a>: <a href="NameFilter.scala.html#7345" title="xsbt.NameFilter">NameFilter</a>): <span title="Set[java.io.File]">Set</span>[File] =
	{
		<a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#20692" title="java.io.File">toDirectory</a>)
		<a href="OpenResource.scala.html#79926" title="(java.io.InputStream)((java.util.zip.ZipInputStream) =&gt; scala.collection.immutable.Set[java.io.File])scala.collection.immutable.Set[java.io.File]">zipInputStream</a>(<a href="#20691" title="java.io.InputStream">from</a>) { <a title="java.util.zip.ZipInputStream" id="86263">zipInput</a> =&gt; <a href="#18239" title="(java.util.zip.ZipInputStream,java.io.File,xsbt.NameFilter)scala.collection.immutable.Set[java.io.File]">extract</a>(<a href="#86263" title="java.util.zip.ZipInputStream">zipInput</a>, <a href="#20692" title="java.io.File">toDirectory</a>, <a href="#20693" title="xsbt.NameFilter">filter</a>) }
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.util.zip.ZipInputStream,java.io.File,xsbt.NameFilter)scala.collection.immutable.Set[java.io.File]" id="18239">extract</a>(<a title="java.util.zip.ZipInputStream" id="86264">from</a>: <a title="java.util.zip.ZipInputStream" id="19968">ZipInputStream</a>, <a title="java.io.File" id="86265">toDirectory</a>: <span title="java.io.File">File</span>, <a title="xsbt.NameFilter" id="86266">filter</a>: <a href="NameFilter.scala.html#7345" title="xsbt.NameFilter">NameFilter</a>) =
	{
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[java.io.File]" id="86268">set</a> = <span title="scala.collection.mutable.HashSet[java.io.File]" class="keyword">new</span> <a title="scala.collection.mutable.HashSet[java.io.File]" id="20037">HashSet</a>[File]
		<span class="keyword">def</span> <a title="()Unit" id="86269">next</a>()
		{
			<span class="keyword">val</span> <a title="java.util.zip.ZipEntry" id="86270">entry</a> = <a href="#86264" title="java.util.zip.ZipInputStream">from</a>.<a title="()java.util.zip.ZipEntry" id="61279">getNextEntry</a>
			<span title="Unit" class="keyword">if</span>(<a href="#86270" title="java.util.zip.ZipEntry">entry</a> <span title="(AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>)
				<span title="Unit">(</span>)
			<span class="keyword">else</span>
			{
				<span class="keyword">val</span> <a title="java.lang.String" id="86272">name</a> = <a href="#86270" title="java.util.zip.ZipEntry">entry</a>.<a title="()java.lang.String" id="60992">getName</a>
				<span title="Unit" class="keyword">if</span>(<a href="#86266" title="xsbt.NameFilter">filter</a>.<a href="NameFilter.scala.html#21006" title="(String)Boolean">accept</a>(<a href="#86272" title="java.lang.String">name</a>))
				{
					<span class="keyword">val</span> <a title="java.io.File" id="86276">target</a> = <span title="(java.io.File,java.lang.String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#86265" title="java.io.File">toDirectory</a>, <a href="#86272" title="java.lang.String">name</a>)
					<span class="comment">//log.debug(&quot;Extracting zip entry '&quot; + name + &quot;' to '&quot; + target + &quot;'&quot;)</span>
					<span title="Unit" class="keyword">if</span>(<a href="#86270" title="java.util.zip.ZipEntry">entry</a>.<a title="()Boolean" id="61007">isDirectory</a>)
						<a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#86276" title="java.io.File">target</a>)
					<span class="keyword">else</span>
					{
						<a href="#86268" title="scala.collection.mutable.HashSet[java.io.File]">set</a> <a title="(java.io.File)Unit" id="30680">+=</a> <a href="#86276" title="java.io.File">target</a>
						<a href="ErrorHandling.scala.html#19865" title="(=&gt; String)(=&gt; Unit)Unit">translate</a>(<span title="java.lang.String(&quot;Error extracting zip entry '&quot;)" class="string">&quot;Error extracting zip entry '&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86272" title="java.lang.String">name</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;' to '&quot;)" class="string">&quot;' to '&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86276" title="java.io.File">target</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;': &quot;)" class="string">&quot;': &quot;</span>) {
							<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.FileOutputStream) =&gt; Unit)Unit">fileOutputStream</a>(<span title="Boolean(false)" class="keyword">false</span>)(<a href="#86276" title="java.io.File">target</a>) { <a title="java.io.FileOutputStream" id="86295">out</a> =&gt; <a href="#18240" title="(java.io.InputStream,java.io.OutputStream)Unit">transfer</a>(<a href="#86264" title="java.util.zip.ZipInputStream">from</a>, <a href="#86295" title="java.io.FileOutputStream">out</a>) }
						}
					}
					<span class="comment">//target.setLastModified(entry.getTime)</span>
				}
				<span class="keyword">else</span>
				<span title="Unit">{</span>
					<span class="comment">//log.debug(&quot;Ignoring zip entry '&quot; + name + &quot;'&quot;)</span>
				}
				<a href="#86264" title="java.util.zip.ZipInputStream">from</a>.<a title="()Unit" id="61280">closeEntry</a>()
				<a href="#86269" title="()Unit">next</a>()
			}
		}
		<a href="#86269" title="()Unit">next</a>()
		<span title="(java.io.File*)scala.collection.immutable.Set[java.io.File]">Set</span>() <a title="(Iterable[java.io.File])scala.collection.immutable.Set[java.io.File]" id="16726">++</a> <a href="#86268" title="scala.collection.mutable.HashSet[java.io.File]">set</a>
	}

	<span class="comment">/** Copies all bytes from the given input stream to the given output stream.
	* Neither stream is closed.*/</span>
	<span class="keyword">def</span> <a title="(java.io.InputStream,java.io.OutputStream)Unit" id="18240">transfer</a>(<a title="java.io.InputStream" id="79965">in</a>: <span title="java.io.InputStream">InputStream</span>, <a title="java.io.OutputStream" id="79966">out</a>: <span title="java.io.OutputStream">OutputStream</span>): <span title="Unit">Unit</span> = <a href="#18242" title="(java.io.InputStream,java.io.OutputStream,Boolean)Unit">transferImpl</a>(<a href="#79965" title="java.io.InputStream">in</a>, <a href="#79966" title="java.io.OutputStream">out</a>, <span title="Boolean(false)" class="keyword">false</span>)
	<span class="comment">/** Copies all bytes from the given input stream to the given output stream.  The
	* input stream is closed after the method completes.*/</span>
	<span class="keyword">def</span> <a title="(java.io.InputStream,java.io.OutputStream)Unit" id="18241">transferAndClose</a>(<a title="java.io.InputStream" id="86311">in</a>: <span title="java.io.InputStream">InputStream</span>, <a title="java.io.OutputStream" id="86312">out</a>: <span title="java.io.OutputStream">OutputStream</span>): <span title="Unit">Unit</span> = <a href="#18242" title="(java.io.InputStream,java.io.OutputStream,Boolean)Unit">transferImpl</a>(<a href="#86311" title="java.io.InputStream">in</a>, <a href="#86312" title="java.io.OutputStream">out</a>, <span title="Boolean(true)" class="keyword">true</span>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.InputStream,java.io.OutputStream,Boolean)Unit" id="18242">transferImpl</a>(<a title="java.io.InputStream" id="86308">in</a>: <span title="java.io.InputStream">InputStream</span>, <a title="java.io.OutputStream" id="86309">out</a>: <span title="java.io.OutputStream">OutputStream</span>, <a title="Boolean" id="86310">close</a>: <span title="Boolean">Boolean</span>)
	{
		<span class="keyword">try</span>
		{
			<span class="keyword">val</span> <a title="Array[Byte]" id="86313">buffer</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span>[Byte](<a href="#18214" title="=&gt; Int">BufferSize</a>)
			<span class="keyword">def</span> <a title="()Unit" id="86314">read</a>()
			{
				<span class="keyword">val</span> <a title="Int" id="86316">byteCount</a> = <a href="#86308" title="java.io.InputStream">in</a>.<a title="(Array[Byte])Int" id="20696">read</a>(<a href="#86313" title="Array[Byte]">buffer</a>)
				<span title="Unit" class="keyword">if</span>(<a href="#86316" title="Int">byteCount</a> <span title="(Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>)
				{
					<a href="#86309" title="java.io.OutputStream">out</a>.<a title="(Array[Byte],Int,Int)Unit" id="46495">write</a>(<a href="#86313" title="Array[Byte]">buffer</a>, <span title="Int(0)" class="int">0</span>, <a href="#86316" title="Int">byteCount</a>)
					<a href="#86314" title="()Unit">read</a>()
				}
			}
			<a href="#86314" title="()Unit">read</a>()
		}
		<span class="keyword">finally</span> { <span title="Unit" class="keyword">if</span>(<a href="#86310" title="Boolean">close</a>) <a href="#86308" title="java.io.InputStream">in</a>.<a title="()Unit" id="20700">close</a> }
	}

	<span class="comment">/** Creates a temporary directory and provides its location to the given function.  The directory
	* is deleted after the function returns.*/</span>
	<span class="keyword">def</span> <a title="[T]((java.io.File) =&gt; T)T" id="18243">withTemporaryDirectory</a>[<a title="&gt;: Nothing &lt;: Any" id="18245">T</a>](<a title="(java.io.File) =&gt; T" id="19863">action</a>: File =&gt; T): <a href="#18245" title="T">T</a> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="86340">dir</a> = <a href="#18246" title="=&gt; java.io.File">createTemporaryDirectory</a>
		<span class="keyword">try</span> { <a href="#19863" title="(java.io.File)T">action</a>(<a href="#86340" title="java.io.File">dir</a>) }
		<span class="keyword">finally</span> { <a href="#18249" title="(java.io.File)Unit">delete</a>(<a href="#86340" title="java.io.File">dir</a>) }
	}
	<span class="keyword">def</span> <a title="=&gt; java.io.File" id="18246">createTemporaryDirectory</a>: <span title="java.io.File">File</span> =
	{
		<span class="keyword">def</span> <a title="(Int)java.io.File" id="86342">create</a>(<a title="Int" id="86343">tries</a>: <a title="Int" id="2346">Int</a>): <span title="java.io.File">File</span> =
		{
			<span title="java.io.File" class="keyword">if</span>(<a href="#86343" title="Int">tries</a> <span title="(Int)Boolean">&gt;</span> <a href="#18208" title="=&gt; Int">MaximumTries</a>)
				<span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;Could not create temporary directory.&quot;)" class="string">&quot;Could not create temporary directory.&quot;</span>)
			<span class="keyword">else</span>
			{
				<span class="keyword">val</span> <a title="java.lang.String" id="86345">randomName</a> = <span title="java.lang.String(&quot;sbt_&quot;)" class="string">&quot;sbt_&quot;</span> <span title="(Any)java.lang.String">+</span> java.lang.<a title="object java.lang.Integer" id="1733">Integer</a>.<a title="(Int)java.lang.String" id="16871">toHexString</a>(<a href="#18210" title="=&gt; java.util.Random">random</a>.<a title="()Int" id="60653">nextInt</a>)
				<span class="keyword">val</span> <a title="java.io.File" id="86346">f</a> = <span title="(java.io.File,java.lang.String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#18212" title="=&gt; java.io.File">temporaryDirectory</a>, <a href="#86345" title="java.lang.String">randomName</a>)

				<span class="keyword">try</span> { <a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#86346" title="java.io.File">f</a>); <a href="#86346" title="java.io.File">f</a> }
				<span class="keyword">catch</span> { <span title="java.io.File" class="keyword">case</span> <a title="Exception" id="86362">e</a>: <span title="Exception">Exception</span> =&gt; <a href="#86342" title="(Int)java.io.File">create</a>(<a href="#86343" title="Int">tries</a> <span title="(Int)Int">+</span> <span title="Int(1)" class="int">1</span>) }
			}
		}
		<a href="#86342" title="(Int)java.io.File">create</a>(<span title="Int(0)" class="int">0</span>)
	}

	<span class="keyword">private</span>[xsbt] <span class="keyword">def</span> <a title="(java.io.File)Iterable[java.io.File]" id="18247">jars</a>(<a title="java.io.File" id="86381">dir</a>: <span title="java.io.File">File</span>): <span title="Iterable[java.io.File]">Iterable</span>[File] = <a href="#18251" title="(java.io.File,java.io.FileFilter)Array[java.io.File]">listFiles</a>(<a href="#86381" title="java.io.File">dir</a>, <a href="NameFilter.scala.html#84961" title="implicit xsbt.GlobFilter.apply : (String)xsbt.NameFilter">GlobFilter</a>(<span title="java.lang.String(&quot;*.jar&quot;)" class="string">&quot;*.jar&quot;</span>))

	<span class="keyword">def</span> <a title="(Iterable[java.io.File])Unit" id="18248">delete</a>(<a title="Iterable[java.io.File]" id="58247">files</a>: <span title="Iterable[java.io.File]">Iterable</span>[File]): <span title="Unit">Unit</span> = <a href="#58247" title="Iterable[java.io.File]">files</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>(<a href="#18249" title="(java.io.File)Unit">delete</a>)
	<span class="keyword">def</span> <a title="(java.io.File)Unit" id="18249">delete</a>(<a title="java.io.File" id="58246">file</a>: <span title="java.io.File">File</span>)
	{
		<a href="ErrorHandling.scala.html#19865" title="(=&gt; String)(=&gt; AnyVal)AnyVal">translate</a>(<span title="java.lang.String(&quot;Error deleting file &quot;)" class="string">&quot;Error deleting file &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#58246" title="java.io.File">file</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span>)
		{
			<span title="AnyVal" class="keyword">if</span>(<a href="#58246" title="java.io.File">file</a>.<span title="()Boolean">isDirectory</span>)
			{
				<a href="#18248" title="(Iterable[java.io.File])Unit">delete</a>(<a href="#18252" title="(java.io.File)Array[java.io.File]">listFiles</a>(<a href="#58246" title="java.io.File">file</a>))
				<a href="#58246" title="java.io.File">file</a>.<span title="()Boolean">delete</span>
			}
			<span class="keyword">else</span> <span title="Unit" class="keyword">if</span>(<a href="#58246" title="java.io.File">file</a>.<span title="()Boolean">exists</span>)
				<a href="#58246" title="java.io.File">file</a>.<span title="()Boolean">delete</span>
		}
	}
	<span class="keyword">def</span> <a title="(java.io.FileFilter)(java.io.File)Array[java.io.File]" id="18250">listFiles</a>(<a title="java.io.FileFilter" id="86392">filter</a>: java.io.<span title="java.io.FileFilter">FileFilter</span>)(<a title="java.io.File" id="86393">dir</a>: <span title="java.io.File">File</span>): <span title="Array[java.io.File]">Array</span>[File] = <a href="#18253" title="(Array[java.io.File])Array[java.io.File]">wrapNull</a>(<a href="#86393" title="java.io.File">dir</a>.<span title="(java.io.FileFilter)Array[java.io.File]">listFiles</span>(<a href="#86392" title="java.io.FileFilter">filter</a>))
	<span class="keyword">def</span> <a title="(java.io.File,java.io.FileFilter)Array[java.io.File]" id="18251">listFiles</a>(<a title="java.io.File" id="86390">dir</a>: <span title="java.io.File">File</span>, <a title="java.io.FileFilter" id="86391">filter</a>: java.io.<span title="java.io.FileFilter">FileFilter</span>): <span title="Array[java.io.File]">Array</span>[File] = <a href="#18253" title="(Array[java.io.File])Array[java.io.File]">wrapNull</a>(<a href="#86390" title="java.io.File">dir</a>.<span title="(java.io.FileFilter)Array[java.io.File]">listFiles</span>(<a href="#86391" title="java.io.FileFilter">filter</a>))
	<span class="keyword">def</span> <a title="(java.io.File)Array[java.io.File]" id="18252">listFiles</a>(<a title="java.io.File" id="86383">dir</a>: <span title="java.io.File">File</span>): <span title="Array[java.io.File]">Array</span>[File] = <a href="#18253" title="(Array[java.io.File])Array[java.io.File]">wrapNull</a>(<a href="#86383" title="java.io.File">dir</a>.<a title="()Array[java.io.File]" id="16783">listFiles</a>())
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Array[java.io.File])Array[java.io.File]" id="18253">wrapNull</a>(<a title="Array[java.io.File]" id="86412">a</a>: <span title="Array[java.io.File]">Array</span>[File]) =
	{
		<span title="Array[java.io.File]" class="keyword">if</span>(<a href="#86412" title="Array[java.io.File]">a</a> <span title="(AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>)
			<span title="Array[java.io.File]" class="keyword">new</span> <span title="Array[java.io.File]">Array</span>[File](<span title="Int(0)" class="int">0</span>)
		<span class="keyword">else</span>
			<a href="#86412" title="Array[java.io.File]">a</a>
	}


	<span class="comment">/** Creates a jar file.
	* @param sources The files to include in the jar file paired with the entry name in the jar.
	* @param outputJar The file to write the jar to.
	* @param manifest The manifest for the jar.*/</span>
	<span class="keyword">def</span> <a title="(Iterable[(java.io.File, String)],java.io.File,java.util.jar.Manifest)Unit" id="18254">jar</a>(<a title="Iterable[(java.io.File, String)]" id="86421">sources</a>: <span title="Iterable[(java.io.File, String)]">Iterable</span>[(File,String)], <a title="java.io.File" id="86422">outputJar</a>: <span title="java.io.File">File</span>, <a title="java.util.jar.Manifest" id="86423">manifest</a>: <a title="java.util.jar.Manifest" id="18996">Manifest</a>): <span title="Unit">Unit</span> =
		<a href="#18256" title="(Iterable[(java.io.File, String)],java.io.File,Option[java.util.jar.Manifest])Unit">archive</a>(<a href="#86421" title="Iterable[(java.io.File, String)]">sources</a>, <a href="#86422" title="java.io.File">outputJar</a>, <span title="(java.util.jar.Manifest)Some[java.util.jar.Manifest]">Some</span>(<a href="#86423" title="java.util.jar.Manifest">manifest</a>))
	<span class="comment">/** Creates a zip file.
	* @param sources The files to include in the zip file paired with the entry name in the zip.
	* @param outputZip The file to write the zip to.*/</span>
	<span class="keyword">def</span> <a title="(Iterable[(java.io.File, String)],java.io.File)Unit" id="18255">zip</a>(<a title="Iterable[(java.io.File, String)]" id="20991">sources</a>: <span title="Iterable[(java.io.File, String)]">Iterable</span>[(File,String)], <a title="java.io.File" id="20992">outputZip</a>: <span title="java.io.File">File</span>): <span title="Unit">Unit</span> =
		<a href="#18256" title="(Iterable[(java.io.File, String)],java.io.File,Option[java.util.jar.Manifest])Unit">archive</a>(<a href="#20991" title="Iterable[(java.io.File, String)]">sources</a>, <a href="#20992" title="java.io.File">outputZip</a>, <span title="object None">None</span>)

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Iterable[(java.io.File, String)],java.io.File,Option[java.util.jar.Manifest])Unit" id="18256">archive</a>(<a title="Iterable[(java.io.File, String)]" id="86424">sources</a>: <span title="Iterable[(java.io.File, String)]">Iterable</span>[(File,String)], <a title="java.io.File" id="86425">outputFile</a>: <span title="java.io.File">File</span>, <a title="Option[java.util.jar.Manifest]" id="86426">manifest</a>: <span title="Option[java.util.jar.Manifest]">Option</span>[Manifest])
	{
		<span title="Unit" class="keyword">if</span>(<a href="#86425" title="java.io.File">outputFile</a>.<span title="()Boolean">isDirectory</span>)
			<span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;Specified output file &quot;)" class="string">&quot;Specified output file &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86425" title="java.io.File">outputFile</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; is a directory.&quot;)" class="string">&quot; is a directory.&quot;</span>)
		<span class="keyword">else</span>
		{
			<span class="keyword">val</span> <a title="java.io.File" id="86428">outputDir</a> = <a href="#86425" title="java.io.File">outputFile</a>.<span title="()java.io.File">getParentFile</span>
			<a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#86428" title="java.io.File">outputDir</a>)
			<a href="#18259" title="(java.io.File,Option[java.util.jar.Manifest])((java.util.zip.ZipOutputStream) =&gt; Unit)Unit">withZipOutput</a>(<a href="#86425" title="java.io.File">outputFile</a>, <a href="#86426" title="Option[java.util.jar.Manifest]">manifest</a>)
			{ <a title="java.util.zip.ZipOutputStream" id="86433">output</a> =&gt;
				<span class="keyword">val</span> <a title="(String) =&gt; java.util.zip.ZipEntry" id="86434">createEntry</a>: (String =&gt; ZipEntry) = <span title="(String) =&gt; java.util.zip.ZipEntry" class="keyword">if</span>(<a href="#86426" title="Option[java.util.jar.Manifest]">manifest</a>.<a title="=&gt; Boolean" id="30325">isDefined</a>) <span title="java.util.jar.JarEntry" class="keyword">new</span> <a title="java.util.jar.JarEntry" id="18981">JarEntry</a>(<a href="#86436" title="String">_</a>) <span class="keyword">else</span> <span title="java.util.zip.ZipEntry" class="keyword">new</span> <a title="java.util.zip.ZipEntry" id="19923">ZipEntry</a>(<a href="#86439" title="String">_</a>)
				<a href="#18257" title="(Iterable[(java.io.File, String)],java.util.zip.ZipOutputStream)((String) =&gt; java.util.zip.ZipEntry)Unit">writeZip</a>(<a href="#86424" title="Iterable[(java.io.File, String)]">sources</a>, <a href="#86433" title="java.util.zip.ZipOutputStream">output</a>)(<a href="#86434" title="(String) =&gt; java.util.zip.ZipEntry">createEntry</a>)
			}
		}
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Iterable[(java.io.File, String)],java.util.zip.ZipOutputStream)((String) =&gt; java.util.zip.ZipEntry)Unit" id="18257">writeZip</a>(<a title="Iterable[(java.io.File, String)]" id="86442">sources</a>: <span title="Iterable[(java.io.File, String)]">Iterable</span>[(File,String)], <a title="java.util.zip.ZipOutputStream" id="86443">output</a>: <span title="java.util.zip.ZipOutputStream">ZipOutputStream</span>)(<a title="(String) =&gt; java.util.zip.ZipEntry" id="86444">createEntry</a>: String =&gt; ZipEntry)
	{
		<span class="keyword">def</span> <a title="(java.io.File,String)Unit" id="86445">add</a>(<a title="java.io.File" id="86446">sourceFile</a>: <span title="java.io.File">File</span>, <a title="String" id="86447">name</a>: <span title="String">String</span>)
		{
			<span title="Unit" class="keyword">if</span>(<a href="#86446" title="java.io.File">sourceFile</a>.<span title="()Boolean">isDirectory</span>)
				<span title="Unit">(</span>)
			<span class="keyword">else</span> <span title="Unit" class="keyword">if</span>(<a href="#86446" title="java.io.File">sourceFile</a>.<span title="()Boolean">exists</span>)
			{
				<span class="keyword">val</span> <a title="java.util.zip.ZipEntry" id="86448">nextEntry</a> = <a href="#86444" title="(String)java.util.zip.ZipEntry">createEntry</a>(<a href="#18258" title="(String)String">normalizeName</a>(<a href="#86447" title="String">name</a>))
				<a href="#86448" title="java.util.zip.ZipEntry">nextEntry</a>.<a title="(Long)Unit" id="60993">setTime</a>(<a href="#86446" title="java.io.File">sourceFile</a>.<span title="()Long">lastModified</span>)
				<a href="#86443" title="java.util.zip.ZipOutputStream">output</a>.<a title="(java.util.zip.ZipEntry)Unit" id="60969">putNextEntry</a>(<a href="#86448" title="java.util.zip.ZipEntry">nextEntry</a>)
				<a href="#18241" title="(java.io.InputStream,java.io.OutputStream)Unit">transferAndClose</a>(<a title="(java.io.File)java.io.FileInputStream" id="61072" class="keyword">new</a> <a title="java.io.FileInputStream" id="3786">FileInputStream</a>(<a href="#86446" title="java.io.File">sourceFile</a>), <a href="#86443" title="java.util.zip.ZipOutputStream">output</a>)
			}
			<span class="keyword">else</span>
				<span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;Source &quot;)" class="string">&quot;Source &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86446" title="java.io.File">sourceFile</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; does not exist.&quot;)" class="string">&quot; does not exist.&quot;</span>)
		}
		<a href="#86442" title="Iterable[(java.io.File, String)]">sources</a>.<span title="(((java.io.File, String)) =&gt; Unit)Unit">foreach</span>(<span title="((java.io.File, String) =&gt; Unit)((java.io.File, String)) =&gt; Unit">tupled</span>(<a href="#86445" title="(java.io.File,String)Unit">add</a>))
		<a href="#86443" title="java.util.zip.ZipOutputStream">output</a>.<a title="()Unit" id="60970">closeEntry</a>()
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String)String" id="18258">normalizeName</a>(<a title="String" id="86449">name</a>: <span title="String">String</span>) =
	{
		<span class="keyword">val</span> <a title="Char" id="86451">sep</a> = <span title="object java.io.File">File</span>.<span title="Char">separatorChar</span>
		<span title="String" class="keyword">if</span>(<a href="#86451" title="Char">sep</a> <span title="(Char)Boolean">==</span> <span title="Char('/')" class="char">'/'</span>) <a href="#86449" title="String">name</a> <span class="keyword">else</span> <a href="#86449" title="String">name</a>.<a title="(Char,Char)java.lang.String" id="6391">replace</a>(<a href="#86451" title="Char">sep</a>, <span title="Char('/')" class="char">'/'</span>)
	}

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File,Option[java.util.jar.Manifest])((java.util.zip.ZipOutputStream) =&gt; Unit)Unit" id="18259">withZipOutput</a>(<a title="java.io.File" id="86429">file</a>: <span title="java.io.File">File</span>, <a title="Option[java.util.jar.Manifest]" id="86430">manifest</a>: <span title="Option[java.util.jar.Manifest]">Option</span>[Manifest])(<a title="(java.util.zip.ZipOutputStream) =&gt; Unit" id="86431">f</a>: ZipOutputStream =&gt; Unit)
	{
		<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.FileOutputStream) =&gt; Any)Any">fileOutputStream</a>(<span title="Boolean(false)" class="keyword">false</span>)(<a href="#86429" title="java.io.File">file</a>) { <a title="java.io.FileOutputStream" id="86542">fileOut</a> =&gt;
			<span class="keyword">val</span> <a href="#17796" title="(java.util.zip.ZipOutputStream, java.lang.String)">(</a><a href="#86543" title="java.util.zip.ZipOutputStream" id="17796">zipOut</a>, <a href="#86543" title="java.lang.String" id="17798">ext</a>) =
				<a href="#86430" title="Option[java.util.jar.Manifest]">manifest</a> <span title="(java.util.zip.ZipOutputStream, java.lang.String)" class="keyword">match</span>
				{
					<span title="(java.util.jar.JarOutputStream, java.lang.String)" class="keyword">case</span> <a id="1">Some</a>(<a title="java.util.jar.Manifest" id="86546">mf</a>) =&gt;
					{
						<span class="keyword">import</span> Attributes.Name.MANIFEST_VERSION
						<span class="keyword">val</span> <a title="java.util.jar.Attributes" id="86548">main</a> = <a href="#86546" title="java.util.jar.Manifest">mf</a>.<a title="()java.util.jar.Attributes" id="57770">getMainAttributes</a>
						<span title="Unit" class="keyword">if</span>(<span title="=&gt; Boolean">!</span><a href="#86548" title="java.util.jar.Attributes">main</a>.<a title="(Any)Boolean" id="57744">containsKey</a>(<span title="java.util.jar.Attributes.Name">MANIFEST_VERSION</span>))
							<a href="#86548" title="java.util.jar.Attributes">main</a>.<a title="(Any,Any)java.lang.Object" id="57740">put</a>(<span title="java.util.jar.Attributes.Name">MANIFEST_VERSION</span>, <span title="java.lang.String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>)
						<span title="(java.util.jar.JarOutputStream,java.lang.String)(java.util.jar.JarOutputStream, java.lang.String)">(</span><span title="java.util.jar.JarOutputStream" class="keyword">new</span> <a title="java.util.jar.JarOutputStream" id="18993">JarOutputStream</a>(<a href="#86542" title="java.io.FileOutputStream">fileOut</a>, <a href="#86546" title="java.util.jar.Manifest">mf</a>), <span title="java.lang.String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span>)
					}
					<span title="(java.util.zip.ZipOutputStream, java.lang.String)" class="keyword">case</span> <span title="object None">None</span> =&gt; <span title="(java.util.zip.ZipOutputStream,java.lang.String)(java.util.zip.ZipOutputStream, java.lang.String)">(</span><span title="java.util.zip.ZipOutputStream" class="keyword">new</span> <span title="java.util.zip.ZipOutputStream">ZipOutputStream</span>(<a href="#86542" title="java.io.FileOutputStream">fileOut</a>), <span title="java.lang.String(&quot;zip&quot;)" class="string">&quot;zip&quot;</span>)
				}
			<span class="keyword">try</span> { <a href="#86431" title="(java.util.zip.ZipOutputStream)Unit">f</a>(<a href="#17796" title="java.util.zip.ZipOutputStream">zipOut</a>) }
			<span class="keyword">catch</span> { <span title="java.lang.String" class="keyword">case</span> <a title="Exception" id="86562">e</a>: <span title="Exception">Exception</span> =&gt; <span title="java.lang.String(&quot;Error writing &quot;)" class="string">&quot;Error writing &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#17798" title="java.lang.String">ext</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86562" title="Exception">e</a>.<a title="()java.lang.String" id="17833">toString</a> }
			<span class="keyword">finally</span> { <a href="#17796" title="java.util.zip.ZipOutputStream">zipOut</a>.<a title="()Unit" id="60973">close</a> }
		}
	}
	<span class="keyword">def</span> <a title="(java.io.File,java.io.File)Option[String]" id="18260">relativize</a>(<a title="java.io.File" id="86567">base</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="86568">file</a>: <span title="java.io.File">File</span>): <span title="Option[String]">Option</span>[String] =
	{
		<span class="keyword">val</span> <a title="java.lang.String" id="86569">pathString</a> = <a href="#86568" title="java.io.File">file</a>.<span title="()java.lang.String">getAbsolutePath</span>
		<a href="#18261" title="(java.io.File)Option[String]">baseFileString</a>(<a href="#86567" title="java.io.File">base</a>) <a title="((String) =&gt; Option[String])Option[String]" id="30333">flatMap</a>
		{
			<a title="String" id="86573">baseString</a> =&gt;
			{
				<span title="Option[String]" class="keyword">if</span>(<a href="#86569" title="java.lang.String">pathString</a>.<a title="(java.lang.String)Boolean" id="6374">startsWith</a>(<a href="#86573" title="String">baseString</a>))
					<span title="(java.lang.String)Some[java.lang.String]">Some</span>(<a href="#86569" title="java.lang.String">pathString</a>.<span title="(Int)java.lang.String">substring</span>(<a href="#86573" title="String">baseString</a>.<span title="()Int">length</span>))
				<span class="keyword">else</span>
					<span title="object None">None</span>
			}
		}
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File)Option[String]" id="18261">baseFileString</a>(<a title="java.io.File" id="86570">baseFile</a>: <span title="java.io.File">File</span>): <span title="Option[String]">Option</span>[String] =
	{
		<span title="Option[String]" class="keyword">if</span>(<a href="#86570" title="java.io.File">baseFile</a>.<span title="()Boolean">isDirectory</span>)
		{
			<span class="keyword">val</span> <a title="java.lang.String" id="86577">cp</a> = <a href="#86570" title="java.io.File">baseFile</a>.<span title="()java.lang.String">getAbsolutePath</span>
			<a title="(Boolean)Unit" id="6479">assert</a>(<a href="#86577" title="java.lang.String">cp</a>.<span title="()Int">length</span> <span title="(Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>)
			<span title="Option[String]" class="keyword">if</span>(<a href="#86577" title="java.lang.String">cp</a>.<a title="(Int)Char" id="6354">charAt</a>(<a href="#86577" title="java.lang.String">cp</a>.<span title="()Int">length</span> <a title="(Int)Int" id="3091">-</a> <span title="Int(1)" class="int">1</span>) <span title="(Char)Boolean">==</span> <span title="object java.io.File">File</span>.<span title="Char">separatorChar</span>)
				<span title="(java.lang.String)Some[java.lang.String]">Some</span>(<a href="#86577" title="java.lang.String">cp</a>)
			<span class="keyword">else</span>
				<span title="(java.lang.String)Some[java.lang.String]">Some</span>(<a href="#86577" title="java.lang.String">cp</a> <span title="(Any)java.lang.String">+</span> <span title="object java.io.File">File</span>.<span title="Char">separatorChar</span>)
		}
		<span class="keyword">else</span>
			<span title="object None">None</span>
	}
	<span class="keyword">def</span> <a title="(Iterable[(java.io.File, java.io.File)])Set[java.io.File]" id="18262">copy</a>(<a title="Iterable[(java.io.File, java.io.File)]" id="20940">sources</a>: <span title="Iterable[(java.io.File, java.io.File)]">Iterable</span>[(File,File)]): <span title="Set[java.io.File]">Set</span>[File] = <span title="(java.io.File*)scala.collection.immutable.Set[java.io.File]">Set</span>( <a href="#20940" title="Iterable[(java.io.File, java.io.File)]">sources</a>.<a title="(((java.io.File, java.io.File)) =&gt; java.io.File)Iterable[java.io.File]" id="15942">map</a>(<span title="((java.io.File, java.io.File) =&gt; java.io.File)((java.io.File, java.io.File)) =&gt; java.io.File">tupled</span>(<a href="#18263" title="(java.io.File,java.io.File)java.io.File">copyImpl</a>)).<a title="=&gt; Seq[java.io.File]" id="15976">toSeq</a>.<a title="Array[java.io.File]" id="15834">toArray</a> : _*)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File,java.io.File)java.io.File" id="18263">copyImpl</a>(<a title="java.io.File" id="86682">from</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="86683">to</a>: <span title="java.io.File">File</span>): <span title="java.io.File">File</span> =
	{
		<span title="Unit" class="keyword">if</span>(<span title="=&gt; Boolean">!</span><a href="#86683" title="java.io.File">to</a>.<span title="()Boolean">exists</span> <span title="(Boolean)Boolean">||</span> <a href="#86682" title="java.io.File">from</a>.<span title="()Long">lastModified</span> <a title="(Long)Boolean" id="3211">&gt;</a> <a href="#86683" title="java.io.File">to</a>.<span title="()Long">lastModified</span>)
		{
			<span title="Unit" class="keyword">if</span>(<a href="#86682" title="java.io.File">from</a>.<span title="()Boolean">isDirectory</span>)
				<a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#86683" title="java.io.File">to</a>)
			<span class="keyword">else</span>
			{
				<a href="#18235" title="(java.io.File)Unit">createDirectory</a>(<a href="#86683" title="java.io.File">to</a>.<span title="()java.io.File">getParentFile</span>)
				<a href="#18264" title="(java.io.File,java.io.File)Unit">copyFile</a>(<a href="#86682" title="java.io.File">from</a>, <a href="#86683" title="java.io.File">to</a>)
			}
		}
		<a href="#86683" title="java.io.File">to</a>
	}
	<span class="keyword">def</span> <a title="(java.io.File,java.io.File)Unit" id="18264">copyFile</a>(<a title="java.io.File" id="80026">sourceFile</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="80027">targetFile</a>: <span title="java.io.File">File</span>)
	{
		<span title="(Boolean,Any)Unit">require</span>(<a href="#80026" title="java.io.File">sourceFile</a>.<span title="()Boolean">exists</span>, <span title="java.lang.String(&quot;Source file '&quot;)" class="string">&quot;Source file '&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#80026" title="java.io.File">sourceFile</a>.<span title="()java.lang.String">getAbsolutePath</span> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;' does not exist.&quot;)" class="string">&quot;' does not exist.&quot;</span>)
		<span title="(Boolean,Any)Unit">require</span>(<span title="=&gt; Boolean">!</span><a href="#80026" title="java.io.File">sourceFile</a>.<span title="()Boolean">isDirectory</span>, <span title="java.lang.String(&quot;Source file '&quot;)" class="string">&quot;Source file '&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#80026" title="java.io.File">sourceFile</a>.<span title="()java.lang.String">getAbsolutePath</span> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;' is a directory.&quot;)" class="string">&quot;' is a directory.&quot;</span>)
		<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.nio.channels.FileChannel) =&gt; Unit)Unit">fileInputChannel</a>(<a href="#80026" title="java.io.File">sourceFile</a>) { <a title="java.nio.channels.FileChannel" id="86718">in</a> =&gt;
			<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.nio.channels.FileChannel) =&gt; Unit)Unit">fileOutputChannel</a>(<a href="#80027" title="java.io.File">targetFile</a>) { <a title="java.nio.channels.FileChannel" id="86731">out</a> =&gt;
				<span class="keyword">val</span> <a title="Long" id="86732">copied</a> = <a href="#86731" title="java.nio.channels.FileChannel">out</a>.<a title="(java.nio.channels.ReadableByteChannel,Long,Long)Long" id="61741">transferFrom</a>(<a href="#86718" title="java.nio.channels.FileChannel">in</a>, <span title="Long(0L)" class="int">0</span>, <a href="#86718" title="java.nio.channels.FileChannel">in</a>.<span title="()Long">size</span>)
				<span title="Unit" class="keyword">if</span>(<a href="#86732" title="Long">copied</a> <a title="(Long)Boolean" id="3208">!=</a> <a href="#86718" title="java.nio.channels.FileChannel">in</a>.<span title="()Long">size</span>)
					<span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;Could not copy '&quot;)" class="string">&quot;Could not copy '&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#80026" title="java.io.File">sourceFile</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;' to '&quot;)" class="string">&quot;' to '&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#80027" title="java.io.File">targetFile</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;' (&quot;)" class="string">&quot;' (&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86732" title="Long">copied</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86718" title="java.nio.channels.FileChannel">in</a>.<span title="()Long">size</span> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; bytes copied)&quot;)" class="string">&quot; bytes copied)&quot;</span>)
			}
		}
	}
	<span class="keyword">def</span> <a title="=&gt; java.nio.charset.Charset" id="18265">defaultCharset</a> = <a href="#18218" title="=&gt; java.nio.charset.Charset">utf8</a>
	<span class="keyword">def</span> <a title="(java.io.File,String)Unit" id="18266">write</a>(<a title="java.io.File" id="55033">toFile</a>: <span title="java.io.File">File</span>, <a title="String" id="55034">content</a>: <span title="String">String</span>): <span title="Unit">Unit</span> = <a href="#18267" title="(java.io.File,String,java.nio.charset.Charset)Unit">write</a>(<a href="#55033" title="java.io.File">toFile</a>, <a href="#55034" title="String">content</a>, <a href="#18265" title="=&gt; java.nio.charset.Charset">defaultCharset</a>)
	<span class="keyword">def</span> <a title="(java.io.File,String,java.nio.charset.Charset)Unit" id="18267">write</a>(<a title="java.io.File" id="55030">toFile</a>: <span title="java.io.File">File</span>, <a title="String" id="55031">content</a>: <span title="String">String</span>, <a title="java.nio.charset.Charset" id="55032">charset</a>: <span title="java.nio.charset.Charset">Charset</span>): <span title="Unit">Unit</span> = <a href="#18268" title="(java.io.File,String,java.nio.charset.Charset,Boolean)Unit">write</a>(<a href="#55030" title="java.io.File">toFile</a>, <a href="#55031" title="String">content</a>, <a href="#55032" title="java.nio.charset.Charset">charset</a>, <span title="Boolean(false)" class="keyword">false</span>)
	<span class="keyword">def</span> <a title="(java.io.File,String,java.nio.charset.Charset,Boolean)Unit" id="18268">write</a>(<a title="java.io.File" id="55026">file</a>: <span title="java.io.File">File</span>, <a title="String" id="55027">content</a>: <span title="String">String</span>, <a title="java.nio.charset.Charset" id="55028">charset</a>: <span title="java.nio.charset.Charset">Charset</span>, <a title="Boolean" id="55029">append</a>: <span title="Boolean">Boolean</span>): <span title="Unit">Unit</span> =
		<a href="#18269" title="(java.io.File,String,java.nio.charset.Charset,Boolean)((java.io.BufferedWriter) =&gt; Unit)Unit">writeCharset</a>(<a href="#55026" title="java.io.File">file</a>, <a href="#55027" title="String">content</a>, <a href="#55028" title="java.nio.charset.Charset">charset</a>, <a href="#55029" title="Boolean">append</a>) { <a href="#86745" title="java.io.BufferedWriter">_</a>.<span title="(java.lang.String)Unit">write</span>(<a href="#55027" title="String">content</a>)  }

	<span class="keyword">def</span> <a title="[T](java.io.File,String,java.nio.charset.Charset,Boolean)((java.io.BufferedWriter) =&gt; T)T" id="18269">writeCharset</a>[<a title="&gt;: Nothing &lt;: Any" id="18271">T</a>](<a title="java.io.File" id="86738">file</a>: <span title="java.io.File">File</span>, <a title="String" id="86739">content</a>: <span title="String">String</span>, <a title="java.nio.charset.Charset" id="86740">charset</a>: <span title="java.nio.charset.Charset">Charset</span>, <a title="Boolean" id="86741">append</a>: <span title="Boolean">Boolean</span>)(<a title="(java.io.BufferedWriter) =&gt; T" id="86742">f</a>: BufferedWriter =&gt; T): <a href="#18271" title="T">T</a> =
	{
		<span title="T" class="keyword">if</span>(<a href="#86740" title="java.nio.charset.Charset">charset</a>.<a title="()java.nio.charset.CharsetEncoder" id="45687">newEncoder</a>.<a title="(java.lang.CharSequence)Boolean" id="48283">canEncode</a>(<a href="#86739" title="String">content</a>))
			<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.BufferedWriter) =&gt; T)T">fileWriter</a>(<a href="#86740" title="java.nio.charset.Charset">charset</a>, <a href="#86741" title="Boolean">append</a>)(<a href="#86738" title="java.io.File">file</a>) { <a href="#86742" title="(java.io.BufferedWriter) =&gt; T">f</a> }
		<span class="keyword">else</span>
			<span title="(String)Nothing">error</span>(<span title="java.lang.String(&quot;String cannot be encoded by charset &quot;)" class="string">&quot;String cannot be encoded by charset &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86740" title="java.nio.charset.Charset">charset</a>.<span title="()java.lang.String">name</span>)
	}

	<span class="keyword">def</span> <a title="(java.io.File)String" id="18272">read</a>(<a title="java.io.File" id="85123">file</a>: <span title="java.io.File">File</span>): <span title="String">String</span> = <a href="#18273" title="(java.io.File,java.nio.charset.Charset)String">read</a>(<a href="#85123" title="java.io.File">file</a>, <a href="#18265" title="=&gt; java.nio.charset.Charset">defaultCharset</a>)
	<span class="keyword">def</span> <a title="(java.io.File,java.nio.charset.Charset)String" id="18273">read</a>(<a title="java.io.File" id="85121">file</a>: <span title="java.io.File">File</span>, <a title="java.nio.charset.Charset" id="85122">charset</a>: <span title="java.nio.charset.Charset">Charset</span>): <span title="String">String</span> =
	{
		<span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="86798">out</a> = <a title="(Int)java.io.ByteArrayOutputStream" id="62365" class="keyword">new</a> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span>(<a href="#85121" title="java.io.File">file</a>.<a title="()Long" id="16777">length</a>.<a title="=&gt; Int" id="3137">toInt</a>)
		<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.FileInputStream) =&gt; Unit)Unit">fileInputStream</a>(<a href="#85121" title="java.io.File">file</a>){ <a title="java.io.FileInputStream" id="86802">in</a> =&gt; <a href="#18240" title="(java.io.InputStream,java.io.OutputStream)Unit">transfer</a>(<a href="#86802" title="java.io.FileInputStream">in</a>, <a href="#86798" title="java.io.ByteArrayOutputStream">out</a>) }
		<a href="#86798" title="java.io.ByteArrayOutputStream">out</a>.<span title="(java.lang.String)java.lang.String">toString</span>(<a href="#85122" title="java.nio.charset.Charset">charset</a>.<span title="()java.lang.String">name</span>)
	}
	<span class="comment">/** doesn't close the InputStream */</span>
	<span class="keyword">def</span> <a title="(java.io.InputStream)String" id="18274">read</a>(<a title="java.io.InputStream" id="85120">in</a>: <span title="java.io.InputStream">InputStream</span>): <span title="String">String</span> = <a href="#18275" title="(java.io.InputStream,java.nio.charset.Charset)String">read</a>(<a href="#85120" title="java.io.InputStream">in</a>, <a href="#18265" title="=&gt; java.nio.charset.Charset">defaultCharset</a>)
	<span class="comment">/** doesn't close the InputStream */</span>
	<span class="keyword">def</span> <a title="(java.io.InputStream,java.nio.charset.Charset)String" id="18275">read</a>(<a title="java.io.InputStream" id="85118">in</a>: <span title="java.io.InputStream">InputStream</span>, <a title="java.nio.charset.Charset" id="85119">charset</a>: <span title="java.nio.charset.Charset">Charset</span>): <span title="String">String</span> =
	{
		<span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="86817">out</a> = <span title="java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span>
		<a href="#18240" title="(java.io.InputStream,java.io.OutputStream)Unit">transfer</a>(<a href="#85118" title="java.io.InputStream">in</a>, <a href="#86817" title="java.io.ByteArrayOutputStream">out</a>)
		<a href="#86817" title="java.io.ByteArrayOutputStream">out</a>.<span title="(java.lang.String)java.lang.String">toString</span>(<a href="#85119" title="java.nio.charset.Charset">charset</a>.<span title="()java.lang.String">name</span>)
	}
	<span class="keyword">def</span> <a title="(java.io.File)Array[Byte]" id="18276">readBytes</a>(<a title="java.io.File" id="86823">file</a>: <span title="java.io.File">File</span>): <span title="Array[Byte]">Array</span>[Byte] = <a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.FileInputStream) =&gt; Array[Byte])Array[Byte]">fileInputStream</a>(<a href="#86823" title="java.io.File">file</a>)(<a href="#18277" title="(java.io.InputStream)Array[Byte]">readBytes</a>)
	<span class="comment">/** doesn't close the InputStream */</span>
	<span class="keyword">def</span> <a title="(java.io.InputStream)Array[Byte]" id="18277">readBytes</a>(<a title="java.io.InputStream" id="86826">in</a>: <span title="java.io.InputStream">InputStream</span>): <span title="Array[Byte]">Array</span>[Byte] =
	{
		<span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="86830">out</a> = <span title="java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span>
		<a href="#18240" title="(java.io.InputStream,java.io.OutputStream)Unit">transfer</a>(<a href="#86826" title="java.io.InputStream">in</a>, <a href="#86830" title="java.io.ByteArrayOutputStream">out</a>)
		<a href="#86830" title="java.io.ByteArrayOutputStream">out</a>.<a title="()Array[Byte]" id="62370">toByteArray</a>
	}

	<span class="comment">// Not optimized for large files</span>
	<span class="keyword">def</span> <a title="(java.io.File)List[String]" id="18278">readLines</a>(<a title="java.io.File" id="67021">file</a>: <span title="java.io.File">File</span>): <span title="List[String]">List</span>[String] = <a href="#18279" title="(java.io.File,java.nio.charset.Charset)List[String]">readLines</a>(<a href="#67021" title="java.io.File">file</a>, <a href="#18265" title="=&gt; java.nio.charset.Charset">defaultCharset</a>)
	<span class="keyword">def</span> <a title="(java.io.File,java.nio.charset.Charset)List[String]" id="18279">readLines</a>(<a title="java.io.File" id="67019">file</a>: <span title="java.io.File">File</span>, <a title="java.nio.charset.Charset" id="67020">charset</a>: <span title="java.nio.charset.Charset">Charset</span>): <span title="List[String]">List</span>[String] =
	{
		<a href="OpenResource.scala.html#79926" title="(java.io.File)((java.io.BufferedReader) =&gt; List[String])List[String]">fileReader</a>(<a href="#67020" title="java.nio.charset.Charset">charset</a>)(<a href="#67019" title="java.io.File">file</a>){ <a title="java.io.BufferedReader" id="86859">in</a> =&gt;
			<span class="keyword">def</span> <a title="(List[String])List[String]" id="86860">readLine</a>(<a title="List[String]" id="86861">accum</a>: <span title="List[String]">List</span>[String]): <span title="List[String]">List</span>[String] =
			{
				<span class="keyword">val</span> <a title="java.lang.String" id="86862">line</a> = <a href="#86859" title="java.io.BufferedReader">in</a>.<a title="()java.lang.String" id="62004">readLine</a>()
				<span title="List[String]" class="keyword">if</span>(<a href="#86862" title="java.lang.String">line</a> <a title="(AnyRef)Boolean" id="6017">eq</a> <span title="Null(null)" class="keyword">null</span>) <a href="#86861" title="List[String]">accum</a>.<a title="=&gt; List[String]" id="15554">reverse</a> <span class="keyword">else</span> <a href="#86860" title="(List[String])List[String]">readLine</a>(<a href="#86862" title="java.lang.String">line</a> <a href="#86864" title="(String)List[String]" id="15504">::</a> <a href="#86861" title="List[String]">accum</a>)
			}
			<a href="#86860" title="(List[String])List[String]">readLine</a>(<a title="object Nil" id="314">Nil</a>)
		}
	}
	<span class="keyword">def</span> <a title="(java.io.File,Seq[String])Unit" id="18280">writeLines</a>(<a title="java.io.File" id="82735">file</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="82736">lines</a>: <span title="Seq[String]">Seq</span>[String]): <span title="Unit">Unit</span> = <a href="#18281" title="(java.io.File,Seq[String],java.nio.charset.Charset)Unit">writeLines</a>(<a href="#82735" title="java.io.File">file</a>, <a href="#82736" title="Seq[String]">lines</a>, <a href="#18265" title="=&gt; java.nio.charset.Charset">defaultCharset</a>)
	<span class="keyword">def</span> <a title="(java.io.File,Seq[String],java.nio.charset.Charset)Unit" id="18281">writeLines</a>(<a title="java.io.File" id="82732">file</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="82733">lines</a>: <span title="Seq[String]">Seq</span>[String], <a title="java.nio.charset.Charset" id="82734">charset</a>: <span title="java.nio.charset.Charset">Charset</span>): <span title="Unit">Unit</span> = <a href="#18282" title="(java.io.File,Seq[String],java.nio.charset.Charset,Boolean)Unit">writeLines</a>(<a href="#82732" title="java.io.File">file</a>, <a href="#82733" title="Seq[String]">lines</a>, <a href="#82734" title="java.nio.charset.Charset">charset</a>, <span title="Boolean(false)" class="keyword">false</span>)
	<span class="keyword">def</span> <a title="(java.io.File,Seq[String],java.nio.charset.Charset,Boolean)Unit" id="18282">writeLines</a>(<a title="java.io.File" id="82728">file</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="82729">lines</a>: <span title="Seq[String]">Seq</span>[String], <a title="java.nio.charset.Charset" id="82730">charset</a>: <span title="java.nio.charset.Charset">Charset</span>, <a title="Boolean" id="82731">append</a>: <span title="Boolean">Boolean</span>): <span title="Unit">Unit</span> =
		<a href="#18269" title="(java.io.File,String,java.nio.charset.Charset,Boolean)((java.io.BufferedWriter) =&gt; Unit)Unit">writeCharset</a>(<a href="#82728" title="java.io.File">file</a>, <a href="#82729" title="Seq[String]">lines</a>.<a title="=&gt; Option[String]" id="15811">headOption</a>.<a title="(=&gt; String)String" id="30329">getOrElse</a>(<span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>), <a href="#82730" title="java.nio.charset.Charset">charset</a>, <a href="#82731" title="Boolean">append</a>) { <a title="java.io.BufferedWriter" id="86873">w</a> =&gt;
			<a href="#82729" title="Seq[String]">lines</a>.<span title="((String) =&gt; Unit)Unit">foreach</span> { <a title="String" id="86875">line</a> =&gt; <a href="#86873" title="java.io.BufferedWriter">w</a>.<span title="(java.lang.String)Unit">write</span>(<a href="#86875" title="String">line</a>); <a href="#86873" title="java.io.BufferedWriter">w</a>.<a title="()Unit" id="48223">newLine</a>() }
		}

	<span class="comment">/** A pattern used to split a String by path separator characters.*/</span>
	<span class="keyword">private</span> <span class="keyword">val</span> <a title="java.util.regex.Pattern" id="18283">PathSeparatorPattern</a> = java.util.regex.<a title="object java.util.regex.Pattern" id="17185">Pattern</a>.<a title="(java.lang.String)java.util.regex.Pattern" id="55333">compile</a>(<span title="object java.io.File">File</span>.<a title="java.lang.String" id="16752">pathSeparator</a>)

	<span class="comment">/** Splits a String around path separator characters. */</span>
	<span class="keyword">def</span> <a title="(String)Array[java.lang.String]" id="18285">pathSplit</a>(<a title="String" id="86878">s</a>: <span title="String">String</span>) = <a href="#18283" title="=&gt; java.util.regex.Pattern">PathSeparatorPattern</a>.<a title="(java.lang.CharSequence)Array[java.lang.String]" id="55341">split</a>(<a href="#86878" title="String">s</a>)

	<span class="comment">/** Move the provided files to a temporary location.
	*   If 'f' returns normally, delete the files.
	*   If 'f' throws an Exception, return the files to their original location.*/</span>
	<span class="keyword">def</span> <a title="[T](Set[java.io.File])(=&gt; T)T" id="18286">stash</a>[<a title="&gt;: Nothing &lt;: Any" id="18288">T</a>](<a title="Set[java.io.File]" id="86881">files</a>: <span title="Set[java.io.File]">Set</span>[File])(<a title="=&gt; T" id="86882">f</a>: =&gt; T): <a href="#18288" title="T">T</a> =
		<a href="#18243" title="((java.io.File) =&gt; T)T">withTemporaryDirectory</a> { <a title="java.io.File" id="86885">dir</a> =&gt;
			<span class="keyword">val</span> <a title="Array[(java.io.File, java.io.File)]" id="86886">stashed</a> = <a href="#18289" title="(java.io.File,Array[java.io.File])Array[(java.io.File, java.io.File)]">stashLocations</a>(<a href="#86885" title="java.io.File">dir</a>, <a href="#86881" title="Set[java.io.File]">files</a>.<a title="Array[java.io.File]" id="17973">toArray</a>)
			<a href="#18290" title="(Iterable[(java.io.File, java.io.File)])Unit">move</a>(<a href="#86886" title="Array[(java.io.File, java.io.File)]">stashed</a>)

			<span class="keyword">try</span> { <a href="#86882" title="=&gt; T">f</a> } <span class="keyword">catch</span> { <span title="T" class="keyword">case</span> <a title="Exception" id="86929">e</a>: <span title="Exception">Exception</span> =&gt;
				<span class="keyword">try</span> { <a href="#18290" title="(Iterable[(java.io.File, java.io.File)])Unit">move</a>(<a href="#86886" title="Array[(java.io.File, java.io.File)]">stashed</a>.<span title="(((java.io.File, java.io.File)) =&gt; (java.io.File, java.io.File))Array[(java.io.File, java.io.File)]">map</span>(<a href="#86933" title="(java.io.File, java.io.File)">_</a>.<a title="=&gt; (java.io.File, java.io.File)" id="17802">swap</a>)); <span title="Nothing" class="keyword">throw</span> <a href="#86929" title="Exception">e</a> }
				<span class="keyword">catch</span> { <span title="Nothing" class="keyword">case</span> _: <span title="Exception">Exception</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#86929" title="Exception">e</a> }
			}
		}

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(java.io.File,Array[java.io.File])Array[(java.io.File, java.io.File)]" id="18289">stashLocations</a>(<a title="java.io.File" id="86887">dir</a>: <span title="java.io.File">File</span>, <a title="Array[java.io.File]" id="86888">files</a>: <span title="Array[java.io.File]">Array</span>[File]) =
		<span class="keyword">for</span>( <a href="#86892" title="(((java.io.File, Int)) =&gt; (java.io.File, java.io.File))Array[(java.io.File, java.io.File)]" id="15682">(</a><a title="java.io.File" id="86899">file</a>, <a title="Int" id="86900">index</a>) &lt;- <a href="#86888" title="Array[java.io.File]">files</a>.<a title="=&gt; Array[(java.io.File, Int)]" id="15691">zipWithIndex</a>) <span class="keyword">yield</span>
			<span title="(java.io.File,java.io.File)(java.io.File, java.io.File)">(</span><a href="#86899" title="java.io.File">file</a>, <span title="(java.io.File,java.lang.String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#86887" title="java.io.File">dir</a>, <a href="#86900" title="implicit scala.Predef.intWrapper : (Int)scala.runtime.RichInt" id="6609">index</a>.<a title="=&gt; String" id="17939">toHexString</a>))

	<span class="keyword">def</span> <a title="(Iterable[(java.io.File, java.io.File)])Unit" id="18290">move</a>(<a title="Iterable[(java.io.File, java.io.File)]" id="86928">files</a>: <span title="Iterable[(java.io.File, java.io.File)]">Iterable</span>[(File, File)]): <span title="Unit">Unit</span> =
		<a href="#86928" title="Iterable[(java.io.File, java.io.File)]">files</a>.<span title="(((java.io.File, java.io.File)) =&gt; Unit)Unit">foreach</span>(<span title="object Function">Function</span>.<span title="((java.io.File, java.io.File) =&gt; Unit)((java.io.File, java.io.File)) =&gt; Unit">tupled</span>(<a href="#18291" title="(java.io.File,java.io.File)Unit">move</a>))
		
	<span class="keyword">def</span> <a title="(java.io.File,java.io.File)Unit" id="18291">move</a>(<a title="java.io.File" id="86926">a</a>: <span title="java.io.File">File</span>, <a title="java.io.File" id="86927">b</a>: <span title="java.io.File">File</span>): <span title="Unit">Unit</span> =
	{
		<span title="Unit" class="keyword">if</span>(<a href="#86927" title="java.io.File">b</a>.<span title="()Boolean">exists</span>)
			<a href="#18249" title="(java.io.File)Unit">delete</a>(<a href="#86927" title="java.io.File">b</a>)
		<span title="Unit" class="keyword">if</span>(<span title="=&gt; Boolean">!</span><a href="#86926" title="java.io.File">a</a>.<a title="(java.io.File)Boolean" id="16788">renameTo</a>(<a href="#86927" title="java.io.File">b</a>))
		{
			<a href="#18264" title="(java.io.File,java.io.File)Unit">copyFile</a>(<a href="#86926" title="java.io.File">a</a>, <a href="#86927" title="java.io.File">b</a>)
			<a href="#18249" title="(java.io.File)Unit">delete</a>(<a href="#86926" title="java.io.File">a</a>)
		}
	}
}

        </pre>
    </body>
</html>