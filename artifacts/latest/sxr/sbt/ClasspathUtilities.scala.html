<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/ClasspathUtilities.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.{URI, URL, URLClassLoader}
<span class="keyword">import</span> java.util.Collections
<span class="keyword">import</span> scala.collection.Set
<span class="keyword">import</span> scala.collection.mutable.{HashSet, ListBuffer}

<span class="keyword">object</span> <a title="object sbt.ClasspathUtilities" id="11386">ClasspathUtilities</a>
{
	<span class="keyword">def</span> <a title="(sbt.PathFinder)Array[java.net.URL]" id="30135">toClasspath</a>(<a title="sbt.PathFinder" id="39179">finder</a>: <a href="Path.scala.html#8754" title="sbt.PathFinder">PathFinder</a>): <span title="Array[java.net.URL]">Array</span>[URL] = <a href="#39179" title="sbt.PathFinder">finder</a>.<a href="Path.scala.html#15981" title="=&gt; Array[java.net.URL]">getURLs</a>
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path])Array[java.net.URL]" id="30136">toClasspath</a>(<a title="Iterable[sbt.Path]" id="39181">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="Array[java.net.URL]">Array</span>[URL] = <a href="Path.scala.html#10153" title="object sbt.Path">Path</a>.<a href="Path.scala.html#15379" title="(Iterable[sbt.Path])Array[java.net.URL]">getURLs</a>(<a href="#39181" title="Iterable[sbt.Path]">paths</a>)
	<span class="keyword">def</span> <a title="(sbt.PathFinder)java.lang.ClassLoader" id="30137">toLoader</a>(<a title="sbt.PathFinder" id="33342">finder</a>: <a href="Path.scala.html#8754" title="sbt.PathFinder">PathFinder</a>): <span title="java.lang.ClassLoader">ClassLoader</span> = <a href="#30139" title="(Iterable[sbt.Path])java.lang.ClassLoader">toLoader</a>(<a href="#33342" title="sbt.PathFinder">finder</a>.<a href="Path.scala.html#15978" title="=&gt; scala.collection.Set[sbt.Path]">get</a>)
	<span class="keyword">def</span> <a title="(sbt.PathFinder,java.lang.ClassLoader)java.lang.ClassLoader" id="30138">toLoader</a>(<a title="sbt.PathFinder" id="33340">finder</a>: <a href="Path.scala.html#8754" title="sbt.PathFinder">PathFinder</a>, <a title="java.lang.ClassLoader" id="33341">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> = <a href="#30140" title="(Iterable[sbt.Path],java.lang.ClassLoader)java.lang.ClassLoader">toLoader</a>(<a href="#33340" title="sbt.PathFinder">finder</a>.<a href="Path.scala.html#15978" title="=&gt; scala.collection.Set[sbt.Path]">get</a>, <a href="#33341" title="java.lang.ClassLoader">parent</a>)
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path])java.lang.ClassLoader" id="30139">toLoader</a>(<a title="Iterable[sbt.Path]" id="33331">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="java.net.URLClassLoader" class="keyword">new</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#30136" title="(Iterable[sbt.Path])Array[java.net.URL]">toClasspath</a>(<a href="#33331" title="Iterable[sbt.Path]">paths</a>), <a href="#30141" title="=&gt; java.lang.ClassLoader">rootLoader</a>)
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path],java.lang.ClassLoader)java.lang.ClassLoader" id="30140">toLoader</a>(<a title="Iterable[sbt.Path]" id="33329">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path], <a title="java.lang.ClassLoader" id="33330">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="java.net.URLClassLoader" class="keyword">new</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#30136" title="(Iterable[sbt.Path])Array[java.net.URL]">toClasspath</a>(<a href="#33329" title="Iterable[sbt.Path]">paths</a>), <a href="#33330" title="java.lang.ClassLoader">parent</a>)
	
	<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.lang.ClassLoader" id="30142">rootLoader</a> =
	{
		<span class="keyword">def</span> <a title="(java.lang.ClassLoader)java.lang.ClassLoader" id="39246">parent</a>(<a title="java.lang.ClassLoader" id="39247">loader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> =
		{
			<span class="keyword">val</span> <a title="java.lang.ClassLoader" id="39248">p</a> = <a href="#39247" title="java.lang.ClassLoader">loader</a>.<a title="()java.lang.ClassLoader" id="23704">getParent</a>
			<span title="java.lang.ClassLoader" class="keyword">if</span>(<a href="#39248" title="java.lang.ClassLoader">p</a> <a title="(AnyRef)Boolean" id="5739">eq</a> <span title="Null(null)" class="keyword">null</span>) <a href="#39247" title="java.lang.ClassLoader">loader</a> <span class="keyword">else</span> <a href="#39246" title="(java.lang.ClassLoader)java.lang.ClassLoader">parent</a>(<a href="#39248" title="java.lang.ClassLoader">p</a>)
		}
		<a href="#39246" title="(java.lang.ClassLoader)java.lang.ClassLoader">parent</a>(<a title="()java.lang.Class[_ &lt;: java.lang.Object]" id="3459">getClass</a>.<span title="()java.lang.ClassLoader">getClassLoader</span>)
	}
	
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Class[_])Unit" id="30143">printSource</a>(<a title="Class[_]" id="39266">c</a>: <span title="Class[_]">Class</span>[_]) =
		<a title="(Any)Unit" id="6197">println</a>(<a href="#39266" title="Class[_]">c</a>.<a title="()java.lang.String" id="3899">getName</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; loader=&quot;)" class="string">&quot; loader=&quot;</span> <span title="(Any)java.lang.String">+</span><a href="#39266" title="Class[_]">c</a>.<span title="()java.lang.ClassLoader">getClassLoader</span> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; location=&quot;)" class="string">&quot; location=&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="FileUtilities.scala.html#9046" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15328" title="(Class[_])java.io.File">classLocationFile</a>(<a href="#39266" title="Class[_]">c</a>))
	
	<span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="30144">isArchive</a>(<a title="sbt.Path" id="30165">path</a>: <a href="Path.scala.html#10152" title="sbt.Path">Path</a>): <span title="Boolean">Boolean</span> = <a href="#30145" title="(java.io.File)Boolean">isArchive</a>(<a href="#30165" title="sbt.Path">path</a>.<a href="Path.scala.html#17865" title="=&gt; java.io.File">asFile</a>)
	<span class="keyword">def</span> <a title="(java.io.File)Boolean" id="30145">isArchive</a>(<a title="java.io.File" id="30164">file</a>: <span title="java.io.File">File</span>): <span title="Boolean">Boolean</span> = <a href="#30146" title="(String)Boolean">isArchiveName</a>(<a href="#30164" title="java.io.File">file</a>.<a title="()java.lang.String" id="16008">getName</a>)
	<span class="keyword">def</span> <a title="(String)Boolean" id="30146">isArchiveName</a>(<a title="String" id="39281">fileName</a>: <span title="String">String</span>) = <a href="#39281" title="String">fileName</a>.<span title="(java.lang.String)Boolean">endsWith</span>(<span title="java.lang.String(&quot;.jar&quot;)" class="string">&quot;.jar&quot;</span>) <span title="(Boolean)Boolean">||</span> <a href="#39281" title="String">fileName</a>.<span title="(java.lang.String)Boolean">endsWith</span>(<span title="java.lang.String(&quot;.zip&quot;)" class="string">&quot;.zip&quot;</span>)
	<span class="comment">// Partitions the given classpath into (jars, directories)</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])" id="30147">separate</a>(<a title="Iterable[java.io.File]" id="39283">paths</a>: <span title="Iterable[java.io.File]">Iterable</span>[File]): <span title="(Iterable[java.io.File], Iterable[java.io.File])">(</span>Iterable[File], Iterable[File]) = <a href="#39283" title="Iterable[java.io.File]">paths</a>.<a title="((java.io.File) =&gt; Boolean)(Iterable[java.io.File], Iterable[java.io.File])" id="16065">partition</a>(<a href="#30145" title="(java.io.File)Boolean">isArchive</a>)
	<span class="comment">// Partitions the given classpath into (jars, directories)</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])" id="30148">separatePaths</a>(<a title="Iterable[sbt.Path]" id="39288">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]) = <a href="#30147" title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])">separate</a>(<a href="#39288" title="Iterable[sbt.Path]">paths</a>.<a title="((sbt.Path) =&gt; java.io.File)Iterable[java.io.File]" id="16060">map</a>(<a href="#39292" title="sbt.Path">_</a>.<a href="Path.scala.html#17865" title="=&gt; java.io.File">asFile</a>.<span title="()java.io.File">getCanonicalFile</span>))
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[sbt.Path])(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])" id="30149">buildSearchPaths</a>(<a title="Iterable[sbt.Path]" id="39293">classpath</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])">(</span>wrap.Set[File], wrap.Set[File]) =
	{
		<span class="keyword">val</span> <a href="#39295" title="(Iterable[java.io.File], Iterable[java.io.File])">(</a><a href="#39294" title="Iterable[java.io.File]" id="39295">jars</a>, <a href="#39294" title="Iterable[java.io.File]" id="39296">dirs</a>) = <a href="#30148" title="(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])">separatePaths</a>(<a href="#39293" title="Iterable[sbt.Path]">classpath</a>)
		<span title="(sbt.wrap.Set[java.io.File],sbt.wrap.Set[java.io.File])(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])">(</span><a href="#30160" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39295" title="Iterable[java.io.File]">jars</a> <span title="(Iterable[java.io.File])Collection[java.io.File]">++</span> <a href="#30156" title="=&gt; sbt.wrap.Set[java.io.File]">extraJars</a>.<a href="wrap/Wrappers.scala.html#16129" title="=&gt; List[java.io.File]">toList</a>), <a href="#30160" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39296" title="Iterable[java.io.File]">dirs</a> <span title="(Iterable[java.io.File])Collection[java.io.File]">++</span> <a href="#30158" title="=&gt; sbt.wrap.Set[java.io.File]">extraDirs</a>.<a href="wrap/Wrappers.scala.html#16129" title="=&gt; List[java.io.File]">toList</a>))
	}
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(sbt.wrap.Set[java.io.File],sbt.wrap.Set[java.io.File],java.io.File)Boolean" id="30150">onClasspath</a>(<a title="sbt.wrap.Set[java.io.File]" id="39854">classpathJars</a>: wrap.<a href="wrap/Wrappers.scala.html#14131" title="sbt.wrap.Set[java.io.File]">Set</a>[File], <a title="sbt.wrap.Set[java.io.File]" id="39855">classpathDirectories</a>: wrap.<a href="wrap/Wrappers.scala.html#14131" title="sbt.wrap.Set[java.io.File]">Set</a>[File], <a title="java.io.File" id="39856">file</a>: <span title="java.io.File">File</span>): <span title="Boolean">Boolean</span> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="39857">f</a> = <a href="#39856" title="java.io.File">file</a>.<span title="()java.io.File">getCanonicalFile</span>
		<span title="Boolean" class="keyword">if</span>(<a href="#11386" title="object sbt.ClasspathUtilities">ClasspathUtilities</a>.<a href="#30145" title="(java.io.File)Boolean">isArchive</a>(<a href="#39857" title="java.io.File">f</a>))
			<a href="#39854" title="sbt.wrap.Set[java.io.File]">classpathJars</a>.<a href="wrap/Wrappers.scala.html#16131" title="(java.io.File)Boolean">contains</a>(<a href="#39857" title="java.io.File">f</a>)
		<span class="keyword">else</span>
			<a href="#39855" title="sbt.wrap.Set[java.io.File]">classpathDirectories</a>.<a href="wrap/Wrappers.scala.html#16129" title="=&gt; List[java.io.File]">toList</a>.<a title="((java.io.File) =&gt; Boolean)Option[java.io.File]" id="17764">find</a>(<a href="Path.scala.html#10153" title="object sbt.Path">Path</a>.<a href="Path.scala.html#15369" title="(java.io.File,java.io.File)Option[String]">relativize</a>(<a href="#39862" title="java.io.File">_</a>, <a href="#39857" title="java.io.File">f</a>).<span title="=&gt; Boolean">isDefined</span>).<span title="=&gt; Boolean">isDefined</span>
	}
	
	<span class="comment">/** Returns all entries in 'classpath' that correspond to a compiler plugin.*/</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[sbt.Path])Iterable[java.io.File]" id="30151">compilerPlugins</a>(<a title="Iterable[sbt.Path]" id="39865">classpath</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="Iterable[java.io.File]">Iterable</span>[File] =
	{
		<span class="keyword">val</span> <a title="java.net.URLClassLoader" id="39866">loader</a> = <a title="(Array[java.net.URL])java.net.URLClassLoader" id="39201" class="keyword">new</a> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="Path.scala.html#10153" title="object sbt.Path">Path</a>.<a href="Path.scala.html#15379" title="(Iterable[sbt.Path])Array[java.net.URL]">getURLs</a>(<a href="#39865" title="Iterable[sbt.Path]">classpath</a>))
		wrap.<a href="wrap/Wrappers.scala.html#14084" title="object sbt.wrap.Wrappers">Wrappers</a>.<a href="wrap/Wrappers.scala.html#18043" title="(java.util.Enumeration[java.net.URL])List[java.net.URL]">toList</a>(<a href="#39866" title="java.net.URLClassLoader">loader</a>.<a title="(java.lang.String)java.util.Enumeration[java.net.URL]" id="23293">getResources</a>(<span title="java.lang.String(&quot;scalac-plugin.xml&quot;)" class="string">&quot;scalac-plugin.xml&quot;</span>)).<a title="((java.net.URL) =&gt; Iterable[java.io.File])List[java.io.File]" id="17773">flatMap</a>(<a href="#30153" title="(Boolean)(java.net.URL)List[java.io.File]">asFile</a>(<span title="Boolean(true)" class="keyword">true</span>))
	}
	<span class="comment">/** Converts the given URL to a File.  If the URL is for an entry in a jar, the File for the jar is returned. */</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(java.net.URL)List[java.io.File]" id="30152">asFile</a>(<a title="java.net.URL" id="39885">url</a>: <span title="java.net.URL">URL</span>): <span title="List[java.io.File]">List</span>[File] = <a href="#30153" title="(Boolean)(java.net.URL)List[java.io.File]">asFile</a>(<span title="Boolean(false)" class="keyword">false</span>)(<a href="#39885" title="java.net.URL">url</a>)
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Boolean)(java.net.URL)List[java.io.File]" id="30153">asFile</a>(<a title="Boolean" id="39883">jarOnly</a>: <span title="Boolean">Boolean</span>)(<a title="java.net.URL" id="39884">url</a>: <span title="java.net.URL">URL</span>): <span title="List[java.io.File]">List</span>[File] =
	{
		<span class="keyword">try</span>
		{
			<a href="#39884" title="java.net.URL">url</a>.<a title="()java.lang.String" id="25102">getProtocol</a> <span title="List[java.io.File]" class="keyword">match</span>
			{
				<span title="List[java.io.File]" class="keyword">case</span> <span title="java.lang.String(&quot;file&quot;)" class="string">&quot;file&quot;</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#39883" title="Boolean">jarOnly</a>=&gt; <a href="FileUtilities.scala.html#9046" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15324" title="(java.net.URL)java.io.File">toFile</a>(<a href="#39884" title="java.net.URL">url</a>) <a href="#39900" title="(java.io.File)List[java.io.File]">::</a> <span title="object Nil">Nil</span>
				<span title="List[java.io.File]" class="keyword">case</span> <span title="java.lang.String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span> =&gt;
					<span class="keyword">val</span> <a title="java.lang.String" id="39909">path</a> = <a href="#39884" title="java.net.URL">url</a>.<a title="()java.lang.String" id="25097">getPath</a>
					<span class="keyword">val</span> <a title="Int" id="39910">end</a> = <a href="#39909" title="java.lang.String">path</a>.<a title="(Int)Int" id="5789">indexOf</a>(<span title="Int(33)" class="char">'!'</span>)
					<a title="(java.net.URI)java.io.File" id="16007" class="keyword">new</a> <span title="java.io.File">File</span>(<span title="java.net.URI" class="keyword">new</span> <a title="java.net.URI" id="4495">URI</a>(<span title="java.lang.String" class="keyword">if</span>(<a href="#39910" title="Int">end</a> <a title="(Int)Boolean" id="3089">==</a> -<span title="Int(-1)" class="int">1</span>) <a href="#39909" title="java.lang.String">path</a> <span class="keyword">else</span> <a href="#39909" title="java.lang.String">path</a>.<a title="(Int,Int)java.lang.String" id="5800">substring</a>(<span title="Int(0)" class="int">0</span>, <a href="#39910" title="Int">end</a>))) <a href="#39917" title="(java.io.File)List[java.io.File]">::</a> <span title="object Nil">Nil</span>
				<span title="Nil.type" class="keyword">case</span> _ =&gt; <span title="object Nil">Nil</span>
			}
		}
		<span class="keyword">catch</span> { <span title="Nil.type" class="keyword">case</span> <a title="Exception" id="39931">e</a>: <a title="Exception" id="2076">Exception</a> =&gt; <span title="object Nil">Nil</span> }
	}
	
	<span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a href="#30157" title="(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])" id="30155">(</a><a href="#30154" title="sbt.wrap.Set[java.io.File]" id="30157">extraJars</a>, <a href="#30154" title="sbt.wrap.Set[java.io.File]" id="30159">extraDirs</a>) =
	{
		<span class="keyword">import</span> scala.tools.nsc.GenericRunnerCommand
		<span class="keyword">val</span> <a title="scala.tools.nsc.GenericRunnerSettings" id="39308">settings</a> = (<a title="(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand" id="39319" class="keyword">new</a> <a title="scala.tools.nsc.GenericRunnerCommand" id="27978">GenericRunnerCommand</a>(<span title="object Nil">Nil</span>, <a title="String" id="39372">message</a> =&gt; <a title="(String)Nothing" id="6085">error</a>(<a href="#39372" title="String">message</a>))).<a title="=&gt; scala.tools.nsc.GenericRunnerSettings" id="39315">settings</a>
		<span class="keyword">val</span> <a title="List[java.io.File]" id="39309">bootPaths</a> = <a href="FileUtilities.scala.html#9046" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15217" title="(String)Array[java.lang.String]">pathSplit</a>(<a href="#39308" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a title="=&gt; settings.StringSetting" id="39545">bootclasspath</a>.<span title="=&gt; String">value</span>).<span title="((java.lang.String) =&gt; java.io.File)Array[java.io.File]">map</span>(<a title="java.lang.String" id="39785">p</a> =&gt; <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#39785" title="java.lang.String">p</a>)).<a title="=&gt; List[java.io.File]" id="16093">toList</a>
		<span class="keyword">val</span> <a href="#39311" title="(Iterable[java.io.File], Iterable[java.io.File])">(</a><a href="#39310" title="Iterable[java.io.File]" id="39311">bootJars</a>, <a href="#39310" title="Iterable[java.io.File]" id="39312">bootDirs</a>) = <a href="#30147" title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])">separate</a>(<a href="#39309" title="List[java.io.File]">bootPaths</a>)
		<span class="keyword">val</span> <a title="List[java.io.File]" id="39313">extJars</a> =
		{
			<span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[java.io.File]" id="39792">buffer</a> = <span title="scala.collection.mutable.ListBuffer[java.io.File]" class="keyword">new</span> <a title="scala.collection.mutable.ListBuffer[java.io.File]" id="15563">ListBuffer</a>[File]
			<span class="keyword">def</span> <a title="(java.io.File)Unit" id="39793">findJars</a>(<a title="java.io.File" id="39794">dir</a>: <span title="java.io.File">File</span>)
			{
				<a href="#39792" title="scala.collection.mutable.ListBuffer[java.io.File]">buffer</a> <a title="(Iterable[java.io.File])Unit" id="18513">++=</a> <a href="#39794" title="java.io.File">dir</a>.<span title="(java.io.FileFilter)Array[java.io.File]">listFiles</span>(<span title="sbt.SimpleFileFilter" class="keyword">new</span> <a href="NameFilter.scala.html#8121" title="sbt.SimpleFileFilter">SimpleFileFilter</a>(<a href="#30145" title="(java.io.File)Boolean">isArchive</a>))
				<span class="keyword">for</span>(<a title="((java.io.File) =&gt; Unit)Unit" id="39814">dir</a> &lt;- <a href="#39794" title="java.io.File">dir</a>.<span title="(java.io.FileFilter)Array[java.io.File]">listFiles</span>(<a href="NameFilter.scala.html#10840" title="object sbt.DirectoryFilter">DirectoryFilter</a>))
					<a href="#39793" title="(java.io.File)Unit">findJars</a>(<a href="#39814" title="java.io.File">dir</a>)
			}
			<span class="keyword">for</span>(<a title="(((java.lang.String, java.io.File)) =&gt; Unit)Unit" id="39831">path</a> &lt;- <a href="FileUtilities.scala.html#9046" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15217" title="(String)Array[java.lang.String]">pathSplit</a>(<a href="#39308" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a title="=&gt; settings.StringSetting" id="39547">extdirs</a>.<span title="=&gt; String">value</span>); <span class="keyword">val</span> <a title="java.io.File" id="39832">dir</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#39831" title="java.lang.String">path</a>) <span class="keyword">if</span> <a href="#39832" title="java.io.File">dir</a>.<a title="()Boolean" id="16022">isDirectory</a>)
				<a href="#39793" title="(java.io.File)Unit">findJars</a>(<a href="#39832" title="java.io.File">dir</a>)
			<a href="#39792" title="scala.collection.mutable.ListBuffer[java.io.File]">buffer</a>.<a title="=&gt; List[java.io.File]" id="24358">readOnly</a>.<a title="((java.io.File) =&gt; java.io.File)List[java.io.File]" id="17752">map</a>(<a href="#39836" title="java.io.File">_</a>.<span title="()java.io.File">getCanonicalFile</span>)
		}
		<span title="(sbt.wrap.Set[java.io.File],sbt.wrap.Set[java.io.File])(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])">(</span><a href="#30160" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39313" title="List[java.io.File]">extJars</a> <a title="(Iterable[java.io.File])List[java.io.File]" id="17731">++</a> <a href="#39311" title="Iterable[java.io.File]">bootJars</a>), <a href="#30160" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39312" title="Iterable[java.io.File]">bootDirs</a>))
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](Iterable[T])sbt.wrap.Set[T]" id="30160">linkedSet</a>[<a title="&gt;: Nothing &lt;: Any" id="30162">T</a>](<a title="Iterable[T]" id="39303">s</a>: <span title="Iterable[T]">Iterable</span>[T]): wrap.<a href="wrap/Wrappers.scala.html#14131" title="sbt.wrap.Set[T]">Set</a>[T] =
	{
		<span class="keyword">val</span> <a title="sbt.wrap.MutableSetWrapper[T]" id="39932">set</a> = <span title="sbt.wrap.MutableSetWrapper[T]" class="keyword">new</span> wrap.<a href="wrap/Wrappers.scala.html#14092" title="sbt.wrap.MutableSetWrapper[T]">MutableSetWrapper</a>(<a title="()java.util.LinkedHashSet[T]" id="16206" class="keyword">new</a> java.util.<a title="java.util.LinkedHashSet[T]" id="5547">LinkedHashSet</a>[T])
		<a href="#39932" title="sbt.wrap.MutableSetWrapper[T]">set</a> <a href="wrap/Wrappers.scala.html#16148" title="(Iterable[T])Unit">++=</a> <a href="#39303" title="Iterable[T]">s</a>
		<a href="#39932" title="sbt.wrap.MutableSetWrapper[T]">set</a>.<a href="wrap/Wrappers.scala.html#16143" title="=&gt; sbt.wrap.Set[T]">readOnly</a>
	}
}

<span class="keyword">private</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class LoaderBase extends java.net.URLClassLoader with NotNull with ScalaObject" id="6840">LoaderBase</a>(<a title="Array[java.net.URL]" id="39951">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="39952">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>) <span class="keyword">extends</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#39951" title="Array[java.net.URL]">urls</a>, <a href="#39952" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span title="(Boolean)Unit">require</span>(<a href="#39952" title="java.lang.ClassLoader">parent</a> <span title="(AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	@<span title="throws">throws</span>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="39945">loadClass</a>(<a title="String" id="39975">className</a>: <span title="String">String</span>, <a title="Boolean" id="39976">resolve</a>: <span title="Boolean">Boolean</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="39981">loaded</a> = <a href="#6840" title="(java.lang.String)java.lang.Class[_]" id="23286">findLoadedClass</a>(<a href="#39975" title="String">className</a>)
		<span class="keyword">val</span> <a title="java.lang.Class[_ &gt;: _$3 with ?0]" id="39982">found</a> =
			<span title="java.lang.Class[_41]" class="keyword">if</span>(<a href="#39981" title="java.lang.Class[_]">loaded</a> <span title="(AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>)
				<a href="#39946" title="(String)Class[_]">doLoadClass</a>(<a href="#39975" title="String">className</a>)
			<span class="keyword">else</span>
				<a href="#39981" title="java.lang.Class[_]">loaded</a>
			
		<span title="Unit" class="keyword">if</span>(<a href="#39976" title="Boolean">resolve</a>)
			<a href="#6840" title="(java.lang.Class[_])Unit">resolveClass</a>(<a href="#39982" title="java.lang.Class[_ &gt;: _$3 with ?0]">found</a>)
		<a href="#39982" title="java.lang.Class[_ &gt;: _$3 with ?0]">found</a>
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(String)Class[_]" id="39946">doLoadClass</a>(<a title="String" id="39986">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_]
	<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String)Class[_]" id="39947">selfLoadClass</a>(<a title="String" id="40025">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_] = <span class="keyword">super</span>.<span title="(java.lang.String,Boolean)java.lang.Class[_]">loadClass</span>(<a href="#40025" title="String">className</a>, <span title="Boolean(false)" class="keyword">false</span>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class IntermediateLoader extends sbt.LoaderBase with NotNull with ScalaObject" id="8613">IntermediateLoader</a>(<a title="Array[java.net.URL]" id="40049">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40050">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>) <span class="keyword">extends</span> <a href="#6840" title="sbt.LoaderBase">LoaderBase</a>(<a href="#40049" title="Array[java.net.URL]">urls</a>, <a href="#40050" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(String)Class[_]" id="40045">doLoadClass</a>(<a title="String" id="40051">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span class="comment">// if this loader is asked to load an sbt class, it must be because the project we are building is sbt itself,</span>
		 <span class="comment">// so we want to load the version of classes on the project classpath, not the parent</span>
		<span title="java.lang.Class[_42]" class="keyword">if</span>(<a href="#40051" title="String">className</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<a href="#7384" title="object sbt.Loaders">Loaders</a>.<a href="#40058" title="=&gt; java.lang.String">SbtPackage</a>))
			<a href="#8613" title="(java.lang.String)java.lang.Class[_]">findClass</a>(<a href="#40051" title="String">className</a>)
		<span class="keyword">else</span>
			<a href="#39947" title="(String)Class[_]">selfLoadClass</a>(<a href="#40051" title="String">className</a>)
	}
}
<span class="comment">/** Delegates class loading to `parent` for all classes included by `filter`.  An attempt to load classes excluded by `filter`
* results in a `ClassNotFoundException`.*/</span>
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class FilteredLoader extends java.lang.ClassLoader with NotNull with ScalaObject" id="11520">FilteredLoader</a>(<a title="java.lang.ClassLoader" id="33287">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="sbt.ClassFilter" id="33288">filter</a>: <a href="#2110" title="sbt.ClassFilter">ClassFilter</a>) <span class="keyword">extends</span> <span title="java.lang.ClassLoader">ClassLoader</span>(<a href="#33287" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span title="(Boolean)Unit">require</span>(<a href="#33287" title="java.lang.ClassLoader">parent</a> <span title="(AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	<span class="keyword">def</span> <a title="(java.lang.ClassLoader,Iterable[String])sbt.FilteredLoader" id="33282" class="keyword">this</a>(<a title="java.lang.ClassLoader" id="33285">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="Iterable[String]" id="33286">excludePackages</a>: <span title="Iterable[String]">Iterable</span>[String]) = <a href="#11520" title="FilteredLoader.this.type" class="keyword">this</a>(<a href="#33285" title="java.lang.ClassLoader">parent</a>, <span title="sbt.ExcludePackagesFilter" class="keyword">new</span> <a href="#10050" title="sbt.ExcludePackagesFilter">ExcludePackagesFilter</a>(<a href="#33286" title="Iterable[String]">excludePackages</a>))
	
	@<span title="throws">throws</span>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="33283">loadClass</a>(<a title="String" id="40105">className</a>: <span title="String">String</span>, <a title="Boolean" id="40106">resolve</a>: <span title="Boolean">Boolean</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span title="java.lang.Class[?0]" class="keyword">if</span>(<a href="#33288" title="sbt.ClassFilter">filter</a>.<a href="#33289" title="(String)Boolean">include</a>(<a href="#40105" title="String">className</a>))
			<span class="keyword">super</span>.<span title="(java.lang.String,Boolean)java.lang.Class[_]">loadClass</span>(<a href="#40105" title="String">className</a>, <a href="#40106" title="Boolean">resolve</a>)
		<span class="keyword">else</span>
			<span title="Nothing" class="keyword">throw</span> <a title="(java.lang.String)java.lang.ClassNotFoundException" id="32510" class="keyword">new</a> <a title="java.lang.ClassNotFoundException" id="1674">ClassNotFoundException</a>(<a href="#40105" title="String">className</a>)
	}
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class SelectiveLoader extends java.net.URLClassLoader with NotNull with ScalaObject" id="10170">SelectiveLoader</a>(<a title="Array[java.net.URL]" id="40136">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40137">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="sbt.ClassFilter" id="40138">filter</a>: <a href="#2110" title="sbt.ClassFilter">ClassFilter</a>) <span class="keyword">extends</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#40136" title="Array[java.net.URL]">urls</a>, <a href="#40137" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span title="(Boolean)Unit">require</span>(<a href="#40137" title="java.lang.ClassLoader">parent</a> <span title="(AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	<span class="keyword">def</span> <a title="(Array[java.net.URL],java.lang.ClassLoader,Iterable[String])sbt.SelectiveLoader" id="40130" class="keyword">this</a>(<a title="Array[java.net.URL]" id="40159">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40160">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="Iterable[String]" id="40161">includePackages</a>: <span title="Iterable[String]">Iterable</span>[String]) = <a href="#10170" title="SelectiveLoader.this.type" class="keyword">this</a>(<a href="#40159" title="Array[java.net.URL]">urls</a>, <a href="#40160" title="java.lang.ClassLoader">parent</a>, <span title="sbt.IncludePackagesFilter" class="keyword">new</span> <a href="#7353" title="sbt.IncludePackagesFilter">IncludePackagesFilter</a>(<a href="#40161" title="Iterable[String]">includePackages</a>))
	
	@<span title="throws">throws</span>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="40131">loadClass</a>(<a title="String" id="40170">className</a>: <span title="String">String</span>, <a title="Boolean" id="40171">resolve</a>: <span title="Boolean">Boolean</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span title="java.lang.Class[_43]" class="keyword">if</span>(<a href="#40138" title="sbt.ClassFilter">filter</a>.<a href="#33289" title="(String)Boolean">include</a>(<a href="#40170" title="String">className</a>))
			<span class="keyword">super</span>.<span title="(java.lang.String,Boolean)java.lang.Class[_]">loadClass</span>(<a href="#40170" title="String">className</a>, <a href="#40171" title="Boolean">resolve</a>)
		<span class="keyword">else</span>
		{
			<span class="keyword">val</span> <a title="java.lang.Class[_]" id="40186">loaded</a> = <a href="#40137" title="java.lang.ClassLoader">parent</a>.<span title="(java.lang.String)java.lang.Class[_]">loadClass</span>(<a href="#40170" title="String">className</a>)
			<span title="Unit" class="keyword">if</span>(<a href="#40171" title="Boolean">resolve</a>)
				<a href="#10170" title="(java.lang.Class[_])Unit">resolveClass</a>(<a href="#40186" title="java.lang.Class[_]">loaded</a>)
			<a href="#40186" title="java.lang.Class[_]">loaded</a>
		}
	}
}
<span class="keyword">private</span> <span class="keyword">trait</span> <a title="trait ClassFilter extends java.lang.Object" id="2110">ClassFilter</a>
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="33289">include</a>(<a title="String" id="40111">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span>
}
<span class="keyword">private</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class PackageFilter extends java.lang.Object with sbt.ClassFilter with ScalaObject" id="8289">PackageFilter</a>(<a title="Iterable[String]" id="40215">packages</a>: <span title="Iterable[String]">Iterable</span>[String]) <span class="keyword">extends</span> <a href="#2110" title="sbt.ClassFilter">ClassFilter</a>
{
	<span title="(Boolean)Unit">require</span>(<a href="#40215" title="Iterable[String]">packages</a>.<a title="((String) =&gt; Boolean)Boolean" id="16071">forall</a>(<a href="#40218" title="String">_</a>.<span title="(java.lang.String)Boolean">endsWith</span>(<span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span>)))
	<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String)Boolean" id="40098">matches</a>(<a title="String" id="40219">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#40215" title="Iterable[String]">packages</a>.<a title="((String) =&gt; Boolean)Boolean" id="16072">exists</a>(<a href="#40219" title="String">className</a>.<a href="#40222" title="(java.lang.String)Boolean">startsWith</a>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class ExcludePackagesFilter extends sbt.PackageFilter with ScalaObject" id="10050">ExcludePackagesFilter</a>(<a title="Iterable[String]" id="40103">exclude</a>: <span title="Iterable[String]">Iterable</span>[String]) <span class="keyword">extends</span> <a href="#8289" title="sbt.PackageFilter">PackageFilter</a>(<a href="#40103" title="Iterable[String]">exclude</a>)
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="40102">include</a>(<a title="String" id="40226">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <span title="=&gt; Boolean">!</span><a href="#40098" title="(String)Boolean">matches</a>(<a href="#40226" title="String">className</a>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class IncludePackagesFilter extends sbt.PackageFilter with ScalaObject" id="7353">IncludePackagesFilter</a>(<a title="Iterable[String]" id="40168">include</a>: <span title="Iterable[String]">Iterable</span>[String]) <span class="keyword">extends</span> <a href="#8289" title="sbt.PackageFilter">PackageFilter</a>(<a href="#40168" title="Iterable[String]">include</a>)
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="40167">include</a>(<a title="String" id="40229">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#40098" title="(String)Boolean">matches</a>(<a href="#40229" title="String">className</a>)
}

<span class="keyword">private</span> <span class="keyword">class</span> <a title="class LazyFrameworkLoader extends sbt.LoaderBase with NotNull with ScalaObject" id="10497">LazyFrameworkLoader</a>(<a title="String" id="40245">runnerClassName</a>: <span title="String">String</span>, <a title="Array[java.net.URL]" id="40246">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40247">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="java.lang.ClassLoader" id="40248">grandparent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>)
	<span class="keyword">extends</span> <a href="#6840" title="sbt.LoaderBase">LoaderBase</a>(<a href="#40246" title="Array[java.net.URL]">urls</a>, <a href="#40247" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(String)Class[_]" id="40239">doLoadClass</a>(<a title="String" id="40249">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span title="java.lang.Class[_45]" class="keyword">if</span>(<a href="#7384" title="object sbt.Loaders">Loaders</a>.<a href="#40060" title="(String,String)Boolean">isNestedOrSelf</a>(<a href="#40249" title="String">className</a>, <a href="#40245" title="String">runnerClassName</a>))
			<a href="#10497" title="(java.lang.String)java.lang.Class[_]">findClass</a>(<a href="#40249" title="String">className</a>)
		<span class="keyword">else</span> <span title="java.lang.Class[_44]" class="keyword">if</span>(<a href="#7384" title="object sbt.Loaders">Loaders</a>.<a href="#40061" title="(String)Boolean">isSbtClass</a>(<a href="#40249" title="String">className</a>)) <span class="comment">// we circumvent the parent loader because we know that we want the</span>
			<a href="#40248" title="java.lang.ClassLoader">grandparent</a>.<span title="(java.lang.String)java.lang.Class[_]">loadClass</span>(<a href="#40249" title="String">className</a>)              <span class="comment">// version of sbt that is currently the builder (not the project being built)</span>
		<span class="keyword">else</span>
			<a href="#40247" title="java.lang.ClassLoader">parent</a>.<span title="(java.lang.String)java.lang.Class[_]">loadClass</span>(<a href="#40249" title="String">className</a>)
	}
}
<span class="keyword">private</span> <span class="keyword">object</span> <a title="object sbt.Loaders" id="7384">Loaders</a>
{
	<span class="keyword">val</span> <a title="java.lang.String" id="40058">SbtPackage</a> = <span title="java.lang.String(&quot;sbt.&quot;)" class="string">&quot;sbt.&quot;</span>
	<span class="keyword">def</span> <a title="(String,String)Boolean" id="40060">isNestedOrSelf</a>(<a title="String" id="40254">className</a>: <span title="String">String</span>, <a title="String" id="40255">checkAgainst</a>: <span title="String">String</span>) =
		<a href="#40254" title="String">className</a> <span title="(AnyRef)Boolean">==</span> <a href="#40255" title="String">checkAgainst</a> <span title="(Boolean)Boolean">||</span> <a href="#40254" title="String">className</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<a href="#40255" title="String">checkAgainst</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span>)
	<span class="keyword">def</span> <a title="(String)Boolean" id="40061">isSbtClass</a>(<a title="String" id="40260">className</a>: <span title="String">String</span>) = <a href="#40260" title="String">className</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<a href="#7384" title="object sbt.Loaders">Loaders</a>.<a href="#40058" title="=&gt; java.lang.String">SbtPackage</a>)
}
        </pre>
    </body>
</html>