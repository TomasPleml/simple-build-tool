<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/impl/MapUtilities.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>

<span class="keyword">package</span> sbt.impl
<span class="keyword">import</span> sbt._

<span class="keyword">import</span> java.util.Properties
<span class="keyword">import</span> java.io.{File, FileInputStream, FileOutputStream, InputStream, OutputStream}
<span class="keyword">import</span> scala.collection.mutable.{HashMap, HashSet, ListBuffer, Map, Set}

<span class="keyword">private</span>[sbt] <span class="keyword">object</span> <a title="object sbt.impl.PropertiesUtilities" id="14504">PropertiesUtilities</a>
{
	<span class="keyword">def</span> <a title="(java.util.Properties,String,sbt.Path,sbt.Logger)Option[String]" id="63191">write</a>(<a title="java.util.Properties" id="63194">properties</a>: <span title="java.util.Properties">Properties</span>, <a title="String" id="63195">label</a>: <span title="String">String</span>, <a title="sbt.Path" id="63196">to</a>: <a href="../Path.scala.html#11861" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="63197">log</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>) =
		<a href="../FileUtilities.scala.html#10716" title="object sbt.FileUtilities">FileUtilities</a>.<a href="../FileUtilities.scala.html#52242" title="(java.io.File,sbt.Logger)((java.io.OutputStream) =&gt; Option[String])Option[String]">writeStream</a>(<a href="#63196" title="sbt.Path">to</a>.<a href="../Path.scala.html#52349" title="=&gt; java.io.File">asFile</a>, <a href="#63197" title="sbt.Logger">log</a>)(<a title="java.io.OutputStream" id="63204">output</a> =&gt; { <a href="#63194" title="java.util.Properties">properties</a>.<a title="(java.io.OutputStream,java.lang.String)Unit" id="40383">store</a>(<a href="#63204" title="java.io.OutputStream">output</a>, <a href="#63195" title="String">label</a>); <span title="object None">None</span> })
	<span class="keyword">def</span> <a title="(java.util.Properties,sbt.Path,sbt.Logger)Option[String]" id="63192">load</a>(<a title="java.util.Properties" id="86061">properties</a>: <span title="java.util.Properties">Properties</span>, <a title="sbt.Path" id="86062">from</a>: <a href="../Path.scala.html#11861" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="86063">log</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>): <span title="Option[String]">Option</span>[String] =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="86064">file</a> = <a href="#86062" title="sbt.Path">from</a>.<a href="../Path.scala.html#52349" title="=&gt; java.io.File">asFile</a>
		<span title="Option[String]" class="keyword">if</span>(<a href="#86064" title="java.io.File">file</a>.<a title="()Boolean" id="16968">exists</a>)
			<a href="../FileUtilities.scala.html#10716" title="object sbt.FileUtilities">FileUtilities</a>.<a href="../FileUtilities.scala.html#52244" title="(java.io.File,sbt.Logger)((java.io.InputStream) =&gt; Option[String])Option[String]">readStream</a>(<a href="#86064" title="java.io.File">file</a>, <a href="#86063" title="sbt.Logger">log</a>)( <a title="java.io.InputStream" id="86067">input</a> =&gt; { <a href="#86061" title="java.util.Properties">properties</a>.<a title="(java.io.InputStream)Unit" id="40380">load</a>(<a href="#86067" title="java.io.InputStream">input</a>); <span title="object None">None</span> })
		<span class="keyword">else</span>
			<span title="object None">None</span>
	}
	<span class="keyword">def</span> <a title="(java.util.Properties)Iterable[String]" id="63193">propertyNames</a>(<a title="java.util.Properties" id="86069">properties</a>: <span title="java.util.Properties">Properties</span>): <span title="Iterable[String]">Iterable</span>[String] =
		wrap.<a href="../wrap/Wrappers.scala.html#15035" title="object sbt.wrap.Wrappers">Wrappers</a>.<a href="../wrap/Wrappers.scala.html#52464" title="(java.util.Enumeration[?0])List[?0]">toList</a>(<a href="#86069" title="java.util.Properties">properties</a>.<a title="()java.util.Enumeration[_]" id="40390">propertyNames</a>).<span title="((?0) =&gt; java.lang.String)List[java.lang.String]">map</span>(<a href="#86086" title="?0">_</a>.<a title="()java.lang.String" id="3439">toString</a>)
}

<span class="keyword">private</span>[sbt] <span class="keyword">object</span> <a title="object sbt.impl.MapUtilities" id="14696">MapUtilities</a>
{
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,Value],String,sbt.Path,sbt.Logger)(implicit sbt.Format[Key],sbt.Format[Value])Option[String]" id="52030">write</a>[<a title="&gt;: Nothing &lt;: Any" id="52033">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="52034">Value</a>](<a title="scala.collection.mutable.Map[Key,Value]" id="53209">map</a>: <span title="scala.collection.mutable.Map[Key,Value]">Map</span>[Key, Value], <a title="String" id="53210">label</a>: <span title="String">String</span>, <a title="sbt.Path" id="53211">to</a>: <a href="../Path.scala.html#11861" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="53212">log</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>)(<span class="keyword">implicit</span> <a title="sbt.Format[Key]" id="53213">keyFormat</a>: <a href="../Format.scala.html#11438" title="sbt.Format[Key]">Format</a>[Key], <a title="sbt.Format[Value]" id="53214">valueFormat</a>: <a href="../Format.scala.html#11438" title="sbt.Format[Value]">Format</a>[Value]): <span title="Option[String]">Option</span>[String] =
	{
		<span class="keyword">val</span> <a title="java.util.Properties" id="86088">properties</a> = <span title="java.util.Properties" class="keyword">new</span> <span title="java.util.Properties">Properties</span>
		<a href="#53209" title="scala.collection.mutable.Map[Key,Value]">map</a> <span title="(((Key, Value)) =&gt; Unit)Unit">foreach</span> { <a title="(Key, Value)" id="86096">pair</a> =&gt; <a href="#86088" title="java.util.Properties">properties</a>.<a title="(java.lang.String,java.lang.String)java.lang.Object" id="40378">setProperty</a>(<a href="#53213" title="sbt.Format[Key]">keyFormat</a>.<a href="../Format.scala.html#52138" title="(Key)String">toString</a>(<a href="#86096" title="(Key, Value)">pair</a>.<a title="=&gt; Key" id="17992">_1</a>), <a href="#53214" title="sbt.Format[Value]">valueFormat</a>.<a href="../Format.scala.html#52138" title="(Value)String">toString</a>(<a href="#86096" title="(Key, Value)">pair</a>.<a title="=&gt; Value" id="17994">_2</a>)) }
		<a href="#14504" title="object sbt.impl.PropertiesUtilities">PropertiesUtilities</a>.<a href="#63191" title="(java.util.Properties,String,sbt.Path,sbt.Logger)Option[String]">write</a>(<a href="#86088" title="java.util.Properties">properties</a>, <a href="#53210" title="String">label</a>, <a href="#53211" title="sbt.Path">to</a>, <a href="#53212" title="sbt.Logger">log</a>)
	}
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,Value],sbt.Path,sbt.Logger)(implicit sbt.Format[Key],sbt.Format[Value])Option[String]" id="52035">read</a>[<a title="&gt;: Nothing &lt;: Any" id="52038">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="52039">Value</a>](<a title="scala.collection.mutable.Map[Key,Value]" id="53198">map</a>: <span title="scala.collection.mutable.Map[Key,Value]">Map</span>[Key, Value], <a title="sbt.Path" id="53199">from</a>: <a href="../Path.scala.html#11861" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="53200">log</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>)(<span class="keyword">implicit</span> <a title="sbt.Format[Key]" id="53201">keyFormat</a>: <a href="../Format.scala.html#11438" title="sbt.Format[Key]">Format</a>[Key], <a title="sbt.Format[Value]" id="53202">valueFormat</a>: <a href="../Format.scala.html#11438" title="sbt.Format[Value]">Format</a>[Value]): <span title="Option[String]">Option</span>[String] =
	{
		<a href="#53198" title="scala.collection.mutable.Map[Key,Value]">map</a>.<a title="()Unit" id="38009">clear</a>
		<span class="keyword">val</span> <a title="java.util.Properties" id="86099">properties</a> = <span title="java.util.Properties" class="keyword">new</span> <span title="java.util.Properties">Properties</span>
		<a href="#14504" title="object sbt.impl.PropertiesUtilities">PropertiesUtilities</a>.<a href="#63192" title="(java.util.Properties,sbt.Path,sbt.Logger)Option[String]">load</a>(<a href="#86099" title="java.util.Properties">properties</a>, <a href="#53199" title="sbt.Path">from</a>, <a href="#53200" title="sbt.Logger">log</a>) <a title="(=&gt; Option[String])Option[String]" id="30539">orElse</a>
		{
			<span class="keyword">for</span>(<a title="((String) =&gt; Unit)Unit" id="86108">name</a> &lt;- <a href="#14504" title="object sbt.impl.PropertiesUtilities">PropertiesUtilities</a>.<a href="#63193" title="(java.util.Properties)Iterable[String]">propertyNames</a>(<a href="#86099" title="java.util.Properties">properties</a>))
				<a href="#53198" title="scala.collection.mutable.Map[Key,Value]">map</a>.<span title="(Key,Value)Option[Value]">put</span>( <a href="#53201" title="sbt.Format[Key]">keyFormat</a>.<a href="../Format.scala.html#52139" title="(String)Key">fromString</a>(<a href="#86108" title="String">name</a>), <a href="#53202" title="sbt.Format[Value]">valueFormat</a>.<a href="../Format.scala.html#52139" title="(String)Value">fromString</a>(<a href="#86099" title="java.util.Properties">properties</a>.<a title="(java.lang.String)java.lang.String" id="40387">getProperty</a>(<a href="#86108" title="String">name</a>)))
			<span title="object None">None</span>
		}
	}
	<span class="keyword">def</span> <a title="(String,sbt.Path,sbt.Logger)scala.collection.Map[String,String]" id="52040">readStrings</a>(<a title="String" id="63147">label</a>: <span title="String">String</span>, <a title="sbt.Path" id="63148">envBackingPath</a>: <a href="../Path.scala.html#11861" title="sbt.Path">Path</a>, <a title="sbt.Logger" id="63149">log</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>): scala.collection.<a title="scala.collection.Map[String,String]" id="16275">Map</a>[String, String] =
	{
		<span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[String,String]" id="86110">map</a> = <span title="scala.collection.mutable.HashMap[String,String]" class="keyword">new</span> <a title="scala.collection.mutable.HashMap[String,String]" id="20417">HashMap</a>[String, String]
		<span class="keyword">for</span>(<a title="((String) =&gt; Unit)Unit" id="86116">errorMsg</a> &lt;- <a href="#52035" title="(scala.collection.mutable.Map[String,String],sbt.Path,sbt.Logger)(implicit sbt.Format[String],sbt.Format[String])Option[String]">read</a>(<a href="#86110" title="scala.collection.mutable.HashMap[String,String]">map</a>, <a href="#63148" title="sbt.Path">envBackingPath</a>, <a href="#63149" title="sbt.Logger">log</a>))
			<a href="#63149" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#52377" title="(=&gt; String)Unit">error</a>(<span title="java.lang.String(&quot;Error loading properties from &quot;)" class="string">&quot;Error loading properties from &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#63147" title="String">label</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; : &quot;)" class="string">&quot; : &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#86116" title="String">errorMsg</a>)
		<a href="#86110" title="scala.collection.mutable.HashMap[String,String]">map</a>.<a title="=&gt; scala.collection.Map[String,String]" id="38015">readOnly</a>
	}
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Iterable[Value]" id="52041">all</a>[<a title="&gt;: Nothing &lt;: Any" id="52044">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="52045">Value</a>](<a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="53560">map</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]]): <span title="Iterable[Value]">Iterable</span>[Value] =
		<a href="#53560" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<a title="=&gt; Iterator[scala.collection.mutable.Set[Value]]" id="38046">values</a>.<span title="=&gt; List[scala.collection.mutable.Set[Value]]">toList</span>.<a title="((scala.collection.mutable.Set[Value]) =&gt; Iterable[Value])List[Value]" id="15748">flatMap</a>(<a title="scala.collection.mutable.Set[Value]" id="86121">set</a> =&gt; <a href="#86121" title="scala.collection.mutable.Set[Value]">set</a>.<a title="=&gt; List[Value]" id="16171">toList</a>)
	
	<span class="keyword">def</span> <a title="[Key, Value](scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Iterable[(Key, scala.collection.Set[Value])]" id="52046">readOnlyIterable</a>[<a title="&gt;: Nothing &lt;: Any" id="52049">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="52050">Value</a>](<a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="52580">i</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]]): <span title="Iterable[(Key, scala.collection.Set[Value])]">Iterable</span>[(Key, scala.collection.Set[Value])] =
		<span class="keyword">for</span>( <a href="#86124" title="(((Key, scala.collection.mutable.Set[Value])) =&gt; (Key, scala.collection.Set[Value]))List[(Key, scala.collection.Set[Value])]" id="15732">(</a><a title="Key" id="86131">key</a>, <a title="scala.collection.mutable.Set[Value]" id="86132">set</a>) &lt;- <a href="#52580" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">i</a>.<a title="=&gt; Iterator[(Key, scala.collection.mutable.Set[Value])]" id="16132">elements</a>.<span title="=&gt; List[(Key, scala.collection.mutable.Set[Value])]">toList</span>) <span class="keyword">yield</span> <a title="(Key,scala.collection.Set[Value])(Key, scala.collection.Set[Value])" id="1327">(</a><a href="#86131" title="Key">key</a>, wrap.<a href="../wrap/Wrappers.scala.html#15035" title="object sbt.wrap.Wrappers">Wrappers</a>.<a href="../wrap/Wrappers.scala.html#52472" title="(scala.collection.mutable.Set[Value])scala.collection.Set[Value]">readOnly</a>(<a href="#86132" title="scala.collection.mutable.Set[Value]">set</a>))<span class="comment">//.readOnly)</span>
		
	<span class="keyword">def</span> <a title="[Key, Value](Key,scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Unit" id="52051">mark</a>[<a title="&gt;: Nothing &lt;: Any" id="52054">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="52055">Value</a>](<a title="Key" id="52621">source</a>: <a href="#52054" title="Key">Key</a>, <a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="52622">map</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]])
	{
		<span title="Unit" class="keyword">if</span>(<a title="=&gt; Boolean" id="2686">!</a><a href="#52622" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<a title="(Key)Boolean" id="38042">contains</a>(<a href="#52621" title="Key">source</a>))
			<a href="#52622" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<span title="(Key,scala.collection.mutable.Set[Value])Option[scala.collection.mutable.Set[Value]]">put</span>(<a href="#52621" title="Key">source</a>, <span title="scala.collection.mutable.HashSet[Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashSet[Value]">HashSet</span>[Value])
	}
	<span class="keyword">def</span> <a title="[Key, Value](Key,Value,scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]])Unit" id="52056">add</a>[<a title="&gt;: Nothing &lt;: Any" id="52059">Key</a>, <a title="&gt;: Nothing &lt;: Any" id="52060">Value</a>](<a title="Key" id="52590">key</a>: <a href="#52059" title="Key">Key</a>, <a title="Value" id="52591">value</a>: <a href="#52060" title="Value">Value</a>, <a title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]" id="52592">map</a>: <span title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">Map</span>[Key, Set[Value]]): <a title="Unit" id="2105">Unit</a> =
		<a href="#52592" title="scala.collection.mutable.Map[Key,scala.collection.mutable.Set[Value]]">map</a>.<a title="(Key,=&gt; scala.collection.mutable.Set[Value])scala.collection.mutable.Set[Value]" id="38010">getOrElseUpdate</a>(<a href="#52590" title="Key">key</a>, <span title="scala.collection.mutable.HashSet[Value]" class="keyword">new</span> <span title="scala.collection.mutable.HashSet[Value]">HashSet</span>[Value]) <a title="(Value)scala.collection.mutable.Set[Value]" id="30898">+</a> <a href="#52591" title="Value">value</a>
}
        </pre>
    </body>
</html>