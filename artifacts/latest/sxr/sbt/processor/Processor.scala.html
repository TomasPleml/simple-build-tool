<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/processor/Processor.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt.processor

<span class="keyword">import</span> java.io.File

<span class="comment">/** An interface for code that operates on an sbt `Project`.*/</span>
<span class="keyword">trait</span> <a title="trait Processor extends java.lang.Object with NotNull" id="14674">Processor</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Apply this processor's action to the given `project`.
	* The arguments are passed unparsed as a single String `args`.
	* The return value optionally provides additional commands to run, such as 'reload'.
	* Note: `project` is not necessarily the root project.  To get the root project, use `project.rootProject`.
	* The `label` used to call the processor is provided to allow recursing.*/</span>
	<span class="keyword">def</span> <a title="(String,sbt.Project,Option[String],String)sbt.processor.ProcessorResult" id="66786">apply</a>(<a title="String" id="66787">label</a>: <span title="String">String</span>, <a title="sbt.Project" id="66788">project</a>: <a href="../Project.scala.html#9291" title="sbt.Project">Project</a>, <a title="Option[String]" id="66789">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String" id="66790">args</a>: <span title="String">String</span>): <a href="#14740" title="sbt.processor.ProcessorResult">ProcessorResult</a>
}
<span class="comment">/** An interface for code that operates on an sbt `Project` but doesn't need to modify command processing.*/</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class BasicProcessor extends java.lang.Object with sbt.processor.Processor with ScalaObject" id="14776">BasicProcessor</a> <span class="keyword">extends</span> <a href="#14674" title="sbt.processor.Processor">Processor</a>
{
	<span class="comment">/** Apply this processor's action to the given `project`.
	* The arguments are passed unparsed as a single String `args`.
	* Note: `project` is not necessarily the root project.  To get the root project, use `project.rootProject`.*/</span>
	<span class="keyword">def</span> <a title="(sbt.Project,String)Unit" id="85469">apply</a>(<a title="sbt.Project" id="85472">project</a>: <a href="../Project.scala.html#9291" title="sbt.Project">Project</a>, <a title="String" id="85473">args</a>: <span title="String">String</span>): <a title="Unit" id="2109">Unit</a>

	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,sbt.Project,Option[String],String)sbt.processor.ProcessorResult" id="85470">apply</a>(<a title="String" id="85474">label</a>: <span title="String">String</span>, <a title="sbt.Project" id="85475">project</a>: <a href="../Project.scala.html#9291" title="sbt.Project">Project</a>, <a title="Option[String]" id="85476">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String" id="85477">args</a>: <span title="String">String</span>): <a href="#14740" title="sbt.processor.ProcessorResult">ProcessorResult</a> =
	{
		<a href="#85469" title="(sbt.Project,String)Unit">apply</a>(<a href="#85475" title="sbt.Project">project</a>, <a href="#85477" title="String">args</a>)
		<span title="sbt.processor.Success" class="keyword">new</span> <a href="#14653" title="sbt.processor.Success">Success</a>(<a href="#85475" title="sbt.Project">project</a>, <a href="#85476" title="Option[String]">onFailure</a>)
	}
}

<span class="comment">/** The result of a Processor run.*/</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ProcessorResult extends java.lang.Object with NotNull" id="14740">ProcessorResult</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
<span class="comment">/* Processor success.
* `insertArgs` allows the Processor to insert additional commands to run.
* These commands are run before pending commands.
* 
* For example, consider a Processor bound to 'cleanCompile' that returns
*   `ProcessorResult(&quot;clean&quot;, &quot;compile&quot;)`
* 
* If a user runs:
*   `sbt a cleanCompile b `
* This runs `a`, `cleanCompile`, `clean`, `compile`, and finally `b`.
* Commands are processed as if they were entered at the prompt or from the command line.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Success extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="14653">Success</a>(<span class="keyword">val</span> <a title="sbt.Project" id="85479">project</a>: <a href="../Project.scala.html#9291" title="sbt.Project">Project</a>, <span class="keyword">val</span> <a title="Option[String]" id="85480">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String*" id="85481">insertArgs</a>: <span title="String*">String</span>*) <span class="keyword">extends</span> <a href="#14740" title="sbt.processor.ProcessorResult">ProcessorResult</a>
{
	<span class="keyword">val</span> <a title="List[String]" id="66801">insertArguments</a> = <a href="#85481" title="String*">insertArgs</a>.<span title="=&gt; List[String]">toList</span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Exit extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="14698">Exit</a>(<span class="keyword">val</span> <a title="Int" id="85489">code</a>: <a title="Int" id="2346">Int</a>) <span class="keyword">extends</span> <a href="#14740" title="sbt.processor.ProcessorResult">ProcessorResult</a>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Reload extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="14614">Reload</a>(<a title="String*" id="85492">insertArgs</a>: <span title="String*">String</span>*) <span class="keyword">extends</span> <a href="#14740" title="sbt.processor.ProcessorResult">ProcessorResult</a>
{
	<span class="keyword">val</span> <a title="List[String]" id="66815">insertArguments</a> = <a href="#85492" title="String*">insertArgs</a>.<span title="=&gt; List[String]">toList</span>
}

<span class="comment">/** Manages the processor and repository definitions.*/</span>
<span class="keyword">trait</span> <a title="trait Manager extends java.lang.Object with NotNull" id="14602">Manager</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(sbt.processor.ProcessorDefinition)Unit" id="66645">defineProcessor</a>(<a title="sbt.processor.ProcessorDefinition" id="84796">pdef</a>: <a href="#14605" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>)
	<span class="keyword">def</span> <a title="(String)sbt.processor.Definition" id="66646">removeDefinition</a>(<a title="String" id="84820">label</a>: <span title="String">String</span>): <a href="#14662" title="sbt.processor.Definition">Definition</a>
	<span class="keyword">def</span> <a title="(sbt.processor.RepositoryDefinition)Unit" id="66647">defineRepository</a>(<a title="sbt.processor.RepositoryDefinition" id="84780">repo</a>: <a href="#14620" title="sbt.processor.RepositoryDefinition">RepositoryDefinition</a>)
	<span class="keyword">def</span> <a title="(sbt.processor.ProcessorDefinition)Option[sbt.processor.Processor]" id="66648">processor</a>(<a title="sbt.processor.ProcessorDefinition" id="84857">pdef</a>: <a href="#14605" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>): <span title="Option[sbt.processor.Processor]">Option</span>[Processor]
	<span class="keyword">def</span> <a title="(String)Option[sbt.processor.ProcessorDefinition]" id="66649">processorDefinition</a>(<a title="String" id="84854">label</a>: <span title="String">String</span>): <span title="Option[sbt.processor.ProcessorDefinition]">Option</span>[ProcessorDefinition]
	
	<span class="keyword">def</span> <a title="=&gt; Map[String,sbt.processor.ProcessorDefinition]" id="66650">processors</a>: <span title="Map[String,sbt.processor.ProcessorDefinition]">Map</span>[String, ProcessorDefinition]
	<span class="keyword">def</span> <a title="=&gt; Map[String,sbt.processor.RepositoryDefinition]" id="66651">repositories</a>: <span title="Map[String,sbt.processor.RepositoryDefinition]">Map</span>[String, RepositoryDefinition]
}

<span class="comment">/** Executes a parsed command. */</span>
<span class="keyword">trait</span> <a title="trait Executing extends java.lang.Object with NotNull" id="14626">Executing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(sbt.processor.Command)Unit" id="84696">apply</a>(<a title="sbt.processor.Command" id="84706">command</a>: <a href="#14671" title="sbt.processor.Command">Command</a>)
}
<span class="comment">/** Prints information about processors. */</span>
<span class="keyword">trait</span> <a title="trait Info extends java.lang.Object with NotNull" id="14659">Info</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Prints available processors and defined repositories.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="84734">show</a>()
	<span class="comment">/** Prints usage of processor management commands.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="84735">help</a>()
}

<span class="comment">/** Parses a command String */</span>
<span class="keyword">trait</span> <a title="trait CommandParsing extends java.lang.Object with NotNull" id="14728">CommandParsing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Parses a command String that has been preprocessed.
	* It should have any prefix (like the * used by Main) removed
	* and whitespace trimmed
	*
	* If parsing is successful, a `Command` instance is returned wrapped in `Right`.
	*  Otherwise, an error message is returned wrapped in `Left`.*/</span>
	<span class="keyword">def</span> <a title="(String)Either[String,sbt.processor.Command]" id="84695">parseCommand</a>(<a title="String" id="84699">line</a>: <span title="String">String</span>): <a title="Either[String,sbt.processor.Command]" id="340">Either</a>[String, Command]
}
<span class="comment">/** Parses a definition `String`.*/</span>
<span class="keyword">trait</span> <a title="trait DefinitionParsing extends java.lang.Object with NotNull" id="14629">DefinitionParsing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Parses the given definition `String`.
	* The result is wrapped in `Some` if successful, or `None` if the string is not of the correct form. */</span>
	<span class="keyword">def</span> <a title="(String)Option[sbt.processor.Definition]" id="66758">parseDefinition</a>(<a title="String" id="85354">line</a>: <span title="String">String</span>): <span title="Option[sbt.processor.Definition]">Option</span>[Definition]
}
<span class="comment">/** Handles serializing `Definition`s.*/</span>
<span class="keyword">trait</span> <a title="trait Persisting extends java.lang.Object with NotNull" id="14611">Persisting</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(java.io.File)(Iterable[sbt.processor.Definition])Unit" id="66730">save</a>(<a title="java.io.File" id="85329">file</a>: <span title="java.io.File">File</span>)(<a title="Iterable[sbt.processor.Definition]" id="85330">definitions</a>: <a title="Iterable[sbt.processor.Definition]" id="376">Iterable</a>[Definition])
	<span class="keyword">def</span> <a title="(java.io.File)Seq[sbt.processor.Definition]" id="66731">load</a>(<a title="java.io.File" id="85335">file</a>: <span title="java.io.File">File</span>): <a title="Seq[sbt.processor.Definition]" id="733">Seq</a>[Definition]
}

<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Definition extends java.lang.Object with NotNull" id="14662">Definition</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="=&gt; String" id="84782">label</a>: <span title="String">String</span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ProcessorDefinition extends java.lang.Object with sbt.processor.Definition with ScalaObject" id="14605">ProcessorDefinition</a>(<span class="keyword">val</span> <a title="String" id="85417">label</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="85418">group</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="85419">module</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="85420">rev</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#14662" title="sbt.processor.Definition">Definition</a>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="84811">toString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#85417" title="=&gt; String">label</a>, <span title="java.lang.String(&quot;is&quot;)" class="string">&quot;is&quot;</span>, <a href="#85418" title="=&gt; String">group</a>, <a href="#85419" title="=&gt; String">module</a>, <a href="#85420" title="=&gt; String">rev</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
	<span class="keyword">def</span> <a title="=&gt; String" id="84812">idString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#85418" title="=&gt; String">group</a>, <a href="#85419" title="=&gt; String">module</a>, <a href="#85420" title="=&gt; String">rev</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
	<span class="keyword">def</span> <a title="(String)sbt.ModuleID" id="84813">toModuleID</a>(<a title="String" id="85288">scalaVersion</a>: <span title="String">String</span>) = <a href="../../IvyInterface.scala.html#39694" title="(String,String,String)sbt.ModuleID">ModuleID</a>(<a href="#85418" title="=&gt; String">group</a>, <a href="#85419" title="=&gt; String">module</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;_&quot;)" class="string">&quot;_&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#85288" title="String">scalaVersion</a>, <a href="#85420" title="=&gt; String">rev</a>)
}
<span class="comment">// maven-style repositories only right now</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RepositoryDefinition extends java.lang.Object with sbt.processor.Definition with ScalaObject" id="14620">RepositoryDefinition</a>(<span class="keyword">val</span> <a title="String" id="85425">label</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="85426">url</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#14662" title="sbt.processor.Definition">Definition</a>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="84790">toString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#85425" title="=&gt; String">label</a>, <span title="java.lang.String(&quot;at&quot;)" class="string">&quot;at&quot;</span>, <a href="#85426" title="=&gt; String">url</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
}

<span class="comment">/** Data type representing a runnable command related to processor management.*/</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Command extends java.lang.Object with NotNull" id="14671">Command</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
<span class="comment">/** A command to add the given processor definition. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class DefineProcessor extends java.lang.Object with sbt.processor.Command with ScalaObject" id="14692">DefineProcessor</a>(<span class="keyword">val</span> <a title="sbt.processor.ProcessorDefinition" id="85358">pdef</a>: <a href="#14605" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>) <span class="keyword">extends</span> <a href="#14671" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to remove the processor or repository definition currently associated with the given `label`.
* If the definition is associated with other labels, those are not affected.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RemoveDefinition extends java.lang.Object with sbt.processor.Command with ScalaObject" id="14710">RemoveDefinition</a>(<span class="keyword">val</span> <a title="String" id="85369">label</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#14671" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to register the given repository to be used for obtaining `Processor`s. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class DefineRepository extends java.lang.Object with sbt.processor.Command with ScalaObject" id="14656">DefineRepository</a>(<span class="keyword">val</span> <a title="sbt.processor.RepositoryDefinition" id="85362">repo</a>: <a href="#14620" title="sbt.processor.RepositoryDefinition">RepositoryDefinition</a>) <span class="keyword">extends</span> <a href="#14671" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to show help for processor management command usage. */</span>
<span class="keyword">object</span> <a title="object sbt.processor.Help" id="14600">Help</a> <span class="keyword">extends</span> <a href="#14671" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to show available processors and repositories.*/</span>
<span class="keyword">object</span> <a title="object sbt.processor.Show" id="14597">Show</a> <span class="keyword">extends</span> <a href="#14671" title="sbt.processor.Command">Command</a>

<span class="comment">/** An exception used when a `Processor` wants to terminate with an error message, but the stack trace is not important.
* If a `cause` is provided, its stack trace is assumed to be important.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ProcessorException extends java.lang.RuntimeException with ScalaObject" id="14689">ProcessorException</a>(<span class="keyword">val</span> <a title="String" id="84703">message</a>: <span title="String">String</span>, <a title="Throwable" id="84704">cause</a>: <span title="Throwable">Throwable</span>) <span class="keyword">extends</span> <a title="java.lang.RuntimeException" id="19529">RuntimeException</a>(<a href="#84703" title="String">message</a>, <a href="#84704" title="Throwable">cause</a>)
{
	<span class="keyword">def</span> <a title="(String)sbt.processor.ProcessorException" id="66086" class="keyword">this</a>(<a title="String" id="84702">message</a>: <span title="String">String</span>) = <a href="#14689" title="ProcessorException.this.type" class="keyword">this</a>(<a href="#84702" title="String">message</a>, <span title="Null(null)" class="keyword">null</span>)
}
<span class="keyword">object</span> <a title="object sbt.processor.ProcessorException" id="14690">ProcessorException</a>
{
	<span class="keyword">def</span> <a title="(String)Nothing" id="66693">error</a>(<a title="String" id="85241">msg</a>: <span title="String">String</span>): <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <a href="#66086" title="(String)sbt.processor.ProcessorException" class="keyword">new</a> <a href="#14689" title="sbt.processor.ProcessorException">ProcessorException</a>(<a href="#85241" title="String">msg</a>)
	<span class="keyword">def</span> <a title="(String,Throwable)Nothing" id="66694">error</a>(<a title="String" id="85239">msg</a>: <span title="String">String</span>, <a title="Throwable" id="85240">t</a>: <span title="Throwable">Throwable</span>): <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <span title="sbt.processor.ProcessorException" class="keyword">new</span> <a href="#14689" title="sbt.processor.ProcessorException">ProcessorException</a>(<a href="#85239" title="String">msg</a>, <a href="#85240" title="Throwable">t</a>)
}

        </pre>
    </body>
</html>