<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/processor/Processor.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt.processor

<span class="keyword">import</span> java.io.File

<span class="comment">/** An interface for code that operates on an sbt `Project`.*/</span>
<span class="keyword">trait</span> <a title="trait Processor extends java.lang.Object with NotNull" id="14870">Processor</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Apply this processor's action to the given `project`.
	* The arguments are passed unparsed as a single String `args`.
	* The return value optionally provides additional commands to run, such as 'reload'.
	* Note: `project` is not necessarily the root project.  To get the root project, use `project.rootProject`.
	* The `label` used to call the processor is provided to allow recursing.*/</span>
	<span class="keyword">def</span> <a title="(String,sbt.Project,Option[String],String)sbt.processor.ProcessorResult" id="69777">apply</a>(<a title="String" id="69778">label</a>: <span title="String">String</span>, <a title="sbt.Project" id="69779">project</a>: <a href="../Project.scala.html#9290" title="sbt.Project">Project</a>, <a title="Option[String]" id="69780">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String" id="69781">args</a>: <span title="String">String</span>): <a href="#14936" title="sbt.processor.ProcessorResult">ProcessorResult</a>
}
<span class="comment">/** An interface for code that operates on an sbt `Project` but doesn't need to modify command processing.*/</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class BasicProcessor extends java.lang.Object with sbt.processor.Processor with ScalaObject" id="14972">BasicProcessor</a> <span class="keyword">extends</span> <a href="#14870" title="sbt.processor.Processor">Processor</a>
{
	<span class="comment">/** Apply this processor's action to the given `project`.
	* The arguments are passed unparsed as a single String `args`.
	* Note: `project` is not necessarily the root project.  To get the root project, use `project.rootProject`.*/</span>
	<span class="keyword">def</span> <a title="(sbt.Project,String)Unit" id="91300">apply</a>(<a title="sbt.Project" id="91303">project</a>: <a href="../Project.scala.html#9290" title="sbt.Project">Project</a>, <a title="String" id="91304">args</a>: <span title="String">String</span>): <a title="Unit" id="2105">Unit</a>

	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,sbt.Project,Option[String],String)sbt.processor.ProcessorResult" id="91301">apply</a>(<a title="String" id="91305">label</a>: <span title="String">String</span>, <a title="sbt.Project" id="91306">project</a>: <a href="../Project.scala.html#9290" title="sbt.Project">Project</a>, <a title="Option[String]" id="91307">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String" id="91308">args</a>: <span title="String">String</span>): <a href="#14936" title="sbt.processor.ProcessorResult">ProcessorResult</a> =
	{
		<a href="#91300" title="(sbt.Project,String)Unit">apply</a>(<a href="#91306" title="sbt.Project">project</a>, <a href="#91308" title="String">args</a>)
		<span title="sbt.processor.Success" class="keyword">new</span> <a href="#14849" title="sbt.processor.Success">Success</a>(<a href="#91306" title="sbt.Project">project</a>, <a href="#91307" title="Option[String]">onFailure</a>)
	}
}

<span class="comment">/** The result of a Processor run.*/</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ProcessorResult extends java.lang.Object with NotNull" id="14936">ProcessorResult</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
<span class="comment">/* Processor success.
* `insertArgs` allows the Processor to insert additional commands to run.
* These commands are run before pending commands.
* 
* For example, consider a Processor bound to 'cleanCompile' that returns
*   `ProcessorResult(&quot;clean&quot;, &quot;compile&quot;)`
* 
* If a user runs:
*   `sbt a cleanCompile b `
* This runs `a`, `cleanCompile`, `clean`, `compile`, and finally `b`.
* Commands are processed as if they were entered at the prompt or from the command line.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Success extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="14849">Success</a>(<span class="keyword">val</span> <a title="sbt.Project" id="91310">project</a>: <a href="../Project.scala.html#9290" title="sbt.Project">Project</a>, <span class="keyword">val</span> <a title="Option[String]" id="91311">onFailure</a>: <span title="Option[String]">Option</span>[String], <a title="String*" id="91312">insertArgs</a>: <span title="String*">String</span>*) <span class="keyword">extends</span> <a href="#14936" title="sbt.processor.ProcessorResult">ProcessorResult</a>
{
	<span class="keyword">val</span> <a title="List[String]" id="69792">insertArguments</a> = <a href="#91312" title="String*">insertArgs</a>.<span title="=&gt; List[String]">toList</span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Exit extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="14894">Exit</a>(<span class="keyword">val</span> <a title="Int" id="91320">code</a>: <a title="Int" id="2342">Int</a>) <span class="keyword">extends</span> <a href="#14936" title="sbt.processor.ProcessorResult">ProcessorResult</a>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class Reload extends java.lang.Object with sbt.processor.ProcessorResult with ScalaObject" id="14810">Reload</a>(<a title="String*" id="91323">insertArgs</a>: <span title="String*">String</span>*) <span class="keyword">extends</span> <a href="#14936" title="sbt.processor.ProcessorResult">ProcessorResult</a>
{
	<span class="keyword">val</span> <a title="List[String]" id="69806">insertArguments</a> = <a href="#91323" title="String*">insertArgs</a>.<span title="=&gt; List[String]">toList</span>
}

<span class="comment">/** Manages the processor and repository definitions.*/</span>
<span class="keyword">trait</span> <a title="trait Manager extends java.lang.Object with NotNull" id="14798">Manager</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(sbt.processor.ProcessorDefinition)Unit" id="69636">defineProcessor</a>(<a title="sbt.processor.ProcessorDefinition" id="90627">pdef</a>: <a href="#14801" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>)
	<span class="keyword">def</span> <a title="(String)sbt.processor.Definition" id="69637">removeDefinition</a>(<a title="String" id="90651">label</a>: <span title="String">String</span>): <a href="#14858" title="sbt.processor.Definition">Definition</a>
	<span class="keyword">def</span> <a title="(sbt.processor.RepositoryDefinition)Unit" id="69638">defineRepository</a>(<a title="sbt.processor.RepositoryDefinition" id="90611">repo</a>: <a href="#14816" title="sbt.processor.RepositoryDefinition">RepositoryDefinition</a>)
	<span class="keyword">def</span> <a title="(sbt.processor.ProcessorDefinition)Option[sbt.processor.Processor]" id="69639">processor</a>(<a title="sbt.processor.ProcessorDefinition" id="90688">pdef</a>: <a href="#14801" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>): <span title="Option[sbt.processor.Processor]">Option</span>[Processor]
	<span class="keyword">def</span> <a title="(String)Option[sbt.processor.ProcessorDefinition]" id="69640">processorDefinition</a>(<a title="String" id="90685">label</a>: <span title="String">String</span>): <span title="Option[sbt.processor.ProcessorDefinition]">Option</span>[ProcessorDefinition]
	
	<span class="keyword">def</span> <a title="=&gt; Map[String,sbt.processor.ProcessorDefinition]" id="69641">processors</a>: <span title="Map[String,sbt.processor.ProcessorDefinition]">Map</span>[String, ProcessorDefinition]
	<span class="keyword">def</span> <a title="=&gt; Map[String,sbt.processor.RepositoryDefinition]" id="69642">repositories</a>: <span title="Map[String,sbt.processor.RepositoryDefinition]">Map</span>[String, RepositoryDefinition]
}

<span class="comment">/** Executes a parsed command. */</span>
<span class="keyword">trait</span> <a title="trait Executing extends java.lang.Object with NotNull" id="14822">Executing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(sbt.processor.Command)Unit" id="90527">apply</a>(<a title="sbt.processor.Command" id="90537">command</a>: <a href="#14867" title="sbt.processor.Command">Command</a>)
}
<span class="comment">/** Prints information about processors. */</span>
<span class="keyword">trait</span> <a title="trait Info extends java.lang.Object with NotNull" id="14855">Info</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Prints available processors and defined repositories.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="90565">show</a>()
	<span class="comment">/** Prints usage of processor management commands.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="90566">help</a>()
}

<span class="comment">/** Parses a command String */</span>
<span class="keyword">trait</span> <a title="trait CommandParsing extends java.lang.Object with NotNull" id="14924">CommandParsing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Parses a command String that has been preprocessed.
	* It should have any prefix (like the * used by Main) removed
	* and whitespace trimmed
	*
	* If parsing is successful, a `Command` instance is returned wrapped in `Right`.
	*  Otherwise, an error message is returned wrapped in `Left`.*/</span>
	<span class="keyword">def</span> <a title="(String)Either[String,sbt.processor.Command]" id="90526">parseCommand</a>(<a title="String" id="90530">line</a>: <span title="String">String</span>): <a title="Either[String,sbt.processor.Command]" id="336">Either</a>[String, Command]
}
<span class="comment">/** Parses a definition `String`.*/</span>
<span class="keyword">trait</span> <a title="trait DefinitionParsing extends java.lang.Object with NotNull" id="14825">DefinitionParsing</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="comment">/** Parses the given definition `String`.
	* The result is wrapped in `Some` if successful, or `None` if the string is not of the correct form. */</span>
	<span class="keyword">def</span> <a title="(String)Option[sbt.processor.Definition]" id="69749">parseDefinition</a>(<a title="String" id="91185">line</a>: <span title="String">String</span>): <span title="Option[sbt.processor.Definition]">Option</span>[Definition]
}
<span class="comment">/** Handles serializing `Definition`s.*/</span>
<span class="keyword">trait</span> <a title="trait Persisting extends java.lang.Object with NotNull" id="14807">Persisting</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(java.io.File)(Iterable[sbt.processor.Definition])Unit" id="69721">save</a>(<a title="java.io.File" id="91160">file</a>: <span title="java.io.File">File</span>)(<a title="Iterable[sbt.processor.Definition]" id="91161">definitions</a>: <a title="Iterable[sbt.processor.Definition]" id="372">Iterable</a>[Definition])
	<span class="keyword">def</span> <a title="(java.io.File)Seq[sbt.processor.Definition]" id="69722">load</a>(<a title="java.io.File" id="91166">file</a>: <span title="java.io.File">File</span>): <a title="Seq[sbt.processor.Definition]" id="729">Seq</a>[Definition]
}

<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Definition extends java.lang.Object with NotNull" id="14858">Definition</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="=&gt; String" id="90613">label</a>: <span title="String">String</span>
}
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ProcessorDefinition extends java.lang.Object with sbt.processor.Definition with ScalaObject" id="14801">ProcessorDefinition</a>(<span class="keyword">val</span> <a title="String" id="91248">label</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="91249">group</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="91250">module</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="91251">rev</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#14858" title="sbt.processor.Definition">Definition</a>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="90642">toString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#91248" title="=&gt; String">label</a>, <span title="java.lang.String(&quot;is&quot;)" class="string">&quot;is&quot;</span>, <a href="#91249" title="=&gt; String">group</a>, <a href="#91250" title="=&gt; String">module</a>, <a href="#91251" title="=&gt; String">rev</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
	<span class="keyword">def</span> <a title="=&gt; String" id="90643">idString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#91249" title="=&gt; String">group</a>, <a href="#91250" title="=&gt; String">module</a>, <a href="#91251" title="=&gt; String">rev</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
	<span class="keyword">def</span> <a title="(String)sbt.ModuleID" id="90644">toModuleID</a>(<a title="String" id="91119">scalaVersion</a>: <span title="String">String</span>) = <a href="../../IvyInterface.scala.html#39900" title="(String,String,String)sbt.ModuleID">ModuleID</a>(<a href="#91249" title="=&gt; String">group</a>, <a href="#91250" title="=&gt; String">module</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;_&quot;)" class="string">&quot;_&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#91119" title="String">scalaVersion</a>, <a href="#91251" title="=&gt; String">rev</a>)
}
<span class="comment">// maven-style repositories only right now</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RepositoryDefinition extends java.lang.Object with sbt.processor.Definition with ScalaObject" id="14816">RepositoryDefinition</a>(<span class="keyword">val</span> <a title="String" id="91256">label</a>: <span title="String">String</span>, <span class="keyword">val</span> <a title="String" id="91257">url</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#14858" title="sbt.processor.Definition">Definition</a>
{
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="90621">toString</a> = <span title="(String*)Seq[String]">Seq</span>(<a href="#91256" title="=&gt; String">label</a>, <span title="java.lang.String(&quot;at&quot;)" class="string">&quot;at&quot;</span>, <a href="#91257" title="=&gt; String">url</a>).<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>)
}

<span class="comment">/** Data type representing a runnable command related to processor management.*/</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait Command extends java.lang.Object with NotNull" id="14867">Command</a> <span class="keyword">extends</span> <span title="NotNull">NotNull</span>
<span class="comment">/** A command to add the given processor definition. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class DefineProcessor extends java.lang.Object with sbt.processor.Command with ScalaObject" id="14888">DefineProcessor</a>(<span class="keyword">val</span> <a title="sbt.processor.ProcessorDefinition" id="91189">pdef</a>: <a href="#14801" title="sbt.processor.ProcessorDefinition">ProcessorDefinition</a>) <span class="keyword">extends</span> <a href="#14867" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to remove the processor or repository definition currently associated with the given `label`.
* If the definition is associated with other labels, those are not affected.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class RemoveDefinition extends java.lang.Object with sbt.processor.Command with ScalaObject" id="14906">RemoveDefinition</a>(<span class="keyword">val</span> <a title="String" id="91200">label</a>: <span title="String">String</span>) <span class="keyword">extends</span> <a href="#14867" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to register the given repository to be used for obtaining `Processor`s. */</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class DefineRepository extends java.lang.Object with sbt.processor.Command with ScalaObject" id="14852">DefineRepository</a>(<span class="keyword">val</span> <a title="sbt.processor.RepositoryDefinition" id="91193">repo</a>: <a href="#14816" title="sbt.processor.RepositoryDefinition">RepositoryDefinition</a>) <span class="keyword">extends</span> <a href="#14867" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to show help for processor management command usage. */</span>
<span class="keyword">object</span> <a title="object sbt.processor.Help" id="14796">Help</a> <span class="keyword">extends</span> <a href="#14867" title="sbt.processor.Command">Command</a>
<span class="comment">/** A command to show available processors and repositories.*/</span>
<span class="keyword">object</span> <a title="object sbt.processor.Show" id="14793">Show</a> <span class="keyword">extends</span> <a href="#14867" title="sbt.processor.Command">Command</a>

<span class="comment">/** An exception used when a `Processor` wants to terminate with an error message, but the stack trace is not important.
* If a `cause` is provided, its stack trace is assumed to be important.*/</span>
<span class="keyword">final</span> <span class="keyword">class</span> <a title="class ProcessorException extends java.lang.RuntimeException with ScalaObject" id="14885">ProcessorException</a>(<span class="keyword">val</span> <a title="String" id="90534">message</a>: <span title="String">String</span>, <a title="Throwable" id="90535">cause</a>: <span title="Throwable">Throwable</span>) <span class="keyword">extends</span> <a title="java.lang.RuntimeException" id="19726">RuntimeException</a>(<a href="#90534" title="String">message</a>, <a href="#90535" title="Throwable">cause</a>)
{
	<span class="keyword">def</span> <a title="(String)sbt.processor.ProcessorException" id="69077" class="keyword">this</a>(<a title="String" id="90533">message</a>: <span title="String">String</span>) = <a href="#14885" title="ProcessorException.this.type" class="keyword">this</a>(<a href="#90533" title="String">message</a>, <span title="Null(null)" class="keyword">null</span>)
}
<span class="keyword">object</span> <a title="object sbt.processor.ProcessorException" id="14886">ProcessorException</a>
{
	<span class="keyword">def</span> <a title="(String)Nothing" id="69684">error</a>(<a title="String" id="91072">msg</a>: <span title="String">String</span>): <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <a href="#69077" title="(String)sbt.processor.ProcessorException" class="keyword">new</a> <a href="#14885" title="sbt.processor.ProcessorException">ProcessorException</a>(<a href="#91072" title="String">msg</a>)
	<span class="keyword">def</span> <a title="(String,Throwable)Nothing" id="69685">error</a>(<a title="String" id="91070">msg</a>: <span title="String">String</span>, <a title="Throwable" id="91071">t</a>: <span title="Throwable">Throwable</span>): <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <span title="sbt.processor.ProcessorException" class="keyword">new</span> <a href="#14885" title="sbt.processor.ProcessorException">ProcessorException</a>(<a href="#91070" title="String">msg</a>, <a href="#91071" title="Throwable">t</a>)
}

        </pre>
    </body>
</html>