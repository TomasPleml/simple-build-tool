<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/jetty/LazyJettyRun7.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>

<span class="keyword">package</span> sbt.jetty

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.URL

<span class="comment">/* This class starts Jetty.
* NOTE: DO NOT actively use this class.  You will see NoClassDefFoundErrors if you fail
*  to do so.  Only use its name in JettyRun for reflective loading.  This allows using
*  the Jetty libraries provided on the project classpath instead of requiring them to be
*  available on sbt's classpath at startup.
*/</span>
<span class="keyword">private</span> <span class="keyword">object</span> <a title="object sbt.jetty.LazyJettyRun7" id="13802">LazyJettyRun7</a> <span class="keyword">extends</span> <a href="../WebApp.scala.html#9836" title="sbt.JettyRun">JettyRun</a>
{
	
	<span class="keyword">import</span> org.eclipse.jetty.server.{Server, Handler}
	<span class="keyword">import</span> org.eclipse.jetty.server.nio.SelectChannelConnector
	<span class="keyword">import</span> org.eclipse.jetty.webapp.{WebAppClassLoader, WebAppContext, WebInfConfiguration, Configuration, FragmentConfiguration, JettyWebXmlConfiguration, TagLibConfiguration, WebXmlConfiguration}
	<span class="keyword">import</span> org.eclipse.jetty.util.log.{Log, Logger =&gt; JLogger}
	<span class="keyword">import</span> org.eclipse.jetty.util.Scanner
	<span class="keyword">import</span> org.eclipse.jetty.xml.XmlConfiguration
	<span class="keyword">import</span> org.eclipse.jetty.plus.webapp.{EnvConfiguration, Configuration=&gt;PlusConfiguration}



	<span class="keyword">import</span> java.lang.ref.{Reference, WeakReference}

	<span class="comment">// Jetty classes must be loaded on initialization in order for the version detection code in WebApp to work properly</span>
	<span class="comment">//   this forces them to be loaded- otherwise, it is possible they aren't loaded until 'apply' is called</span>
	<span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">val</span> <a title="java.lang.Class[org.eclipse.jetty.server.Server]" id="89300">forceJettyLoad</a> = <span title="java.lang.Class[org.eclipse.jetty.server.Server]">classOf</span>[Server]

	<span class="keyword">val</span> <a title="Int" id="89301">DefaultMaxIdleTime</a> = <span title="Int(30000)" class="int">30000</span>

	<span class="keyword">def</span> <a title="(sbt.JettyConfiguration,java.lang.ClassLoader)sbt.Stoppable" id="89303">apply</a>(<a title="sbt.JettyConfiguration" id="89315">configuration</a>: <a href="../WebApp.scala.html#12494" title="sbt.JettyConfiguration">JettyConfiguration</a>, <a title="java.lang.ClassLoader" id="89316">jettyLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <a href="../WebApp.scala.html#12575" title="sbt.Stoppable">Stoppable</a> =
	{
		<span class="keyword">val</span> <a title="org.eclipse.jetty.util.log.Logger" id="89317">oldLog</a> = <span title="object org.eclipse.jetty.util.log.Log">Log</span>.<a title="()org.eclipse.jetty.util.log.Logger" id="89332">getLog</a>
		<span title="object org.eclipse.jetty.util.log.Log">Log</span>.<span title="(org.eclipse.jetty.util.log.Logger)Unit">setLog</span>(<span title="sbt.jetty.LazyJettyRun7.JettyLogger" class="keyword">new</span> <a href="#89309" title="sbt.jetty.LazyJettyRun7.JettyLogger">JettyLogger</a>(<a href="#89315" title="sbt.JettyConfiguration">configuration</a>.<a href="../WebApp.scala.html#61908" title="=&gt; sbt.Logger">log</a>))
		<span class="keyword">val</span> <a title="org.eclipse.jetty.server.Server" id="89318">server</a> = <span title="org.eclipse.jetty.server.Server" class="keyword">new</span> <span title="org.eclipse.jetty.server.Server">Server</span>

		<span class="keyword">def</span> <a title="(org.eclipse.jetty.util.Scanner.BulkListener,Seq[java.io.File],Int)Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]]" id="89319">configureScanner</a>(<a title="org.eclipse.jetty.util.Scanner.BulkListener" id="89371">listener</a>: Scanner.<span title="org.eclipse.jetty.util.Scanner.BulkListener">BulkListener</span>, <a title="Seq[java.io.File]" id="89372">scanDirectories</a>: <span title="Seq[java.io.File]">Seq</span>[File], <a title="Int" id="89373">scanInterval</a>: <span title="Int">Int</span>) =
		{
			<span title="Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]]" class="keyword">if</span>(<a href="#89372" title="Seq[java.io.File]">scanDirectories</a>.<a title="=&gt; Boolean" id="16000">isEmpty</a>)
				<span title="object None">None</span>
			<span class="keyword">else</span>
			{
				<a href="#89315" title="sbt.JettyConfiguration">configuration</a>.<a href="../WebApp.scala.html#61908" title="=&gt; sbt.Logger">log</a>.<a href="../Logger.scala.html#52374" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Scanning for changes to: &quot;)" class="string">&quot;Scanning for changes to: &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#89372" title="Seq[java.io.File]">scanDirectories</a>.<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>))
				<span class="keyword">val</span> <a title="org.eclipse.jetty.util.Scanner" id="89374">scanner</a> = <span title="org.eclipse.jetty.util.Scanner" class="keyword">new</span> <a title="org.eclipse.jetty.util.Scanner" id="50868">Scanner</a>
				<span class="keyword">val</span> <a title="java.util.ArrayList[java.io.File]" id="89375">list</a> = <a title="()java.util.ArrayList[java.io.File]" id="41070" class="keyword">new</a> java.util.<a title="java.util.ArrayList[java.io.File]" id="5498">ArrayList</a>[File]
				<a href="#89372" title="Seq[java.io.File]">scanDirectories</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>(<a title="java.io.File" id="89422">x</a> =&gt; <a href="#89375" title="java.util.ArrayList[java.io.File]">list</a>.<a title="(java.io.File)Boolean" id="41088">add</a>(<a href="#89422" title="java.io.File">x</a>))
				<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>.<a title="(java.util.List[_])Unit" id="89394">setScanDirs</a>(<a href="#89375" title="java.util.ArrayList[java.io.File]">list</a>)
				<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>.<a title="(Boolean)Unit" id="89397">setRecursive</a>(<span title="Boolean(true)" class="keyword">true</span>)
				<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>.<a title="(Int)Unit" id="89390">setScanInterval</a>(<a href="#89373" title="Int">scanInterval</a>)
				<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>.<a title="(Boolean)Unit" id="89401">setReportExistingFilesOnStartup</a>(<span title="Boolean(false)" class="keyword">false</span>)
				<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>.<a title="(org.eclipse.jetty.util.Scanner.Listener)Unit" id="89402">addListener</a>(<a href="#89371" title="org.eclipse.jetty.util.Scanner.BulkListener">listener</a>)
				<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>.<a title="()Unit" id="89404">start</a>()
				<span title="(java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner])Some[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]]">Some</span>(<span title="java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]" class="keyword">new</span> <span title="java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]">WeakReference</span>(<a href="#89374" title="org.eclipse.jetty.util.Scanner">scanner</a>))
			}
		}

		<span class="keyword">val</span> <a href="#17992" title="(Option[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload], Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]])">(</a><a href="#89320" title="Option[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload]" id="17992">listener</a>, <a href="#89320" title="Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]]" id="17994">scanner</a>) =
			<a href="#89315" title="sbt.JettyConfiguration">configuration</a> <span title="(Option[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload], Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]])" class="keyword">match</span>
			{
				<span title="(Some[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload], Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]])" class="keyword">case</span> <a title="sbt.DefaultJettyConfiguration" id="89452">c</a>: <a href="../WebApp.scala.html#10376" title="sbt.DefaultJettyConfiguration">DefaultJettyConfiguration</a> =&gt;
					<span class="keyword">import</span> c._
					<a href="#89304" title="(org.eclipse.jetty.server.Server,Int)Unit">configureDefaultConnector</a>(<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>, <a href="../WebApp.scala.html#61914" title="=&gt; Int">port</a>)
					<span class="keyword">val</span> <a title="org.eclipse.jetty.webapp.WebAppContext" id="89454">webapp</a> = <a title="(java.lang.String,java.lang.String)org.eclipse.jetty.webapp.WebAppContext" id="51267" class="keyword">new</a> <span title="org.eclipse.jetty.webapp.WebAppContext">WebAppContext</span>(<a href="../WebApp.scala.html#61910" title="=&gt; sbt.Path">war</a>.<a href="../Path.scala.html#52356" title="=&gt; String">absolutePath</a>, <a href="../WebApp.scala.html#61913" title="=&gt; String">contextPath</a>)
					<a href="../WebApp.scala.html#61918" title="=&gt; Option[java.io.File]">webDefaultXml</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>{<a title="java.io.File" id="89665">webDefaultXml</a>:<span title="java.io.File">File</span> =&gt; <a href="#89454" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>.<a title="(java.lang.String)Unit" id="51471">setDefaultsDescriptor</a>(<a href="#89665" title="java.io.File">webDefaultXml</a>.<a title="()java.lang.String" id="17003">toString</a>)}
					
					<span class="keyword">def</span> <a title="()Unit" id="89455">setLoader</a>() = <a href="#89454" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>.<a title="(java.lang.ClassLoader)Unit" id="51442">setClassLoader</a>(<a href="#89312" title="(java.lang.ClassLoader,org.eclipse.jetty.webapp.WebAppContext,Seq[java.net.URL])java.lang.ClassLoader">webAppLoader</a>(<a href="#89316" title="java.lang.ClassLoader">jettyLoader</a>, <a href="#89454" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>, <a href="../WebApp.scala.html#61915" title="=&gt; sbt.PathFinder">classpath</a>.<a href="../Path.scala.html#52328" title="=&gt; Array[java.net.URL]">getURLs</a>))
					
					<span class="comment">// enable loading of custom jetty-env.xml file.</span>
					<a href="../WebApp.scala.html#61917" title="=&gt; Option[java.io.File]">jettyEnv</a>.<span title="((java.io.File) =&gt; Unit)Unit">foreach</span>{<a title="java.io.File" id="89670">jettyEnvFile</a>:<span title="java.io.File">File</span> =&gt; 
					<span class="keyword">val</span> <a title="org.eclipse.jetty.plus.webapp.EnvConfiguration" id="89671">envConfig</a> = <span title="org.eclipse.jetty.plus.webapp.EnvConfiguration" class="keyword">new</span> <a title="org.eclipse.jetty.plus.webapp.EnvConfiguration" id="51058">EnvConfiguration</a>
					<a href="#89671" title="org.eclipse.jetty.plus.webapp.EnvConfiguration">envConfig</a>.<a title="(java.net.URL)Unit" id="89674">setJettyEnvXml</a>(<a href="#89670" title="java.io.File">jettyEnvFile</a>.<a title="()java.net.URL" id="16964">toURL</a>)
					<span class="keyword">val</span> <a title="Array[org.eclipse.jetty.webapp.Configuration]" id="89672">confArray</a> : <span title="Array[org.eclipse.jetty.webapp.Configuration]">Array</span>[Configuration] = <a title="(org.eclipse.jetty.webapp.Configuration*)Array[org.eclipse.jetty.webapp.Configuration]" id="1033">Array</a>(
						<span title="org.eclipse.jetty.webapp.WebInfConfiguration" class="keyword">new</span> <a title="org.eclipse.jetty.webapp.WebInfConfiguration" id="50817">WebInfConfiguration</a>, 
						<span title="org.eclipse.jetty.webapp.WebXmlConfiguration" class="keyword">new</span> <a title="org.eclipse.jetty.webapp.WebXmlConfiguration" id="50859">WebXmlConfiguration</a>,  
						<a href="#89671" title="org.eclipse.jetty.plus.webapp.EnvConfiguration">envConfig</a>, 
						<span title="org.eclipse.jetty.plus.webapp.Configuration" class="keyword">new</span> <a title="org.eclipse.jetty.plus.webapp.Configuration" id="51064">PlusConfiguration</a>, 
						<span title="org.eclipse.jetty.webapp.JettyWebXmlConfiguration" class="keyword">new</span> <a title="org.eclipse.jetty.webapp.JettyWebXmlConfiguration" id="50838">JettyWebXmlConfiguration</a>, 
						<span title="org.eclipse.jetty.webapp.TagLibConfiguration" class="keyword">new</span> <a title="org.eclipse.jetty.webapp.TagLibConfiguration" id="50823">TagLibConfiguration</a>)
					<a href="#89454" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>.<a title="(Array[org.eclipse.jetty.webapp.Configuration])Unit" id="51470">setConfigurations</a>(<a href="#89672" title="Array[org.eclipse.jetty.webapp.Configuration]">confArray</a>)
					}
					
					<a href="#89455" title="()Unit">setLoader</a>()
					<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>.<a title="(org.eclipse.jetty.server.Handler)Unit" id="51664">setHandler</a>(<a href="#89454" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>)


					<span class="keyword">val</span> <a title="&lt;refinement&gt; extends java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload" id="89456">listener</a> = <a title="template $anon extends java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload" id="89925" class="keyword">new</a> Scanner.<span title="org.eclipse.jetty.util.Scanner.BulkListener">BulkListener</span> <span class="keyword">with</span> <a href="#2101" title="sbt.jetty.LazyJettyRun7.Reload">Reload</a> {
						<span class="keyword">def</span> <a title="()Unit" id="89927">reloadApp</a>() = <a href="#89307" title="(org.eclipse.jetty.server.Server,=&gt; Unit,sbt.Logger)Unit">reload</a>(<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>, <a href="#89455" title="()Unit">setLoader</a>(), <a href="../WebApp.scala.html#61908" title="=&gt; sbt.Logger">log</a>)
						<span class="keyword">def</span> <a title="(java.util.List[_])Unit" id="89928">filesChanged</a>(<a title="java.util.List[_]" id="89936">files</a>: <a title="java.util.List[_]" id="5588">java</a>.util.List[_]) { <a href="#89927" title="()Unit">reloadApp</a>() }
					}
					<span title="(Some[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload],Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]])(Some[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload], Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]])">(</span><span title="(java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload)Some[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload]">Some</span>(<a href="#89456" title="&lt;refinement&gt; extends java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload">listener</a>), <a href="#89319" title="(org.eclipse.jetty.util.Scanner.BulkListener,Seq[java.io.File],Int)Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]]">configureScanner</a>(<a href="#89456" title="&lt;refinement&gt; extends java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload">listener</a>, <a href="#89452" title="sbt.DefaultJettyConfiguration">c</a>.<a href="../WebApp.scala.html#61911" title="=&gt; Seq[java.io.File]">scanDirectories</a>, <a href="#89452" title="sbt.DefaultJettyConfiguration">c</a>.<a href="../WebApp.scala.html#61912" title="=&gt; Int">scanInterval</a>))
				<span title="(object None, object None)" class="keyword">case</span> <a title="sbt.CustomJettyConfiguration" id="89950">c</a>: <a href="../WebApp.scala.html#10313" title="sbt.CustomJettyConfiguration">CustomJettyConfiguration</a> =&gt;
					<span class="keyword">for</span>(<a title="((scala.xml.Node) =&gt; Unit)Unit" id="89952">x</a> &lt;- <a href="#89950" title="sbt.CustomJettyConfiguration">c</a>.<a href="../WebApp.scala.html#83679" title="=&gt; scala.xml.NodeSeq">jettyConfigurationXML</a>)
						(<a title="(java.lang.String)org.eclipse.jetty.xml.XmlConfiguration" id="89954" class="keyword">new</a> <span title="org.eclipse.jetty.xml.XmlConfiguration">XmlConfiguration</span>(<a href="#89952" title="scala.xml.Node">x</a>.<a title="()String" id="45145">toString</a>)).<span title="(Any)Unit">configure</span>(<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>)
					<span class="keyword">for</span>(<a title="((java.io.File) =&gt; Unit)Unit" id="89976">file</a> &lt;- <a href="#89950" title="sbt.CustomJettyConfiguration">c</a>.<a href="../WebApp.scala.html#83678" title="=&gt; Seq[java.io.File]">jettyConfigurationFiles</a>)
						(<span title="org.eclipse.jetty.xml.XmlConfiguration" class="keyword">new</span> <span title="org.eclipse.jetty.xml.XmlConfiguration">XmlConfiguration</span>(<a href="#89976" title="java.io.File">file</a>.<a title="()java.net.URI" id="16965">toURI</a>.<a title="()java.net.URL" id="19502">toURL</a>)).<span title="(Any)Unit">configure</span>(<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>)
					<span title="(object None,object None)(object None, object None)">(</span><span title="object None">None</span>, <span title="object None">None</span>)
			}

		<span class="keyword">try</span>
		{
			<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>.<a title="()Unit" id="51717">start</a>()
			<span title="sbt.jetty.LazyJettyRun7.StopServer" class="keyword">new</span> <a href="#89306" title="sbt.jetty.LazyJettyRun7.StopServer">StopServer</a>(<span title="java.lang.ref.WeakReference[org.eclipse.jetty.server.Server]" class="keyword">new</span> <span title="java.lang.ref.WeakReference[org.eclipse.jetty.server.Server]">WeakReference</span>(<a href="#89318" title="org.eclipse.jetty.server.Server">server</a>), <a href="#17992" title="Option[java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload]">listener</a>.<a title="((java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload) =&gt; java.lang.ref.WeakReference[sbt.jetty.LazyJettyRun7.Reload])Option[java.lang.ref.WeakReference[sbt.jetty.LazyJettyRun7.Reload]]" id="30533">map</a>(<span title="java.lang.ref.WeakReference[sbt.jetty.LazyJettyRun7.Reload]" class="keyword">new</span> <span title="java.lang.ref.WeakReference[sbt.jetty.LazyJettyRun7.Reload]">WeakReference</span>(<a href="#90059" title="&lt;refinement&gt; extends java.lang.Object with org.eclipse.jetty.util.Scanner.BulkListener with sbt.jetty.LazyJettyRun7.Reload">_</a>)), <a href="#17994" title="Option[java.lang.ref.WeakReference[org.eclipse.jetty.util.Scanner]]">scanner</a>, <a href="#89317" title="org.eclipse.jetty.util.log.Logger">oldLog</a>)
		}
		<span class="keyword">catch</span> { <span title="Nothing" class="keyword">case</span> <a title="java.lang.Throwable" id="90063">e</a> =&gt; <a href="#89318" title="org.eclipse.jetty.server.Server">server</a>.<span title="()Unit">stop</span>(); <span title="Nothing" class="keyword">throw</span> <a href="#90063" title="java.lang.Throwable">e</a> }
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(org.eclipse.jetty.server.Server,Int)Unit" id="89304">configureDefaultConnector</a>(<a title="org.eclipse.jetty.server.Server" id="89457">server</a>: <span title="org.eclipse.jetty.server.Server">Server</span>, <a title="Int" id="89458">port</a>: <span title="Int">Int</span>)
	{
		<span class="keyword">val</span> <a title="org.eclipse.jetty.server.nio.SelectChannelConnector" id="90064">defaultConnector</a> = <span title="org.eclipse.jetty.server.nio.SelectChannelConnector" class="keyword">new</span> <a title="org.eclipse.jetty.server.nio.SelectChannelConnector" id="50796">SelectChannelConnector</a>
		<a href="#90064" title="org.eclipse.jetty.server.nio.SelectChannelConnector">defaultConnector</a>.<a title="(Int)Unit" id="90292">setPort</a>(<a href="#89458" title="Int">port</a>)
		<a href="#90064" title="org.eclipse.jetty.server.nio.SelectChannelConnector">defaultConnector</a>.<a title="(Int)Unit" id="90156">setMaxIdleTime</a>(<a href="#89301" title="=&gt; Int">DefaultMaxIdleTime</a>)
		<a href="#89457" title="org.eclipse.jetty.server.Server">server</a>.<a title="(org.eclipse.jetty.server.Connector)Unit" id="51578">addConnector</a>(<a href="#90064" title="org.eclipse.jetty.server.nio.SelectChannelConnector">defaultConnector</a>)
	}
	<span class="keyword">trait</span> <a title="trait Reload extends java.lang.Object" id="2101">Reload</a> { <span class="keyword">def</span> <a title="()Unit" id="89931">reloadApp</a>(): <span title="Unit">Unit</span> }
	<span class="keyword">private</span> <span class="keyword">class</span> <a title="class StopServer extends java.lang.Object with sbt.Stoppable with ScalaObject" id="89306">StopServer</a>(<a title="java.lang.ref.Reference[org.eclipse.jetty.server.Server]" id="90050">serverReference</a>: <a title="java.lang.ref.Reference[org.eclipse.jetty.server.Server]" id="80483">Reference</a>[Server], <a title="Option[java.lang.ref.Reference[sbt.jetty.LazyJettyRun7.Reload]]" id="90051">reloadReference</a>: <span title="Option[java.lang.ref.Reference[sbt.jetty.LazyJettyRun7.Reload]]">Option</span>[Reference[Reload]], <a title="Option[java.lang.ref.Reference[org.eclipse.jetty.util.Scanner]]" id="90052">scannerReferenceOpt</a>: <span title="Option[java.lang.ref.Reference[org.eclipse.jetty.util.Scanner]]">Option</span>[Reference[Scanner]], <a title="org.eclipse.jetty.util.log.Logger" id="90053">oldLog</a>: <span title="org.eclipse.jetty.util.log.Logger">JLogger</span>) <span class="keyword">extends</span> <a href="../WebApp.scala.html#12575" title="sbt.Stoppable">Stoppable</a>
	{
		<span class="keyword">def</span> <a title="()Unit" id="90042">reload</a>(): <span title="Unit">Unit</span> = <a href="#90043" title="(Option[java.lang.ref.Reference[sbt.jetty.LazyJettyRun7.Reload]])((sbt.jetty.LazyJettyRun7.Reload) =&gt; Unit)Unit">on</a>(<a href="#90051" title="Option[java.lang.ref.Reference[sbt.jetty.LazyJettyRun7.Reload]]">reloadReference</a>)(<a href="#90449" title="sbt.jetty.LazyJettyRun7.Reload">_</a>.<a href="#89931" title="()Unit">reloadApp</a>())
		<span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](Option[java.lang.ref.Reference[T]])((T) =&gt; Unit)Unit" id="90043">on</a>[<a title="&gt;: Nothing &lt;: Any" id="90045">T</a>](<a title="Option[java.lang.ref.Reference[T]]" id="90445">refOpt</a>: <span title="Option[java.lang.ref.Reference[T]]">Option</span>[Reference[T]])(<a title="(T) =&gt; Unit" id="90446">f</a>: T =&gt; Unit): <span title="Unit">Unit</span> = <a href="#90445" title="Option[java.lang.ref.Reference[T]]">refOpt</a>.<span title="((java.lang.ref.Reference[T]) =&gt; Unit)Unit">foreach</span>(<a title="java.lang.ref.Reference[T]" id="90451">ref</a> =&gt; <a href="#90046" title="(T)((T) =&gt; Unit)Unit">onReferenced</a>(<a href="#90451" title="java.lang.ref.Reference[T]">ref</a>.<span title="()T">get</span>)(<a href="#90446" title="(T) =&gt; Unit">f</a>))
		<span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](T)((T) =&gt; Unit)Unit" id="90046">onReferenced</a>[<a title="&gt;: Nothing &lt;: Any" id="90048">T</a>](<a title="T" id="90452">t</a>: <a href="#90048" title="T">T</a>)(<a title="(T) =&gt; Unit" id="90453">f</a>: T =&gt; Unit): <span title="Unit">Unit</span> = <span title="Unit" class="keyword">if</span>(<a href="#90452" title="T">t</a> <a title="(Any)Boolean" id="3435">==</a> <span title="Null(null)" class="keyword">null</span>) <span title="Unit">(</span>) <span class="keyword">else</span> <a href="#90453" title="(T)Unit" id="16113">f</a>(<a href="#90452" title="T">t</a>)
		<span class="keyword">def</span> <a title="()Unit" id="90049">stop</a>()
		{
			<a href="#90046" title="(org.eclipse.jetty.server.Server)((org.eclipse.jetty.server.Server) =&gt; Unit)Unit">onReferenced</a>(<a href="#90050" title="java.lang.ref.Reference[org.eclipse.jetty.server.Server]">serverReference</a>.<span title="()org.eclipse.jetty.server.Server">get</span>)(<a href="#90457" title="org.eclipse.jetty.server.Server">_</a>.<span title="()Unit">stop</span>())
			<a href="#90043" title="(Option[java.lang.ref.Reference[org.eclipse.jetty.util.Scanner]])((org.eclipse.jetty.util.Scanner) =&gt; Unit)Unit">on</a>(<a href="#90052" title="Option[java.lang.ref.Reference[org.eclipse.jetty.util.Scanner]]">scannerReferenceOpt</a>)(<a href="#90460" title="org.eclipse.jetty.util.Scanner">_</a>.<a title="()Unit" id="89408">stop</a>())
			<span title="object org.eclipse.jetty.util.log.Log">Log</span>.<span title="(org.eclipse.jetty.util.log.Logger)Unit">setLog</span>(<a href="#90053" title="org.eclipse.jetty.util.log.Logger">oldLog</a>)
		}
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(org.eclipse.jetty.server.Server,=&gt; Unit,sbt.Logger)Unit" id="89307">reload</a>(<a title="org.eclipse.jetty.server.Server" id="89933">server</a>: <span title="org.eclipse.jetty.server.Server">Server</span>, <a title="=&gt; Unit" id="89934">reconfigure</a>: =&gt; Unit, <a title="sbt.Logger" id="89935">log</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>)
	{
		<a href="#89935" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#52375" title="(=&gt; String)Unit">info</a>(<span title="java.lang.String(&quot;Reloading web application...&quot;)" class="string">&quot;Reloading web application...&quot;</span>)
		<span class="keyword">val</span> <a title="List[org.eclipse.jetty.server.Handler]" id="90461">handlers</a> = <a href="#89308" title="(Array[org.eclipse.jetty.server.Handler],org.eclipse.jetty.server.Handler)List[org.eclipse.jetty.server.Handler]">wrapNull</a>(<a href="#89933" title="org.eclipse.jetty.server.Server">server</a>.<a title="()Array[org.eclipse.jetty.server.Handler]" id="51663">getHandlers</a>, <a href="#89933" title="org.eclipse.jetty.server.Server">server</a>.<a title="()org.eclipse.jetty.server.Handler" id="51662">getHandler</a>)
		<a href="#89935" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#52374" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Stopping handlers: &quot;)" class="string">&quot;Stopping handlers: &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#90461" title="List[org.eclipse.jetty.server.Handler]">handlers</a>.<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>))
		<a href="#90461" title="List[org.eclipse.jetty.server.Handler]">handlers</a>.<span title="((org.eclipse.jetty.server.Handler) =&gt; Unit)Unit">foreach</span>(<a href="#90481" title="org.eclipse.jetty.server.Handler">_</a>.<a title="()Unit" id="51704">stop</a>)
		<a href="#89935" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#52374" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Reconfiguring...&quot;)" class="string">&quot;Reconfiguring...&quot;</span>)
		<a href="#89934" title="=&gt; Unit">reconfigure</a>
		<a href="#89935" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#52374" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Restarting handlers: &quot;)" class="string">&quot;Restarting handlers: &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#90461" title="List[org.eclipse.jetty.server.Handler]">handlers</a>.<span title="(String)String">mkString</span>(<span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>))
		<a href="#90461" title="List[org.eclipse.jetty.server.Handler]">handlers</a>.<span title="((org.eclipse.jetty.server.Handler) =&gt; Unit)Unit">foreach</span>(<a href="#90486" title="org.eclipse.jetty.server.Handler">_</a>.<a title="()Unit" id="51703">start</a>)
		<a href="#89935" title="sbt.Logger">log</a>.<a href="../Logger.scala.html#52375" title="(=&gt; String)Unit">info</a>(<span title="java.lang.String(&quot;Reload complete.&quot;)" class="string">&quot;Reload complete.&quot;</span>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(Array[org.eclipse.jetty.server.Handler],org.eclipse.jetty.server.Handler)List[org.eclipse.jetty.server.Handler]" id="89308">wrapNull</a>(<a title="Array[org.eclipse.jetty.server.Handler]" id="90463">a</a>: <span title="Array[org.eclipse.jetty.server.Handler]">Array</span>[Handler], <a title="org.eclipse.jetty.server.Handler" id="90464">b</a>: <a title="org.eclipse.jetty.server.Handler" id="50729">Handler</a>) =
		<span title="(Array[org.eclipse.jetty.server.Handler],org.eclipse.jetty.server.Handler)(Array[org.eclipse.jetty.server.Handler], org.eclipse.jetty.server.Handler)">(</span><a href="#90463" title="Array[org.eclipse.jetty.server.Handler]">a</a>, <a href="#90464" title="org.eclipse.jetty.server.Handler">b</a>) <span title="List[org.eclipse.jetty.server.Handler]" class="keyword">match</span>
		{
			<span title="Nil.type" class="keyword">case</span> (<span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span>) =&gt; <span title="object Nil">Nil</span>
			<span title="List[org.eclipse.jetty.server.Handler]" class="keyword">case</span> (<span title="Null(null)" class="keyword">null</span>, <a title="org.eclipse.jetty.server.Handler" id="90468">notB</a>) =&gt; <a href="#90468" title="org.eclipse.jetty.server.Handler">notB</a> <a href="#90469" title="(org.eclipse.jetty.server.Handler)List[org.eclipse.jetty.server.Handler]">::</a> <span title="object Nil">Nil</span>
			<span title="List[org.eclipse.jetty.server.Handler]" class="keyword">case</span> (<a title="Array[org.eclipse.jetty.server.Handler]" id="90472">notA</a>, <span title="Null(null)" class="keyword">null</span>) =&gt; <a href="#90472" title="Array[org.eclipse.jetty.server.Handler]">notA</a>.<span title="=&gt; List[org.eclipse.jetty.server.Handler]">toList</span>
			<span title="List[org.eclipse.jetty.server.Handler]" class="keyword">case</span> (<a title="Array[org.eclipse.jetty.server.Handler]" id="90473">notA</a>, <a title="org.eclipse.jetty.server.Handler" id="90474">notB</a>) =&gt; <a href="#90474" title="org.eclipse.jetty.server.Handler">notB</a> <a href="#90475" title="(org.eclipse.jetty.server.Handler)List[org.eclipse.jetty.server.Handler]">::</a> <a href="#90473" title="Array[org.eclipse.jetty.server.Handler]">notA</a>.<span title="=&gt; List[org.eclipse.jetty.server.Handler]">toList</span>
		}
	<span class="keyword">private</span> <span class="keyword">class</span> <a title="class JettyLogger extends sbt.JettyLoggerBase with org.eclipse.jetty.util.log.Logger with ScalaObject" id="89309">JettyLogger</a>(<a title="sbt.Logger" id="89366">delegate</a>: <a href="../Logger.scala.html#13532" title="sbt.Logger">Logger</a>) <span class="keyword">extends</span> <a href="../WebApp.scala.html#13415" title="sbt.JettyLoggerBase">JettyLoggerBase</a>(<a href="#89366" title="sbt.Logger">delegate</a>) <span class="keyword">with</span> <span title="org.eclipse.jetty.util.log.Logger">JLogger</span>
	{
		<span class="keyword">def</span> <a title="(String)sbt.jetty.LazyJettyRun7.JettyLogger" id="89365">getLogger</a>(<a title="String" id="90490">name</a>: <span title="String">String</span>) = <a href="#89309" title="sbt.jetty.LazyJettyRun7.JettyLogger" class="keyword">this</a>
	}
	
	<span class="keyword">def</span> <a title="=&gt; List[java.lang.String]" id="89310">compatVersions</a> = <span title="java.lang.String(&quot;6&quot;)" class="string">&quot;6&quot;</span> <a href="#90494" title="(java.lang.String)List[java.lang.String]">::</a> <span title="java.lang.String(&quot;7&quot;)" class="string">&quot;7&quot;</span> <a href="#90495" title="(java.lang.String)List[java.lang.String]">::</a> <span title="java.lang.String(&quot;72&quot;)" class="string">&quot;72&quot;</span> <a href="#90496" title="(java.lang.String)List[java.lang.String]">::</a> <span title="object Nil">Nil</span>
	<span class="keyword">def</span> <a title="=&gt; java.lang.String" id="89311">loaderBaseName</a> = <span title="java.lang.String(&quot;sbt.jetty.SbtWebAppLoader&quot;)" class="string">&quot;sbt.jetty.SbtWebAppLoader&quot;</span>

	<span class="keyword">def</span> <a title="(java.lang.ClassLoader,org.eclipse.jetty.webapp.WebAppContext,Seq[java.net.URL])java.lang.ClassLoader" id="89312">webAppLoader</a>(<a title="java.lang.ClassLoader" id="89666">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="org.eclipse.jetty.webapp.WebAppContext" id="89667">webapp</a>: <span title="org.eclipse.jetty.webapp.WebAppContext">WebAppContext</span>, <a title="Seq[java.net.URL]" id="89668">urls</a>: <span title="Seq[java.net.URL]">Seq</span>[URL]): <span title="java.lang.ClassLoader">ClassLoader</span> =
	{
		<span class="keyword">def</span> <a title="(List[String])java.lang.ClassLoader" id="90505">attempt</a>(<a title="List[String]" id="90506">remaining</a>: <a title="List[String]" id="495">List</a>[String]): <span title="java.lang.ClassLoader">ClassLoader</span> =
			<a href="#90506" title="List[String]">remaining</a> <span title="java.lang.ClassLoader" class="keyword">match</span> {
				<span title="Nothing" class="keyword">case</span> <span title="object Nil">Nil</span> =&gt; <a title="(String)Nothing" id="787">error</a>(<span title="java.lang.String(&quot;Could not instantiate WebAppClassLoader&quot;)" class="string">&quot;Could not instantiate WebAppClassLoader&quot;</span>)
				<span title="java.lang.ClassLoader" class="keyword">case</span> <a title="String" id="90507">v</a> :: <a title="List[String]" id="90508">vs</a> =&gt;
					<span class="keyword">try</span> { <a href="#89313" title="(String,java.lang.ClassLoader,org.eclipse.jetty.webapp.WebAppContext,Seq[java.net.URL])java.lang.ClassLoader">tryLoad</a>(<a href="#89311" title="=&gt; java.lang.String">loaderBaseName</a> <span title="(Any)java.lang.String">+</span> <a href="#90507" title="String">v</a>, <a href="#89666" title="java.lang.ClassLoader">parent</a>, <a href="#89667" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>, <a href="#89668" title="Seq[java.net.URL]">urls</a>) }
					<span class="keyword">catch</span> { <span title="java.lang.ClassLoader" class="keyword">case</span> _: <a title="java.lang.NoClassDefFoundError" id="1869">NoClassDefFoundError</a> | _: java.lang.reflect.<a title="java.lang.reflect.InvocationTargetException" id="3881">InvocationTargetException</a> =&gt; <a href="#90505" title="(List[String])java.lang.ClassLoader">attempt</a>(<a href="#90508" title="List[String]">vs</a>) }
			}
		<a href="#90505" title="(List[String])java.lang.ClassLoader">attempt</a>(<a href="#89310" title="=&gt; List[java.lang.String]">compatVersions</a>)
	}
	<span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">def</span> <a title="(String,java.lang.ClassLoader,org.eclipse.jetty.webapp.WebAppContext,Seq[java.net.URL])java.lang.ClassLoader" id="89313">tryLoad</a>(<a title="String" id="90509">name</a>: <span title="String">String</span>, <a title="java.lang.ClassLoader" id="90510">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="org.eclipse.jetty.webapp.WebAppContext" id="90511">webapp</a>: <span title="org.eclipse.jetty.webapp.WebAppContext">WebAppContext</span>, <a title="Seq[java.net.URL]" id="90512">urls</a>: <span title="Seq[java.net.URL]">Seq</span>[URL]): <span title="java.lang.ClassLoader">ClassLoader</span> =
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="90513">clazz</a> = <a title="object java.lang.Class" id="1612">Class</a>.<a title="(java.lang.String)java.lang.Class[_]" id="3908">forName</a>(<a href="#90509" title="String">name</a>)
		<span class="keyword">val</span> <a title="java.lang.reflect.Constructor[_]" id="90514">construct</a> = <a href="#90513" title="java.lang.Class[_]">clazz</a>.<a title="((java.lang.Class[_]*)java.lang.reflect.Constructor[?0]) forSome { type ?0 }" id="4324">getConstructor</a>(<span title="java.lang.Class[java.lang.ClassLoader]">classOf</span>[ClassLoader], <span title="java.lang.Class[org.eclipse.jetty.webapp.WebAppContext]">classOf</span>[WebAppContext], <span title="java.lang.Class[Seq[java.net.URL]]">classOf</span>[Seq[URL]])
		<a href="#90514" title="java.lang.reflect.Constructor[_]">construct</a>.<a title="(java.lang.Object*)Any" id="3971">newInstance</a>(<a href="#90510" title="java.lang.ClassLoader">parent</a>, <a href="#90511" title="org.eclipse.jetty.webapp.WebAppContext">webapp</a>, <a href="#90512" title="Seq[java.net.URL]">urls</a>).<a title="java.lang.ClassLoader" id="3442">asInstanceOf</a>[<span title="java.lang.ClassLoader">ClassLoader</span>]
	}
}

        </pre>
    </body>
</html>