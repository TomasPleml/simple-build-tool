<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/StackTrace.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2010 Tony Sloane
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">object</span> <a title="object sbt.StackTrace" id="12235">StackTrace</a>
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="65404">isSbtClass</a>(<a title="String" id="75150">name</a>: <span title="String">String</span>) = <a href="#75150" title="String">name</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<span title="java.lang.String(&quot;sbt&quot;)" class="string">&quot;sbt&quot;</span>) <a title="(Boolean)Boolean" id="2693">||</a> <a href="#75150" title="String">name</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<span title="java.lang.String(&quot;xsbt&quot;)" class="string">&quot;xsbt&quot;</span>)
	<span class="comment">/**
		* Return a printable representation of the stack trace associated
		* with t.  Information about t and its Throwable causes is included.
		* The number of lines to be included for each Throwable is configured
		* via d which should be greater than or equal to zero.  If d is zero,
		* then all elements are included up to (but not including) the first
		* element that comes from sbt. If d is greater than zero, then up to
		* that many lines are included, where the line for the Throwable is
		* counted plus one line for each stack element.  Less lines will be
		* included if there are not enough stack elements.
		*/</span>
	<span class="keyword">def</span> <a title="(Throwable,Int)String" id="65405">trimmed</a>(<a title="Throwable" id="65406">t</a> : <span title="Throwable">Throwable</span>, <a title="Int" id="65407">d</a> : <a title="Int" id="2346">Int</a>) : <span title="String">String</span> = {
		<a title="(Boolean)Unit" id="791">require</a>(<a href="#65407" title="Int">d</a> <span title="(Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>)
		<span class="keyword">val</span> <a title="StringBuilder" id="75154">b</a> = <a title="()StringBuilder" id="17854" class="keyword">new</a> <a title="StringBuilder" id="1387">StringBuilder</a> ()

		<span class="keyword">def</span> <a title="(Throwable,Boolean)Unit" id="75155">appendStackTrace</a> (<a title="Throwable" id="75164">t</a> : <span title="Throwable">Throwable</span>, <a title="Boolean" id="75165">first</a> : <a title="Boolean" id="2110">Boolean</a>) {

			<span class="keyword">val</span> <a title="(java.lang.StackTraceElement) =&gt; Boolean" id="75166">include</a> : StackTraceElement =&gt; Boolean =
				<span title="(java.lang.StackTraceElement) =&gt; Boolean" class="keyword">if</span> (<a href="#65407" title="Int">d</a> <a title="(Int)Boolean" id="3084">==</a> <span title="Int(0)" class="int">0</span>)
					<a title="java.lang.StackTraceElement" id="75181">element</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#65404" title="(String)Boolean">isSbtClass</a>(<a href="#75181" title="java.lang.StackTraceElement">element</a>.<a title="()java.lang.String" id="75173">getClassName</a>)
				<span class="keyword">else</span> {
					<span class="keyword">var</span> <a title="Int" id="75182">count</a> = <a href="#65407" title="Int">d</a> <span title="(Int)Int">-</span> <span title="Int(1)" class="int">1</span>
					(<a title="java.lang.StackTraceElement" id="75185">_</a> =&gt; { <a href="#75182" title="Int">count</a> <span title="(Int)Int">-=</span> <span title="Int(1)" class="int">1</span>; <a href="#75182" title="Int">count</a> <span title="(Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span> })
				}

			<span class="keyword">def</span> <a title="(java.lang.StackTraceElement)Unit" id="75167">appendElement</a> (<a title="java.lang.StackTraceElement" id="75205">e</a> : <a title="java.lang.StackTraceElement" id="1798">StackTraceElement</a>) {
				<a href="#75154" title="StringBuilder">b</a>.<span title="(String)StringBuilder">append</span> (<span title="java.lang.String(&quot;\011at &quot;)" class="string">&quot;\tat &quot;</span>)
				<a href="#75154" title="StringBuilder">b</a>.<span title="(Any)StringBuilder">append</span> (<a href="#75205" title="java.lang.StackTraceElement">e</a>)
				<a href="#75154" title="StringBuilder">b</a>.<span title="(Char)StringBuilder">append</span> (<span title="Char('\012')" class="char">'\n'</span>)
			}

			<span title="Unit" class="keyword">if</span> (<span title="=&gt; Boolean">!</span><a href="#75165" title="Boolean">first</a>)
				<a href="#75154" title="StringBuilder">b</a>.<span title="(String)StringBuilder">append</span> (<span title="java.lang.String(&quot;Caused by: &quot;)" class="string">&quot;Caused by: &quot;</span>)
			<a href="#75154" title="StringBuilder">b</a>.<span title="(Any)StringBuilder">append</span> (<a href="#75164" title="Throwable">t</a>)
			<a href="#75154" title="StringBuilder">b</a>.<span title="(Char)StringBuilder">append</span> (<span title="Char('\012')" class="char">'\n'</span>)

			<span class="keyword">val</span> <a title="Array[java.lang.StackTraceElement]" id="75168">els</a> = <a href="#75164" title="Throwable">t</a>.<a title="()Array[java.lang.StackTraceElement]" id="17838">getStackTrace</a> ()
			<span class="keyword">var</span> <a title="Int" id="75169">i</a> = <span title="Int(0)" class="int">0</span>
			<a href="#75218" title="Unit" class="keyword">while</a> ((<a href="#75169" title="Int">i</a> <a title="(Int)Boolean" id="3086">&lt;</a> <a href="#75168" title="Array[java.lang.StackTraceElement]">els</a>.<a title="=&gt; Int" id="15803">size</a>) <a title="(Boolean)Boolean" id="2694">&amp;&amp;</a> <a href="#75166" title="(java.lang.StackTraceElement)Boolean" id="15917">include</a> (<a href="#75168" title="(Int)java.lang.StackTraceElement">els</a> (<a href="#75169" title="Int">i</a>))) {
				<a href="#75167" title="(java.lang.StackTraceElement)Unit">appendElement</a> (<a href="#75168" title="(Int)java.lang.StackTraceElement">els</a> (<a href="#75169" title="Int">i</a>))
				<a href="#75169" title="Int">i</a> <a title="(Int)Int" id="3090">+=</a> <span title="Int(1)" class="int">1</span>
			}

		}

		<a href="#75155" title="(Throwable,Boolean)Unit">appendStackTrace</a> (<a href="#65406" title="Throwable">t</a>, <span title="Boolean(true)" class="keyword">true</span>)
		<span class="keyword">var</span> <a title="Throwable" id="75156">c</a> = <a href="#65406" title="Throwable">t</a>
		<a href="#75157" title="Unit" class="keyword">while</a> (<a href="#75156" title="Throwable">c</a>.<span title="()java.lang.Throwable">getCause</span> () <a title="(AnyRef)Boolean" id="6016">!=</a> <span title="Null(null)" class="keyword">null</span>) {
			<a href="#75156" title="Throwable">c</a> = <a href="#75156" title="Throwable">c</a>.<span title="()java.lang.Throwable">getCause</span> ()
			<a href="#75155" title="(Throwable,Boolean)Unit">appendStackTrace</a> (<a href="#75156" title="Throwable">c</a>, <span title="Boolean(false)" class="keyword">false</span>)
		}
		<a href="#75154" title="StringBuilder">b</a>.<a title="()String" id="17906">toString</a> ()

	}
}
        </pre>
    </body>
</html>