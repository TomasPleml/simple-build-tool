<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>AnalyzingCompiler.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> xsbt

	<span class="keyword">import</span> sbt.ComponentManager
	<span class="keyword">import</span> xsbti.{AnalysisCallback, Logger =&gt; xLogger}
	<span class="keyword">import</span> java.io.File
	<span class="keyword">import</span> java.net.{URL, URLClassLoader}

<span class="comment">/** Interface to the Scala compiler that uses the dependency analysis plugin.  This class uses the Scala library and compiler
* provided by scalaInstance.  This class requires a ComponentManager in order to obtain the interface code to scalac and
* the analysis plugin.  Because these call Scala code for a different Scala version than the one used for this class, they must
* be compiled for the version of Scala being used.*/</span>
<span class="keyword">class</span> <a title="class AnalyzingCompiler extends java.lang.Object with NotNull with ScalaObject" id="12509">AnalyzingCompiler</a>(<span class="keyword">val</span> <a title="xsbt.ScalaInstance" id="27362">scalaInstance</a>: <a href="ScalaInstance.scala.html#12893" title="xsbt.ScalaInstance">ScalaInstance</a>, <span class="keyword">val</span> <a title="sbt.ComponentManager" id="27363">manager</a>: <a href="ComponentManager.scala.html#8778" title="sbt.ComponentManager">ComponentManager</a>, <span class="keyword">val</span> <a title="xsbt.ClasspathOptions" id="27364">cp</a>: <a href="CompilerArguments.scala.html#12758" title="xsbt.ClasspathOptions">ClasspathOptions</a>, <a title="xsbt.CompileLogger" id="27365">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>) <span class="keyword">extends</span> <a title="NotNull" id="189">NotNull</a>
{
	<span class="keyword">def</span> <a title="(xsbt.ScalaInstance,sbt.ComponentManager,xsbt.CompileLogger)xsbt.AnalyzingCompiler" id="27320" class="keyword">this</a>(<a title="xsbt.ScalaInstance" id="27333">scalaInstance</a>: <a href="ScalaInstance.scala.html#12893" title="xsbt.ScalaInstance">ScalaInstance</a>, <a title="sbt.ComponentManager" id="27334">manager</a>: <a href="ComponentManager.scala.html#8778" title="sbt.ComponentManager">ComponentManager</a>, <a title="xsbt.CompileLogger" id="27335">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>) = <a href="#12509" title="AnalyzingCompiler.this.type" class="keyword">this</a>(<a href="#27333" title="xsbt.ScalaInstance">scalaInstance</a>, <a href="#27334" title="sbt.ComponentManager">manager</a>, <a href="CompilerArguments.scala.html#12759" title="object xsbt.ClasspathOptions">ClasspathOptions</a>.<a href="CompilerArguments.scala.html#66497" title="=&gt; xsbt.ClasspathOptions">auto</a>, <a href="#27335" title="xsbt.CompileLogger">log</a>)
	<span class="keyword">def</span> <a title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String],xsbti.AnalysisCallback,Int,xsbt.CompileLogger)Unit" id="27321">apply</a>(<a title="Set[java.io.File]" id="66504">sources</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Set[java.io.File]" id="66505">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="java.io.File" id="66506">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="66507">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="xsbti.AnalysisCallback" id="66508">callback</a>: <a href="xsbti/AnalysisCallback.java.html#5866" title="xsbti.AnalysisCallback">AnalysisCallback</a>, <a title="Int" id="66509">maximumErrors</a>: <span title="Int">Int</span>, <a title="xsbt.CompileLogger" id="66510">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>)
	{
		<span class="keyword">val</span> <a title="Seq[String]" id="66511">arguments</a> = (<a href="CompilerArguments.scala.html#33400" title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String])Seq[String]" class="keyword">new</a> <a href="CompilerArguments.scala.html#12773" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#27364" title="=&gt; xsbt.ClasspathOptions">cp</a>))(<a href="#66504" title="Set[java.io.File]">sources</a>, <a href="#66505" title="Set[java.io.File]">classpath</a>, <a href="#66506" title="java.io.File">outputDirectory</a>, <a href="#66507" title="Seq[String]">options</a>)
		<a href="#27325" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.CompilerInterface&quot;)" class="string">&quot;xsbt.CompilerInterface&quot;</span>, <a href="#66510" title="xsbt.CompileLogger">log</a>)(
			<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[xsbti.AnalysisCallback]">classOf</span>[AnalysisCallback], <span title="java.lang.Class[Int]">classOf</span>[Int], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger] ) (
			<a href="#66511" title="Seq[String]">arguments</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>] : <span title="Array[String]">Array</span>[String], <a href="#66508" title="xsbti.AnalysisCallback">callback</a>, <a href="#66509" title="implicit scala.Predef.int2Integer : (Int)java.lang.Integer">maximumErrors</a>: java.lang.<span title="java.lang.Integer">Integer</span>, <a href="#66510" title="xsbt.CompileLogger">log</a> )
	}
	<span class="keyword">def</span> <a title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String],Int,xsbt.CompileLogger)Unit" id="27322">doc</a>(<a title="Set[java.io.File]" id="66522">sources</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Set[java.io.File]" id="66523">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="java.io.File" id="66524">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="66525">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="Int" id="66526">maximumErrors</a>: <span title="Int">Int</span>, <a title="xsbt.CompileLogger" id="66527">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">val</span> <a title="Seq[String]" id="66528">arguments</a> = (<a href="CompilerArguments.scala.html#33400" title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String])Seq[String]" class="keyword">new</a> <a href="CompilerArguments.scala.html#12773" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#27364" title="=&gt; xsbt.ClasspathOptions">cp</a>))(<a href="#66522" title="Set[java.io.File]">sources</a>, <a href="#66523" title="Set[java.io.File]">classpath</a>, <a href="#66524" title="java.io.File">outputDirectory</a>, <a href="#66525" title="Seq[String]">options</a>)
		<a href="#27325" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.ScaladocInterface&quot;)" class="string">&quot;xsbt.ScaladocInterface&quot;</span>, <a href="#66527" title="xsbt.CompileLogger">log</a>) (<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[Int]">classOf</span>[Int], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger]) (<a href="#66528" title="Seq[String]">arguments</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>] : <span title="Array[String]">Array</span>[String], <a href="#66526" title="implicit scala.Predef.int2Integer : (Int)java.lang.Integer">maximumErrors</a>: java.lang.<span title="java.lang.Integer">Integer</span>, <a href="#66527" title="xsbt.CompileLogger">log</a>)
	}
	<span class="keyword">def</span> <a title="(Set[java.io.File],Seq[String],String,xsbt.CompileLogger)Unit" id="27323">console</a>(<a title="Set[java.io.File]" id="66532">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Seq[String]" id="66533">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="String" id="66534">initialCommands</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="66535">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">val</span> <a title="xsbt.CompilerArguments" id="66536">arguments</a> = <span title="xsbt.CompilerArguments" class="keyword">new</span> <a href="CompilerArguments.scala.html#12773" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#27364" title="=&gt; xsbt.ClasspathOptions">cp</a>)
		<span class="keyword">val</span> <a title="String" id="66537">classpathString</a> = <a href="CompilerArguments.scala.html#12774" title="object xsbt.CompilerArguments">CompilerArguments</a>.<a href="CompilerArguments.scala.html#33352" title="(Set[java.io.File])String">absString</a>(<a href="#66536" title="xsbt.CompilerArguments">arguments</a>.<a href="CompilerArguments.scala.html#33401" title="(Set[java.io.File])Set[java.io.File]">finishClasspath</a>(<a href="#66532" title="Set[java.io.File]">classpath</a>))
		<span class="keyword">val</span> <a title="java.lang.String" id="66538">bootClasspath</a> = <span title="java.lang.String" class="keyword">if</span>(<a href="#27364" title="=&gt; xsbt.ClasspathOptions">cp</a>.<a href="CompilerArguments.scala.html#33360" title="=&gt; Boolean">autoBoot</a>) <a href="#66536" title="xsbt.CompilerArguments">arguments</a>.<a href="CompilerArguments.scala.html#33405" title="=&gt; java.lang.String">createBootClasspath</a> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
		<a href="#27325" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.ConsoleInterface&quot;)" class="string">&quot;xsbt.ConsoleInterface&quot;</span>, <a href="#66535" title="xsbt.CompileLogger">log</a>) (<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger]) (<a href="#66533" title="Seq[String]">options</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>]: <span title="Array[String]">Array</span>[String], <a href="#66538" title="java.lang.String">bootClasspath</a>, <a href="#66537" title="String">classpathString</a>, <a href="#66534" title="String">initialCommands</a>, <a href="#66535" title="xsbt.CompileLogger">log</a>)
	}
	<span class="keyword">def</span> <a title="(xsbt.CompileLogger)Unit" id="27324">force</a>(<a title="xsbt.CompileLogger" id="66567">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> = <a href="#27328" title="(xsbt.CompileLogger)java.io.File">getInterfaceJar</a>(<a href="#66567" title="xsbt.CompileLogger">log</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit" id="27325">call</a>(<a title="String" id="66512">interfaceClassName</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="66513">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>)(<a title="Class[_]*" id="66514">argTypes</a>: <span title="Class[_]*">Class</span>[_]*)(<a title="AnyRef*" id="66515">args</a>: <span title="AnyRef*">AnyRef</span>*)
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="66575">interfaceClass</a> = <a href="#27327" title="(String,xsbt.CompileLogger)java.lang.Class[_]">getInterfaceClass</a>(<a href="#66512" title="String">interfaceClassName</a>, <a href="#66513" title="xsbt.CompileLogger">log</a>)
		<span class="keyword">val</span> <a title="AnyRef" id="66576">interface</a> = <a href="#66575" title="java.lang.Class[_]">interfaceClass</a>.<a title="()Any" id="3889">newInstance</a>.<a title="AnyRef" id="3451">asInstanceOf</a>[<a title="AnyRef" id="1962">AnyRef</a>]
		<span class="keyword">val</span> <a title="java.lang.reflect.Method" id="66577">method</a> = <a href="#66575" title="java.lang.Class[_]">interfaceClass</a>.<a title="(java.lang.String,java.lang.Class[_]*)java.lang.reflect.Method" id="4293">getMethod</a>(<span title="java.lang.String(&quot;run&quot;)" class="string">&quot;run&quot;</span>, <a href="#66514" title="Class[_]*">argTypes</a> : _*)
		<span class="keyword">try</span> { <a href="#66577" title="java.lang.reflect.Method">method</a>.<a title="(Any,java.lang.Object*)java.lang.Object" id="24088">invoke</a>(<a href="#66576" title="AnyRef">interface</a>, <a href="#66515" title="AnyRef*">args</a>: _*) }
		<span class="keyword">catch</span> { <span title="Nothing" class="keyword">case</span> <a title="java.lang.reflect.InvocationTargetException" id="66801">e</a>: java.lang.reflect.<a title="java.lang.reflect.InvocationTargetException" id="3857">InvocationTargetException</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#66801" title="java.lang.reflect.InvocationTargetException">e</a>.<a title="()java.lang.Throwable" id="66806">getCause</a> }
	}
	<span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">def</span> <a title="=&gt; java.net.URLClassLoader" id="27326">loader</a> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="66591">interfaceJar</a> = <a href="#27328" title="(xsbt.CompileLogger)java.io.File">getInterfaceJar</a>(<a href="#27365" title="xsbt.CompileLogger">log</a>)
		<span class="keyword">val</span> <a title="java.lang.ClassLoader" id="66592">dual</a> = <a href="#27330" title="(java.lang.ClassLoader,java.lang.ClassLoader)java.lang.ClassLoader">createDualLoader</a>(<a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#23397" title="=&gt; java.lang.ClassLoader">loader</a>, <a href="#12509" title="()java.lang.Class[_ &lt;: java.lang.Object]" id="3459">getClass</a>.<a title="()java.lang.ClassLoader" id="3900">getClassLoader</a>) <span class="comment">// this goes to scalaLoader for scala classes and sbtLoader for xsbti classes</span>
		<span title="java.net.URLClassLoader" class="keyword">new</span> <a title="java.net.URLClassLoader" id="4363">URLClassLoader</a>(<a title="(java.net.URL*)Array[java.net.URL]" id="1033">Array</a>(<a href="#66591" title="java.io.File">interfaceJar</a>.<a title="()java.net.URI" id="16229">toURI</a>.<a title="()java.net.URL" id="24307">toURL</a>), <a href="#66592" title="java.lang.ClassLoader">dual</a>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String,xsbt.CompileLogger)java.lang.Class[_]" id="27327">getInterfaceClass</a>(<a title="String" id="66578">name</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="66579">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>) = <a title="object java.lang.Class" id="1618">Class</a>.<a title="(java.lang.String,Boolean,java.lang.ClassLoader)java.lang.Class[_]" id="3887">forName</a>(<a href="#66578" title="String">name</a>, <span title="Boolean(true)" class="keyword">true</span>, <a href="#27326" title="=&gt; java.net.URLClassLoader">loader</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(xsbt.CompileLogger)java.io.File" id="27328">getInterfaceJar</a>(<a title="xsbt.CompileLogger" id="66568">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>) =
	{
		<span class="comment">// this is the instance used to compile the interface component</span>
		<span class="keyword">val</span> <a title="xsbt.ComponentCompiler" id="66570">componentCompiler</a> = <a href="#27329" title="(xsbt.CompileLogger)xsbt.ComponentCompiler">newComponentCompiler</a>(<a href="#66568" title="xsbt.CompileLogger">log</a>)
		<a href="#66568" title="xsbt.CompileLogger">log</a>.<a href="CompileLogger.scala.html#19719" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Getting &quot;)" class="string">&quot;Getting &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="ComponentCompiler.scala.html#12687" title="object xsbt.ComponentCompiler">ComponentCompiler</a>.<a href="ComponentCompiler.scala.html#65448" title="=&gt; java.lang.String">compilerInterfaceID</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; from component compiler for Scala &quot;)" class="string">&quot; from component compiler for Scala &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#23395" title="=&gt; String">version</a>)
		<a href="ComponentCompiler.scala.html#65463" title="(String)java.io.File">componentCompiler</a>(<a href="ComponentCompiler.scala.html#12687" title="object xsbt.ComponentCompiler">ComponentCompiler</a>.<a href="ComponentCompiler.scala.html#65448" title="=&gt; java.lang.String">compilerInterfaceID</a>)
	}
	<span class="keyword">def</span> <a title="(xsbt.CompileLogger)xsbt.ComponentCompiler" id="27329">newComponentCompiler</a>(<a title="xsbt.CompileLogger" id="66571">log</a>: <a href="CompileLogger.scala.html#12260" title="xsbt.CompileLogger">CompileLogger</a>) = <span title="xsbt.ComponentCompiler" class="keyword">new</span> <a href="ComponentCompiler.scala.html#12686" title="xsbt.ComponentCompiler">ComponentCompiler</a>(<span title="xsbt.RawCompiler" class="keyword">new</span> <a href="RawCompiler.scala.html#12554" title="xsbt.RawCompiler">RawCompiler</a>(<a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="CompilerArguments.scala.html#12759" title="object xsbt.ClasspathOptions">ClasspathOptions</a>.<a href="CompilerArguments.scala.html#66497" title="=&gt; xsbt.ClasspathOptions">auto</a>, <a href="#66571" title="xsbt.CompileLogger">log</a>), <a href="#27363" title="=&gt; sbt.ComponentManager">manager</a>)
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(java.lang.ClassLoader,java.lang.ClassLoader)java.lang.ClassLoader" id="27330">createDualLoader</a>(<a title="java.lang.ClassLoader" id="66593">scalaLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="java.lang.ClassLoader" id="66594">sbtLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> =
	{
		<span class="keyword">val</span> <a title="(String) =&gt; Boolean" id="66807">xsbtiFilter</a> = (<a title="String" id="66810">name</a>: <span title="String">String</span>) =&gt; <a href="#66810" title="String">name</a>.<a title="(java.lang.String)Boolean" id="5786">startsWith</a>(<span title="java.lang.String(&quot;xsbti.&quot;)" class="string">&quot;xsbti.&quot;</span>)
		<span class="keyword">val</span> <a title="(String) =&gt; Boolean" id="66808">notXsbtiFilter</a> = (<a title="String" id="66813">name</a>: <span title="String">String</span>) =&gt; <a title="=&gt; Boolean" id="2695">!</a><a href="#66807" title="(String)Boolean" id="16544">xsbtiFilter</a>(<a href="#66813" title="String">name</a>)
		<span title="xsbt.DualLoader" class="keyword">new</span> <a href="DualLoader.scala.html#12887" title="xsbt.DualLoader">DualLoader</a>(<a href="#66593" title="java.lang.ClassLoader">scalaLoader</a>, <a href="#66808" title="(String) =&gt; Boolean">notXsbtiFilter</a>, <a title="String" id="66816">x</a> =&gt; <span title="Boolean(true)" class="keyword">true</span>, <a href="#66594" title="java.lang.ClassLoader">sbtLoader</a>, <a href="#66807" title="(String) =&gt; Boolean">xsbtiFilter</a>, <a title="String" id="66818">x</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>)
	}
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="27331">toString</a> = <span title="java.lang.String(&quot;Analyzing compiler (Scala &quot;)" class="string">&quot;Analyzing compiler (Scala &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#27362" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#23407" title="=&gt; java.lang.String">actualVersion</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
}
        </pre>
    </body>
</html>