<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>AnalyzingCompiler.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> xsbt

	<span class="keyword">import</span> sbt.ComponentManager
	<span class="keyword">import</span> xsbti.{AnalysisCallback, Logger =&gt; xLogger}
	<span class="keyword">import</span> java.io.File
	<span class="keyword">import</span> java.net.{URL, URLClassLoader}

<span class="comment">/** Interface to the Scala compiler that uses the dependency analysis plugin.  This class uses the Scala library and compiler
* provided by scalaInstance.  This class requires a ComponentManager in order to obtain the interface code to scalac and
* the analysis plugin.  Because these call Scala code for a different Scala version than the one used for this class, they must
* be compiled for the version of Scala being used.*/</span>
<span class="keyword">class</span> <a title="class AnalyzingCompiler extends java.lang.Object with NotNull with ScalaObject" id="12411">AnalyzingCompiler</a>(<span class="keyword">val</span> <a title="xsbt.ScalaInstance" id="27053">scalaInstance</a>: <a href="ScalaInstance.scala.html#12786" title="xsbt.ScalaInstance">ScalaInstance</a>, <span class="keyword">val</span> <a title="sbt.ComponentManager" id="27054">manager</a>: <a href="ComponentManager.scala.html#8745" title="sbt.ComponentManager">ComponentManager</a>, <span class="keyword">val</span> <a title="Boolean" id="27055">autoBootClasspath</a>: <span title="Boolean">Boolean</span>, <span class="keyword">val</span> <a title="Boolean" id="27056">compilerOnClasspath</a>: <span title="Boolean">Boolean</span>, <a title="xsbt.CompileLogger" id="27057">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>) <span class="keyword">extends</span> <a title="NotNull" id="189">NotNull</a>
{
	<span class="keyword">def</span> <a title="(xsbt.ScalaInstance,sbt.ComponentManager,xsbt.CompileLogger)xsbt.AnalyzingCompiler" id="27011" class="keyword">this</a>(<a title="xsbt.ScalaInstance" id="27024">scalaInstance</a>: <a href="ScalaInstance.scala.html#12786" title="xsbt.ScalaInstance">ScalaInstance</a>, <a title="sbt.ComponentManager" id="27025">manager</a>: <a href="ComponentManager.scala.html#8745" title="sbt.ComponentManager">ComponentManager</a>, <a title="xsbt.CompileLogger" id="27026">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>) = <a href="#12411" title="AnalyzingCompiler.this.type" class="keyword">this</a>(<a href="#27024" title="xsbt.ScalaInstance">scalaInstance</a>, <a href="#27025" title="sbt.ComponentManager">manager</a>, <span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="#27026" title="xsbt.CompileLogger">log</a>)
	<span class="keyword">def</span> <a title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String],xsbti.AnalysisCallback,Int,xsbt.CompileLogger)Unit" id="27012">apply</a>(<a title="Set[java.io.File]" id="65989">sources</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Set[java.io.File]" id="65990">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="java.io.File" id="65991">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="65992">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="xsbti.AnalysisCallback" id="65993">callback</a>: <a href="xsbti/AnalysisCallback.java.html#5866" title="xsbti.AnalysisCallback">AnalysisCallback</a>, <a title="Int" id="65994">maximumErrors</a>: <span title="Int">Int</span>, <a title="xsbt.CompileLogger" id="65995">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>)
	{
		<span class="keyword">val</span> <a title="Seq[String]" id="65996">arguments</a> = (<a href="CompilerArguments.scala.html#33406" title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String])Seq[String]" class="keyword">new</a> <a href="CompilerArguments.scala.html#12669" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#27055" title="=&gt; Boolean">autoBootClasspath</a>, <a href="#27056" title="=&gt; Boolean">compilerOnClasspath</a>))(<a href="#65989" title="Set[java.io.File]">sources</a>, <a href="#65990" title="Set[java.io.File]">classpath</a>, <a href="#65991" title="java.io.File">outputDirectory</a>, <a href="#65992" title="Seq[String]">options</a>)
		<a href="#27016" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.CompilerInterface&quot;)" class="string">&quot;xsbt.CompilerInterface&quot;</span>, <a href="#65995" title="xsbt.CompileLogger">log</a>)(
			<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[xsbti.AnalysisCallback]">classOf</span>[AnalysisCallback], <span title="java.lang.Class[Int]">classOf</span>[Int], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger] ) (
			<a href="#65996" title="Seq[String]">arguments</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>] : <span title="Array[String]">Array</span>[String], <a href="#65993" title="xsbti.AnalysisCallback">callback</a>, <a href="#65994" title="implicit scala.Predef.int2Integer : (Int)java.lang.Integer">maximumErrors</a>: java.lang.<span title="java.lang.Integer">Integer</span>, <a href="#65995" title="xsbt.CompileLogger">log</a> )
	}
	<span class="keyword">def</span> <a title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String],Int,xsbt.CompileLogger)Unit" id="27013">doc</a>(<a title="Set[java.io.File]" id="66007">sources</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="Set[java.io.File]" id="66008">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="java.io.File" id="66009">outputDirectory</a>: <span title="java.io.File">File</span>, <a title="Seq[String]" id="66010">options</a>: <span title="Seq[String]">Seq</span>[String], <a title="Int" id="66011">maximumErrors</a>: <span title="Int">Int</span>, <a title="xsbt.CompileLogger" id="66012">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">val</span> <a title="Seq[String]" id="66013">arguments</a> = (<a href="CompilerArguments.scala.html#33406" title="(Set[java.io.File],Set[java.io.File],java.io.File,Seq[String])Seq[String]" class="keyword">new</a> <a href="CompilerArguments.scala.html#12669" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#27055" title="=&gt; Boolean">autoBootClasspath</a>, <a href="#27056" title="=&gt; Boolean">compilerOnClasspath</a>))(<a href="#66007" title="Set[java.io.File]">sources</a>, <a href="#66008" title="Set[java.io.File]">classpath</a>, <a href="#66009" title="java.io.File">outputDirectory</a>, <a href="#66010" title="Seq[String]">options</a>)
		<a href="#27016" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.ScaladocInterface&quot;)" class="string">&quot;xsbt.ScaladocInterface&quot;</span>, <a href="#66012" title="xsbt.CompileLogger">log</a>) (<span title="java.lang.Class[Array[String]]">classOf</span>[Array[String]], <span title="java.lang.Class[Int]">classOf</span>[Int], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger]) (<a href="#66013" title="Seq[String]">arguments</a>.<span title="Array[String]">toArray</span>[<span title="String">String</span>] : <span title="Array[String]">Array</span>[String], <a href="#66011" title="implicit scala.Predef.int2Integer : (Int)java.lang.Integer">maximumErrors</a>: java.lang.<span title="java.lang.Integer">Integer</span>, <a href="#66012" title="xsbt.CompileLogger">log</a>)
	}
	<span class="keyword">def</span> <a title="(Set[java.io.File],String,xsbt.CompileLogger)Unit" id="27014">console</a>(<a title="Set[java.io.File]" id="66017">classpath</a>: <span title="Set[java.io.File]">Set</span>[File], <a title="String" id="66018">initialCommands</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="66019">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> =
	{
		<span class="keyword">val</span> <a title="xsbt.CompilerArguments" id="66020">arguments</a> = <span title="xsbt.CompilerArguments" class="keyword">new</span> <a href="CompilerArguments.scala.html#12669" title="xsbt.CompilerArguments">CompilerArguments</a>(<a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <a href="#27055" title="=&gt; Boolean">autoBootClasspath</a>, <a href="#27056" title="=&gt; Boolean">compilerOnClasspath</a>)
		<span class="keyword">val</span> <a title="String" id="66021">classpathString</a> = <a href="CompilerArguments.scala.html#12670" title="object xsbt.CompilerArguments">CompilerArguments</a>.<a href="CompilerArguments.scala.html#33418" title="(Set[java.io.File])String">absString</a>(<a href="#66020" title="xsbt.CompilerArguments">arguments</a>.<a href="CompilerArguments.scala.html#33407" title="(Set[java.io.File])Set[java.io.File]">finishClasspath</a>(<a href="#66017" title="Set[java.io.File]">classpath</a>))
		<span class="keyword">val</span> <a title="java.lang.String" id="66022">bootClasspath</a> = <span title="java.lang.String" class="keyword">if</span>(<a href="#27055" title="=&gt; Boolean">autoBootClasspath</a>) <a href="#66020" title="xsbt.CompilerArguments">arguments</a>.<a href="CompilerArguments.scala.html#33410" title="=&gt; java.lang.String">createBootClasspath</a> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
		<a href="#27016" title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit">call</a>(<span title="java.lang.String(&quot;xsbt.ConsoleInterface&quot;)" class="string">&quot;xsbt.ConsoleInterface&quot;</span>, <a href="#66019" title="xsbt.CompileLogger">log</a>) (<span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[String]">classOf</span>[String], <span title="java.lang.Class[xsbti.Logger]">classOf</span>[xLogger]) (<a href="#66022" title="java.lang.String">bootClasspath</a>, <a href="#66021" title="String">classpathString</a>, <a href="#66018" title="String">initialCommands</a>, <a href="#66019" title="xsbt.CompileLogger">log</a>)
	}
	<span class="keyword">def</span> <a title="(xsbt.CompileLogger)Unit" id="27015">force</a>(<a title="xsbt.CompileLogger" id="66048">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>): <span title="Unit">Unit</span> = <a href="#27019" title="(xsbt.CompileLogger)java.io.File">getInterfaceJar</a>(<a href="#66048" title="xsbt.CompileLogger">log</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String,xsbt.CompileLogger)(Class[_]*)(AnyRef*)Unit" id="27016">call</a>(<a title="String" id="65997">interfaceClassName</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="65998">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>)(<a title="Class[_]*" id="65999">argTypes</a>: <span title="Class[_]*">Class</span>[_]*)(<a title="AnyRef*" id="66000">args</a>: <span title="AnyRef*">AnyRef</span>*)
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="66056">interfaceClass</a> = <a href="#27018" title="(String,xsbt.CompileLogger)java.lang.Class[_]">getInterfaceClass</a>(<a href="#65997" title="String">interfaceClassName</a>, <a href="#65998" title="xsbt.CompileLogger">log</a>)
		<span class="keyword">val</span> <a title="AnyRef" id="66057">interface</a> = <a href="#66056" title="java.lang.Class[_]">interfaceClass</a>.<a title="()Any" id="3889">newInstance</a>.<a title="AnyRef" id="3451">asInstanceOf</a>[<a title="AnyRef" id="1962">AnyRef</a>]
		<span class="keyword">val</span> <a title="java.lang.reflect.Method" id="66058">method</a> = <a href="#66056" title="java.lang.Class[_]">interfaceClass</a>.<a title="(java.lang.String,java.lang.Class[_]*)java.lang.reflect.Method" id="4293">getMethod</a>(<span title="java.lang.String(&quot;run&quot;)" class="string">&quot;run&quot;</span>, <a href="#65999" title="Class[_]*">argTypes</a> : _*)
		<span class="keyword">try</span> { <a href="#66058" title="java.lang.reflect.Method">method</a>.<a title="(Any,java.lang.Object*)java.lang.Object" id="23760">invoke</a>(<a href="#66057" title="AnyRef">interface</a>, <a href="#66000" title="AnyRef*">args</a>: _*) }
		<span class="keyword">catch</span> { <span title="Nothing" class="keyword">case</span> <a title="java.lang.reflect.InvocationTargetException" id="66282">e</a>: java.lang.reflect.<a title="java.lang.reflect.InvocationTargetException" id="3857">InvocationTargetException</a> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#66282" title="java.lang.reflect.InvocationTargetException">e</a>.<a title="()java.lang.Throwable" id="66287">getCause</a> }
	}
	<span class="keyword">private</span>[<span class="keyword">this</span>] <span class="keyword">def</span> <a title="=&gt; java.net.URLClassLoader" id="27017">loader</a> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="66072">interfaceJar</a> = <a href="#27019" title="(xsbt.CompileLogger)java.io.File">getInterfaceJar</a>(<a href="#27057" title="xsbt.CompileLogger">log</a>)
		<span class="keyword">val</span> <a title="java.lang.ClassLoader" id="66073">dual</a> = <a href="#27021" title="(java.lang.ClassLoader,java.lang.ClassLoader)java.lang.ClassLoader">createDualLoader</a>(<a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#23070" title="=&gt; java.lang.ClassLoader">loader</a>, <a href="#12411" title="()java.lang.Class[_ &lt;: java.lang.Object]" id="3459">getClass</a>.<a title="()java.lang.ClassLoader" id="3900">getClassLoader</a>) <span class="comment">// this goes to scalaLoader for scala classes and sbtLoader for xsbti classes</span>
		<span title="java.net.URLClassLoader" class="keyword">new</span> <a title="java.net.URLClassLoader" id="4363">URLClassLoader</a>(<a title="(java.net.URL*)Array[java.net.URL]" id="1033">Array</a>(<a href="#66072" title="java.io.File">interfaceJar</a>.<a title="()java.net.URI" id="16018">toURI</a>.<a title="()java.net.URL" id="23977">toURL</a>), <a href="#66073" title="java.lang.ClassLoader">dual</a>)
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(String,xsbt.CompileLogger)java.lang.Class[_]" id="27018">getInterfaceClass</a>(<a title="String" id="66059">name</a>: <span title="String">String</span>, <a title="xsbt.CompileLogger" id="66060">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>) = <a title="object java.lang.Class" id="1618">Class</a>.<a title="(java.lang.String,Boolean,java.lang.ClassLoader)java.lang.Class[_]" id="3887">forName</a>(<a href="#66059" title="String">name</a>, <span title="Boolean(true)" class="keyword">true</span>, <a href="#27017" title="=&gt; java.net.URLClassLoader">loader</a>)
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="(xsbt.CompileLogger)java.io.File" id="27019">getInterfaceJar</a>(<a title="xsbt.CompileLogger" id="66049">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>) =
	{
		<span class="comment">// this is the instance used to compile the interface component</span>
		<span class="keyword">val</span> <a title="xsbt.ComponentCompiler" id="66051">componentCompiler</a> = <a href="#27020" title="(xsbt.CompileLogger)xsbt.ComponentCompiler">newComponentCompiler</a>(<a href="#66049" title="xsbt.CompileLogger">log</a>)
		<a href="#66049" title="xsbt.CompileLogger">log</a>.<a href="CompileLogger.scala.html#19502" title="(=&gt; String)Unit">debug</a>(<span title="java.lang.String(&quot;Getting &quot;)" class="string">&quot;Getting &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="ComponentCompiler.scala.html#12586" title="object xsbt.ComponentCompiler">ComponentCompiler</a>.<a href="ComponentCompiler.scala.html#64942" title="=&gt; java.lang.String">compilerInterfaceID</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; from component compiler for Scala &quot;)" class="string">&quot; from component compiler for Scala &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#23068" title="=&gt; String">version</a>)
		<a href="ComponentCompiler.scala.html#64957" title="(String)java.io.File">componentCompiler</a>(<a href="ComponentCompiler.scala.html#12586" title="object xsbt.ComponentCompiler">ComponentCompiler</a>.<a href="ComponentCompiler.scala.html#64942" title="=&gt; java.lang.String">compilerInterfaceID</a>)
	}
	<span class="keyword">def</span> <a title="(xsbt.CompileLogger)xsbt.ComponentCompiler" id="27020">newComponentCompiler</a>(<a title="xsbt.CompileLogger" id="66052">log</a>: <a href="CompileLogger.scala.html#12174" title="xsbt.CompileLogger">CompileLogger</a>) = <span title="xsbt.ComponentCompiler" class="keyword">new</span> <a href="ComponentCompiler.scala.html#12585" title="xsbt.ComponentCompiler">ComponentCompiler</a>(<span title="xsbt.RawCompiler" class="keyword">new</span> <a href="RawCompiler.scala.html#12456" title="xsbt.RawCompiler">RawCompiler</a>(<a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>, <span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="#66052" title="xsbt.CompileLogger">log</a>), <a href="#27054" title="=&gt; sbt.ComponentManager">manager</a>)
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(java.lang.ClassLoader,java.lang.ClassLoader)java.lang.ClassLoader" id="27021">createDualLoader</a>(<a title="java.lang.ClassLoader" id="66074">scalaLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="java.lang.ClassLoader" id="66075">sbtLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> =
	{
		<span class="keyword">val</span> <a title="(String) =&gt; Boolean" id="66288">xsbtiFilter</a> = (<a title="String" id="66291">name</a>: <span title="String">String</span>) =&gt; <a href="#66291" title="String">name</a>.<a title="(java.lang.String)Boolean" id="5786">startsWith</a>(<span title="java.lang.String(&quot;xsbti.&quot;)" class="string">&quot;xsbti.&quot;</span>)
		<span class="keyword">val</span> <a title="(String) =&gt; Boolean" id="66289">notXsbtiFilter</a> = (<a title="String" id="66294">name</a>: <span title="String">String</span>) =&gt; <a title="=&gt; Boolean" id="2695">!</a><a href="#66288" title="(String)Boolean" id="16333">xsbtiFilter</a>(<a href="#66294" title="String">name</a>)
		<span title="xsbt.DualLoader" class="keyword">new</span> <a href="DualLoader.scala.html#12780" title="xsbt.DualLoader">DualLoader</a>(<a href="#66074" title="java.lang.ClassLoader">scalaLoader</a>, <a href="#66289" title="(String) =&gt; Boolean">notXsbtiFilter</a>, <a title="String" id="66297">x</a> =&gt; <span title="Boolean(true)" class="keyword">true</span>, <a href="#66075" title="java.lang.ClassLoader">sbtLoader</a>, <a href="#66288" title="(String) =&gt; Boolean">xsbtiFilter</a>, <a title="String" id="66299">x</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>)
	}
	<span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="27022">toString</a> = <span title="java.lang.String(&quot;Analyzing compiler (Scala &quot;)" class="string">&quot;Analyzing compiler (Scala &quot;</span> <span title="(Any)java.lang.String">+</span> <a href="#27053" title="=&gt; xsbt.ScalaInstance">scalaInstance</a>.<a href="ScalaInstance.scala.html#23080" title="=&gt; java.lang.String">actualVersion</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
}
        </pre>
    </body>
</html>