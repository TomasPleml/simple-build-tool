<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>Connection.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2009, 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> xsbt.remote

<span class="keyword">trait</span> <a title="trait Connection extends java.lang.Object" id="2110">Connection</a>
{
	<span class="comment">/** Tell the remote client to execute the given command.
	* Waits for the client to return &quot;true&quot; or &quot;false&quot; indicating
	*  whether the command succeeded or failure.  This result
	* is then passed on to the caller of this method.
	* Exceptions from the underlying I/O code are not handled.
	*/</span>
	<span class="keyword">def</span> <a title="(String)Boolean" id="91306">execute</a>(<a title="String" id="91311">command</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span>
	<span class="comment">/** Force the server to shutdown.  Shutdown is normally handled automatically when done sending commands, however this can
	* be useful to shutdown the server from another thread.*/</span>
	<span class="keyword">def</span> <a title="()Unit" id="91307">forceShutdown</a>(): <span title="Unit">Unit</span>
	<span class="comment">/** Receive a message.*/</span>
	<span class="keyword">def</span> <a title="()String" id="91308">receive</a>(): <span title="String">String</span>
	<span class="comment">/** Send a message.*/</span>
	<span class="keyword">def</span> <a title="(String)Unit" id="91309">send</a>(<a title="String" id="91312">message</a>: <span title="String">String</span>): <span title="Unit">Unit</span>
}
<span class="keyword">object</span> <a title="object xsbt.remote.Connection" id="14480">Connection</a>
{
	<span class="comment">// Starts up a server that listens on a port on loopback.  That port is provided to</span>
	<span class="comment">// the 'fork', which should initialize the client with the port and</span>
	<span class="comment">//   use the provided connection to execute commands.</span>
	<span class="comment">// The server is shutdown when this method returns.</span>
	<span class="keyword">def</span> <a title="[T]((Int, xsbt.remote.Connection) =&gt; T)T" id="91314">apply</a>[<a title="&gt;: Nothing &lt;: Any" id="91316">T</a>](<a title="(Int, xsbt.remote.Connection) =&gt; T" id="91321">f</a>: (Int, Connection) =&gt; T): <a href="#91316" title="T">T</a> =
		<a href="IPC.scala.html#12594" title="object xsbt.IPC">IPC</a>.<a href="IPC.scala.html#47547" title="((xsbt.IPC.Server) =&gt; T)T">pullServer</a> { <a title="xsbt.IPC.Server" id="91324">server</a> =&gt;
			<a href="#91317" title="(xsbt.IPC.Server)((xsbt.remote.Connection) =&gt; T)T">apply</a>(<a href="#91324" title="xsbt.IPC.Server">server</a>)(<a href="#91321" title="(Int,xsbt.remote.Connection)T" id="25922">f</a>(<a href="#91324" title="xsbt.IPC.Server">server</a>.<a href="IPC.scala.html#47846" title="=&gt; Int">port</a>, <a href="#91334" title="xsbt.remote.Connection">_</a>))
		}

	<span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](xsbt.IPC.Server)((xsbt.remote.Connection) =&gt; T)T" id="91317">apply</a>[<a title="&gt;: Nothing &lt;: Any" id="91319">T</a>](<a title="xsbt.IPC.Server" id="91326">server</a>: IPC.<a href="IPC.scala.html#47563" title="xsbt.IPC.Server">Server</a>)(<a title="(xsbt.remote.Connection) =&gt; T" id="91327">f</a>: Connection =&gt; T): <a href="#91319" title="T">T</a> = <a href="#91327" title="(xsbt.remote.Connection)T" id="16544">f</a>(<span title="xsbt.remote.Connection0" class="keyword">new</span> <a href="#14485" title="xsbt.remote.Connection0">Connection0</a>(<a href="#91326" title="xsbt.IPC.Server">server</a>))
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class Connection0 extends java.lang.Object with xsbt.remote.Connection with ScalaObject" id="14485">Connection0</a>(<a title="xsbt.IPC.Server" id="91342">server</a>: IPC.<a href="IPC.scala.html#47563" title="xsbt.IPC.Server">Server</a>) <span class="keyword">extends</span> <a href="#2110" title="xsbt.remote.Connection">Connection</a>
{
	<span class="keyword">def</span> <a title="()Unit" id="91338">forceShutdown</a>() { <a href="#91342" title="xsbt.IPC.Server">server</a>.<a href="IPC.scala.html#47847" title="()Unit">close</a>() }
	<span class="keyword">def</span> <a title="(String)Boolean" id="91339">execute</a>(<a title="String" id="91345">command</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> =
	{
		<a href="#91341" title="(String)Unit">send</a>(<a href="#91345" title="String">command</a>)
		<a href="#91340" title="implicit scala.Predef.stringWrapper : (String)scala.runtime.RichString" id="787">receive</a>().<a title="=&gt; Boolean" id="17237">toBoolean</a>
	}
	<span class="keyword">def</span> <a title="()String" id="91340">receive</a>() = <a href="#91342" title="xsbt.IPC.Server">server</a>.<a href="IPC.scala.html#47848" title="((xsbt.IPC) =&gt; String)String">connection</a> { <a href="#91354" title="xsbt.IPC">_</a>.<a href="IPC.scala.html#47789" title="=&gt; String">receive</a> }
	<span class="keyword">def</span> <a title="(String)Unit" id="91341">send</a>(<a title="String" id="91346">command</a>: <span title="String">String</span>) = <a href="#91342" title="xsbt.IPC.Server">server</a>.<a href="IPC.scala.html#47848" title="((xsbt.IPC) =&gt; Unit)Unit">connection</a> { <a href="#91350" title="xsbt.IPC">_</a>.<a href="IPC.scala.html#47788" title="(String)Unit">send</a>(<a href="#91346" title="String">command</a>) }
}
        </pre>
    </body>
</html>