<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>sbt/ClasspathUtilities.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2008, 2009 Mark Harrah
 */</span>
<span class="keyword">package</span> sbt

<span class="keyword">import</span> java.io.File
<span class="keyword">import</span> java.net.{URI, URL, URLClassLoader}
<span class="keyword">import</span> java.util.Collections
<span class="keyword">import</span> scala.collection.Set
<span class="keyword">import</span> scala.collection.mutable.{HashSet, ListBuffer}

<span class="keyword">object</span> <a title="object sbt.ClasspathUtilities" id="11449">ClasspathUtilities</a>
{
	<span class="keyword">def</span> <a title="(sbt.PathFinder)Array[java.net.URL]" id="30465">toClasspath</a>(<a title="sbt.PathFinder" id="39319">finder</a>: <a href="Path.scala.html#8784" title="sbt.PathFinder">PathFinder</a>): <span title="Array[java.net.URL]">Array</span>[URL] = <a href="#39319" title="sbt.PathFinder">finder</a>.<a href="Path.scala.html#16192" title="=&gt; Array[java.net.URL]">getURLs</a>
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path])Array[java.net.URL]" id="30466">toClasspath</a>(<a title="Iterable[sbt.Path]" id="39321">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="Array[java.net.URL]">Array</span>[URL] = <a href="Path.scala.html#10201" title="object sbt.Path">Path</a>.<a href="Path.scala.html#15590" title="(Iterable[sbt.Path])Array[java.net.URL]">getURLs</a>(<a href="#39321" title="Iterable[sbt.Path]">paths</a>)
	<span class="keyword">def</span> <a title="(sbt.PathFinder)java.lang.ClassLoader" id="30467">toLoader</a>(<a title="sbt.PathFinder" id="33323">finder</a>: <a href="Path.scala.html#8784" title="sbt.PathFinder">PathFinder</a>): <span title="java.lang.ClassLoader">ClassLoader</span> = <a href="#30469" title="(Iterable[sbt.Path])java.lang.ClassLoader">toLoader</a>(<a href="#33323" title="sbt.PathFinder">finder</a>.<a href="Path.scala.html#16189" title="=&gt; scala.collection.Set[sbt.Path]">get</a>)
	<span class="keyword">def</span> <a title="(sbt.PathFinder,java.lang.ClassLoader)java.lang.ClassLoader" id="30468">toLoader</a>(<a title="sbt.PathFinder" id="33321">finder</a>: <a href="Path.scala.html#8784" title="sbt.PathFinder">PathFinder</a>, <a title="java.lang.ClassLoader" id="33322">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> = <a href="#30470" title="(Iterable[sbt.Path],java.lang.ClassLoader)java.lang.ClassLoader">toLoader</a>(<a href="#33321" title="sbt.PathFinder">finder</a>.<a href="Path.scala.html#16189" title="=&gt; scala.collection.Set[sbt.Path]">get</a>, <a href="#33322" title="java.lang.ClassLoader">parent</a>)
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path])java.lang.ClassLoader" id="30469">toLoader</a>(<a title="Iterable[sbt.Path]" id="33312">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="java.net.URLClassLoader" class="keyword">new</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#30466" title="(Iterable[sbt.Path])Array[java.net.URL]">toClasspath</a>(<a href="#33312" title="Iterable[sbt.Path]">paths</a>), <a href="#30471" title="=&gt; java.lang.ClassLoader">rootLoader</a>)
	<span class="keyword">def</span> <a title="(Iterable[sbt.Path],java.lang.ClassLoader)java.lang.ClassLoader" id="30470">toLoader</a>(<a title="Iterable[sbt.Path]" id="33310">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path], <a title="java.lang.ClassLoader" id="33311">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="java.net.URLClassLoader" class="keyword">new</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#30466" title="(Iterable[sbt.Path])Array[java.net.URL]">toClasspath</a>(<a href="#33310" title="Iterable[sbt.Path]">paths</a>), <a href="#33311" title="java.lang.ClassLoader">parent</a>)
	
	<span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.lang.ClassLoader" id="30472">rootLoader</a> =
	{
		<span class="keyword">def</span> <a title="(java.lang.ClassLoader)java.lang.ClassLoader" id="39386">parent</a>(<a title="java.lang.ClassLoader" id="39387">loader</a>: <span title="java.lang.ClassLoader">ClassLoader</span>): <span title="java.lang.ClassLoader">ClassLoader</span> =
		{
			<span class="keyword">val</span> <a title="java.lang.ClassLoader" id="39388">p</a> = <a href="#39387" title="java.lang.ClassLoader">loader</a>.<a title="()java.lang.ClassLoader" id="24032">getParent</a>
			<span title="java.lang.ClassLoader" class="keyword">if</span>(<a href="#39388" title="java.lang.ClassLoader">p</a> <a title="(AnyRef)Boolean" id="5739">eq</a> <span title="Null(null)" class="keyword">null</span>) <a href="#39387" title="java.lang.ClassLoader">loader</a> <span class="keyword">else</span> <a href="#39386" title="(java.lang.ClassLoader)java.lang.ClassLoader">parent</a>(<a href="#39388" title="java.lang.ClassLoader">p</a>)
		}
		<a href="#39386" title="(java.lang.ClassLoader)java.lang.ClassLoader">parent</a>(<a title="()java.lang.Class[_ &lt;: java.lang.Object]" id="3459">getClass</a>.<span title="()java.lang.ClassLoader">getClassLoader</span>)
	}
	
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Class[_])Unit" id="30473">printSource</a>(<a title="Class[_]" id="39406">c</a>: <span title="Class[_]">Class</span>[_]) =
		<a title="(Any)Unit" id="6197">println</a>(<a href="#39406" title="Class[_]">c</a>.<a title="()java.lang.String" id="3899">getName</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; loader=&quot;)" class="string">&quot; loader=&quot;</span> <span title="(Any)java.lang.String">+</span><a href="#39406" title="Class[_]">c</a>.<span title="()java.lang.ClassLoader">getClassLoader</span> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot; location=&quot;)" class="string">&quot; location=&quot;</span> <span title="(Any)java.lang.String">+</span> <a href="FileUtilities.scala.html#9085" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15539" title="(Class[_])java.io.File">classLocationFile</a>(<a href="#39406" title="Class[_]">c</a>))
	
	<span class="keyword">def</span> <a title="(sbt.Path)Boolean" id="30474">isArchive</a>(<a title="sbt.Path" id="30495">path</a>: <a href="Path.scala.html#10200" title="sbt.Path">Path</a>): <span title="Boolean">Boolean</span> = <a href="#30475" title="(java.io.File)Boolean">isArchive</a>(<a href="#30495" title="sbt.Path">path</a>.<a href="Path.scala.html#18076" title="=&gt; java.io.File">asFile</a>)
	<span class="keyword">def</span> <a title="(java.io.File)Boolean" id="30475">isArchive</a>(<a title="java.io.File" id="30494">file</a>: <span title="java.io.File">File</span>): <span title="Boolean">Boolean</span> = <a href="#30476" title="(String)Boolean">isArchiveName</a>(<a href="#30494" title="java.io.File">file</a>.<a title="()java.lang.String" id="16219">getName</a>)
	<span class="keyword">def</span> <a title="(String)Boolean" id="30476">isArchiveName</a>(<a title="String" id="39421">fileName</a>: <span title="String">String</span>) = <a href="#39421" title="String">fileName</a>.<span title="(java.lang.String)Boolean">endsWith</span>(<span title="java.lang.String(&quot;.jar&quot;)" class="string">&quot;.jar&quot;</span>) <span title="(Boolean)Boolean">||</span> <a href="#39421" title="String">fileName</a>.<span title="(java.lang.String)Boolean">endsWith</span>(<span title="java.lang.String(&quot;.zip&quot;)" class="string">&quot;.zip&quot;</span>)
	<span class="comment">// Partitions the given classpath into (jars, directories)</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])" id="30477">separate</a>(<a title="Iterable[java.io.File]" id="39423">paths</a>: <span title="Iterable[java.io.File]">Iterable</span>[File]): <span title="(Iterable[java.io.File], Iterable[java.io.File])">(</span>Iterable[File], Iterable[File]) = <a href="#39423" title="Iterable[java.io.File]">paths</a>.<a title="((java.io.File) =&gt; Boolean)(Iterable[java.io.File], Iterable[java.io.File])" id="16276">partition</a>(<a href="#30475" title="(java.io.File)Boolean">isArchive</a>)
	<span class="comment">// Partitions the given classpath into (jars, directories)</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])" id="30478">separatePaths</a>(<a title="Iterable[sbt.Path]" id="39428">paths</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]) = <a href="#30477" title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])">separate</a>(<a href="#39428" title="Iterable[sbt.Path]">paths</a>.<a title="((sbt.Path) =&gt; java.io.File)Iterable[java.io.File]" id="16271">map</a>(<a href="#39432" title="sbt.Path">_</a>.<a href="Path.scala.html#18076" title="=&gt; java.io.File">asFile</a>.<span title="()java.io.File">getCanonicalFile</span>))
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[sbt.Path])(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])" id="30479">buildSearchPaths</a>(<a title="Iterable[sbt.Path]" id="39433">classpath</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])">(</span>wrap.Set[File], wrap.Set[File]) =
	{
		<span class="keyword">val</span> <a href="#39435" title="(Iterable[java.io.File], Iterable[java.io.File])">(</a><a href="#39434" title="Iterable[java.io.File]" id="39435">jars</a>, <a href="#39434" title="Iterable[java.io.File]" id="39436">dirs</a>) = <a href="#30478" title="(Iterable[sbt.Path])(Iterable[java.io.File], Iterable[java.io.File])">separatePaths</a>(<a href="#39433" title="Iterable[sbt.Path]">classpath</a>)
		<span title="(sbt.wrap.Set[java.io.File],sbt.wrap.Set[java.io.File])(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])">(</span><a href="#30490" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39435" title="Iterable[java.io.File]">jars</a> <span title="(Iterable[java.io.File])Collection[java.io.File]">++</span> <a href="#30486" title="=&gt; sbt.wrap.Set[java.io.File]">extraJars</a>.<a href="wrap/Wrappers.scala.html#16340" title="=&gt; List[java.io.File]">toList</a>), <a href="#30490" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39436" title="Iterable[java.io.File]">dirs</a> <span title="(Iterable[java.io.File])Collection[java.io.File]">++</span> <a href="#30488" title="=&gt; sbt.wrap.Set[java.io.File]">extraDirs</a>.<a href="wrap/Wrappers.scala.html#16340" title="=&gt; List[java.io.File]">toList</a>))
	}
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(sbt.wrap.Set[java.io.File],sbt.wrap.Set[java.io.File],java.io.File)Boolean" id="30480">onClasspath</a>(<a title="sbt.wrap.Set[java.io.File]" id="39994">classpathJars</a>: wrap.<a href="wrap/Wrappers.scala.html#14317" title="sbt.wrap.Set[java.io.File]">Set</a>[File], <a title="sbt.wrap.Set[java.io.File]" id="39995">classpathDirectories</a>: wrap.<a href="wrap/Wrappers.scala.html#14317" title="sbt.wrap.Set[java.io.File]">Set</a>[File], <a title="java.io.File" id="39996">file</a>: <span title="java.io.File">File</span>): <span title="Boolean">Boolean</span> =
	{
		<span class="keyword">val</span> <a title="java.io.File" id="39997">f</a> = <a href="#39996" title="java.io.File">file</a>.<span title="()java.io.File">getCanonicalFile</span>
		<span title="Boolean" class="keyword">if</span>(<a href="#11449" title="object sbt.ClasspathUtilities">ClasspathUtilities</a>.<a href="#30475" title="(java.io.File)Boolean">isArchive</a>(<a href="#39997" title="java.io.File">f</a>))
			<a href="#39994" title="sbt.wrap.Set[java.io.File]">classpathJars</a>.<a href="wrap/Wrappers.scala.html#16342" title="(java.io.File)Boolean">contains</a>(<a href="#39997" title="java.io.File">f</a>)
		<span class="keyword">else</span>
			<a href="#39995" title="sbt.wrap.Set[java.io.File]">classpathDirectories</a>.<a href="wrap/Wrappers.scala.html#16340" title="=&gt; List[java.io.File]">toList</a>.<a title="((java.io.File) =&gt; Boolean)Option[java.io.File]" id="17975">find</a>(<a href="Path.scala.html#10201" title="object sbt.Path">Path</a>.<a href="Path.scala.html#15580" title="(java.io.File,java.io.File)Option[String]">relativize</a>(<a href="#40002" title="java.io.File">_</a>, <a href="#39997" title="java.io.File">f</a>).<span title="=&gt; Boolean">isDefined</span>).<span title="=&gt; Boolean">isDefined</span>
	}
	
	<span class="comment">/** Returns all entries in 'classpath' that correspond to a compiler plugin.*/</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Iterable[sbt.Path])Iterable[java.io.File]" id="30481">compilerPlugins</a>(<a title="Iterable[sbt.Path]" id="40005">classpath</a>: <span title="Iterable[sbt.Path]">Iterable</span>[Path]): <span title="Iterable[java.io.File]">Iterable</span>[File] =
	{
		<span class="keyword">val</span> <a title="java.net.URLClassLoader" id="40006">loader</a> = <a title="(Array[java.net.URL])java.net.URLClassLoader" id="39341" class="keyword">new</a> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="Path.scala.html#10201" title="object sbt.Path">Path</a>.<a href="Path.scala.html#15590" title="(Iterable[sbt.Path])Array[java.net.URL]">getURLs</a>(<a href="#40005" title="Iterable[sbt.Path]">classpath</a>))
		wrap.<a href="wrap/Wrappers.scala.html#14270" title="object sbt.wrap.Wrappers">Wrappers</a>.<a href="wrap/Wrappers.scala.html#18254" title="(java.util.Enumeration[java.net.URL])List[java.net.URL]">toList</a>(<a href="#40006" title="java.net.URLClassLoader">loader</a>.<a title="(java.lang.String)java.util.Enumeration[java.net.URL]" id="23621">getResources</a>(<span title="java.lang.String(&quot;scalac-plugin.xml&quot;)" class="string">&quot;scalac-plugin.xml&quot;</span>)).<a title="((java.net.URL) =&gt; Iterable[java.io.File])List[java.io.File]" id="17984">flatMap</a>(<a href="#30483" title="(Boolean)(java.net.URL)List[java.io.File]">asFile</a>(<span title="Boolean(true)" class="keyword">true</span>))
	}
	<span class="comment">/** Converts the given URL to a File.  If the URL is for an entry in a jar, the File for the jar is returned. */</span>
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(java.net.URL)List[java.io.File]" id="30482">asFile</a>(<a title="java.net.URL" id="40025">url</a>: <span title="java.net.URL">URL</span>): <span title="List[java.io.File]">List</span>[File] = <a href="#30483" title="(Boolean)(java.net.URL)List[java.io.File]">asFile</a>(<span title="Boolean(false)" class="keyword">false</span>)(<a href="#40025" title="java.net.URL">url</a>)
	<span class="keyword">private</span>[sbt] <span class="keyword">def</span> <a title="(Boolean)(java.net.URL)List[java.io.File]" id="30483">asFile</a>(<a title="Boolean" id="40023">jarOnly</a>: <span title="Boolean">Boolean</span>)(<a title="java.net.URL" id="40024">url</a>: <span title="java.net.URL">URL</span>): <span title="List[java.io.File]">List</span>[File] =
	{
		<span class="keyword">try</span>
		{
			<a href="#40024" title="java.net.URL">url</a>.<a title="()java.lang.String" id="25434">getProtocol</a> <span title="List[java.io.File]" class="keyword">match</span>
			{
				<span title="List[java.io.File]" class="keyword">case</span> <span title="java.lang.String(&quot;file&quot;)" class="string">&quot;file&quot;</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#40023" title="Boolean">jarOnly</a>=&gt; <a href="FileUtilities.scala.html#9085" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15535" title="(java.net.URL)java.io.File">toFile</a>(<a href="#40024" title="java.net.URL">url</a>) <a href="#40040" title="(java.io.File)List[java.io.File]">::</a> <span title="object Nil">Nil</span>
				<span title="List[java.io.File]" class="keyword">case</span> <span title="java.lang.String(&quot;jar&quot;)" class="string">&quot;jar&quot;</span> =&gt;
					<span class="keyword">val</span> <a title="java.lang.String" id="40049">path</a> = <a href="#40024" title="java.net.URL">url</a>.<a title="()java.lang.String" id="25429">getPath</a>
					<span class="keyword">val</span> <a title="Int" id="40050">end</a> = <a href="#40049" title="java.lang.String">path</a>.<a title="(Int)Int" id="5789">indexOf</a>(<span title="Int(33)" class="char">'!'</span>)
					<a title="(java.net.URI)java.io.File" id="16218" class="keyword">new</a> <span title="java.io.File">File</span>(<span title="java.net.URI" class="keyword">new</span> <a title="java.net.URI" id="4495">URI</a>(<span title="java.lang.String" class="keyword">if</span>(<a href="#40050" title="Int">end</a> <a title="(Int)Boolean" id="3089">==</a> -<span title="Int(-1)" class="int">1</span>) <a href="#40049" title="java.lang.String">path</a> <span class="keyword">else</span> <a href="#40049" title="java.lang.String">path</a>.<a title="(Int,Int)java.lang.String" id="5800">substring</a>(<span title="Int(0)" class="int">0</span>, <a href="#40050" title="Int">end</a>))) <a href="#40057" title="(java.io.File)List[java.io.File]">::</a> <span title="object Nil">Nil</span>
				<span title="Nil.type" class="keyword">case</span> _ =&gt; <span title="object Nil">Nil</span>
			}
		}
		<span class="keyword">catch</span> { <span title="Nil.type" class="keyword">case</span> <a title="Exception" id="40071">e</a>: <a title="Exception" id="2076">Exception</a> =&gt; <span title="object Nil">Nil</span> }
	}
	
	<span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a href="#30487" title="(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])" id="30485">(</a><a href="#30484" title="sbt.wrap.Set[java.io.File]" id="30487">extraJars</a>, <a href="#30484" title="sbt.wrap.Set[java.io.File]" id="30489">extraDirs</a>) =
	{
		<span class="keyword">import</span> scala.tools.nsc.GenericRunnerCommand
		<span class="keyword">val</span> <a title="scala.tools.nsc.GenericRunnerSettings" id="39448">settings</a> = (<a title="(List[String],(String) =&gt; Unit)scala.tools.nsc.GenericRunnerCommand" id="39459" class="keyword">new</a> <a title="scala.tools.nsc.GenericRunnerCommand" id="28291">GenericRunnerCommand</a>(<span title="object Nil">Nil</span>, <a title="String" id="39512">message</a> =&gt; <a title="(String)Nothing" id="6085">error</a>(<a href="#39512" title="String">message</a>))).<a title="=&gt; scala.tools.nsc.GenericRunnerSettings" id="39455">settings</a>
		<span class="keyword">val</span> <a title="List[java.io.File]" id="39449">bootPaths</a> = <a href="FileUtilities.scala.html#9085" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15428" title="(String)Array[java.lang.String]">pathSplit</a>(<a href="#39448" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a title="=&gt; settings.StringSetting" id="39685">bootclasspath</a>.<span title="=&gt; String">value</span>).<span title="((java.lang.String) =&gt; java.io.File)Array[java.io.File]">map</span>(<a title="java.lang.String" id="39925">p</a> =&gt; <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#39925" title="java.lang.String">p</a>)).<a title="=&gt; List[java.io.File]" id="16304">toList</a>
		<span class="keyword">val</span> <a href="#39451" title="(Iterable[java.io.File], Iterable[java.io.File])">(</a><a href="#39450" title="Iterable[java.io.File]" id="39451">bootJars</a>, <a href="#39450" title="Iterable[java.io.File]" id="39452">bootDirs</a>) = <a href="#30477" title="(Iterable[java.io.File])(Iterable[java.io.File], Iterable[java.io.File])">separate</a>(<a href="#39449" title="List[java.io.File]">bootPaths</a>)
		<span class="keyword">val</span> <a title="List[java.io.File]" id="39453">extJars</a> =
		{
			<span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[java.io.File]" id="39932">buffer</a> = <span title="scala.collection.mutable.ListBuffer[java.io.File]" class="keyword">new</span> <a title="scala.collection.mutable.ListBuffer[java.io.File]" id="15774">ListBuffer</a>[File]
			<span class="keyword">def</span> <a title="(java.io.File)Unit" id="39933">findJars</a>(<a title="java.io.File" id="39934">dir</a>: <span title="java.io.File">File</span>)
			{
				<a href="#39932" title="scala.collection.mutable.ListBuffer[java.io.File]">buffer</a> <a title="(Iterable[java.io.File])Unit" id="18724">++=</a> <a href="#39934" title="java.io.File">dir</a>.<span title="(java.io.FileFilter)Array[java.io.File]">listFiles</span>(<span title="sbt.SimpleFileFilter" class="keyword">new</span> <a href="NameFilter.scala.html#8157" title="sbt.SimpleFileFilter">SimpleFileFilter</a>(<a href="#30475" title="(java.io.File)Boolean">isArchive</a>))
				<span class="keyword">for</span>(<a title="((java.io.File) =&gt; Unit)Unit" id="39954">dir</a> &lt;- <a href="#39934" title="java.io.File">dir</a>.<span title="(java.io.FileFilter)Array[java.io.File]">listFiles</span>(<a href="NameFilter.scala.html#10888" title="object sbt.DirectoryFilter">DirectoryFilter</a>))
					<a href="#39933" title="(java.io.File)Unit">findJars</a>(<a href="#39954" title="java.io.File">dir</a>)
			}
			<span class="keyword">for</span>(<a title="(((java.lang.String, java.io.File)) =&gt; Unit)Unit" id="39971">path</a> &lt;- <a href="FileUtilities.scala.html#9085" title="object sbt.FileUtilities">FileUtilities</a>.<a href="FileUtilities.scala.html#15428" title="(String)Array[java.lang.String]">pathSplit</a>(<a href="#39448" title="scala.tools.nsc.GenericRunnerSettings">settings</a>.<a title="=&gt; settings.StringSetting" id="39687">extdirs</a>.<span title="=&gt; String">value</span>); <span class="keyword">val</span> <a title="java.io.File" id="39972">dir</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span>(<a href="#39971" title="java.lang.String">path</a>) <span class="keyword">if</span> <a href="#39972" title="java.io.File">dir</a>.<a title="()Boolean" id="16233">isDirectory</a>)
				<a href="#39933" title="(java.io.File)Unit">findJars</a>(<a href="#39972" title="java.io.File">dir</a>)
			<a href="#39932" title="scala.collection.mutable.ListBuffer[java.io.File]">buffer</a>.<a title="=&gt; List[java.io.File]" id="24688">readOnly</a>.<a title="((java.io.File) =&gt; java.io.File)List[java.io.File]" id="17963">map</a>(<a href="#39976" title="java.io.File">_</a>.<span title="()java.io.File">getCanonicalFile</span>)
		}
		<span title="(sbt.wrap.Set[java.io.File],sbt.wrap.Set[java.io.File])(sbt.wrap.Set[java.io.File], sbt.wrap.Set[java.io.File])">(</span><a href="#30490" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39453" title="List[java.io.File]">extJars</a> <a title="(Iterable[java.io.File])List[java.io.File]" id="17942">++</a> <a href="#39451" title="Iterable[java.io.File]">bootJars</a>), <a href="#30490" title="(Iterable[java.io.File])sbt.wrap.Set[java.io.File]">linkedSet</a>(<a href="#39452" title="Iterable[java.io.File]">bootDirs</a>))
	}
	<span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](Iterable[T])sbt.wrap.Set[T]" id="30490">linkedSet</a>[<a title="&gt;: Nothing &lt;: Any" id="30492">T</a>](<a title="Iterable[T]" id="39443">s</a>: <span title="Iterable[T]">Iterable</span>[T]): wrap.<a href="wrap/Wrappers.scala.html#14317" title="sbt.wrap.Set[T]">Set</a>[T] =
	{
		<span class="keyword">val</span> <a title="sbt.wrap.MutableSetWrapper[T]" id="40072">set</a> = <span title="sbt.wrap.MutableSetWrapper[T]" class="keyword">new</span> wrap.<a href="wrap/Wrappers.scala.html#14275" title="sbt.wrap.MutableSetWrapper[T]">MutableSetWrapper</a>(<a title="()java.util.LinkedHashSet[T]" id="16417" class="keyword">new</a> java.util.<a title="java.util.LinkedHashSet[T]" id="5547">LinkedHashSet</a>[T])
		<a href="#40072" title="sbt.wrap.MutableSetWrapper[T]">set</a> <a href="wrap/Wrappers.scala.html#16359" title="(Iterable[T])Unit">++=</a> <a href="#39443" title="Iterable[T]">s</a>
		<a href="#40072" title="sbt.wrap.MutableSetWrapper[T]">set</a>.<a href="wrap/Wrappers.scala.html#16354" title="=&gt; sbt.wrap.Set[T]">readOnly</a>
	}
}

<span class="keyword">private</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class LoaderBase extends java.net.URLClassLoader with NotNull with ScalaObject" id="6834">LoaderBase</a>(<a title="Array[java.net.URL]" id="40091">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40092">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>) <span class="keyword">extends</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#40091" title="Array[java.net.URL]">urls</a>, <a href="#40092" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span title="(Boolean)Unit">require</span>(<a href="#40092" title="java.lang.ClassLoader">parent</a> <span title="(AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	@<span title="throws">throws</span>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="40085">loadClass</a>(<a title="String" id="40115">className</a>: <span title="String">String</span>, <a title="Boolean" id="40116">resolve</a>: <span title="Boolean">Boolean</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span class="keyword">val</span> <a title="java.lang.Class[_]" id="40121">loaded</a> = <a href="#6834" title="(java.lang.String)java.lang.Class[_]" id="23614">findLoadedClass</a>(<a href="#40115" title="String">className</a>)
		<span class="keyword">val</span> <a title="java.lang.Class[_ &gt;: _$3 with ?0]" id="40122">found</a> =
			<span title="java.lang.Class[_50]" class="keyword">if</span>(<a href="#40121" title="java.lang.Class[_]">loaded</a> <span title="(AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>)
				<a href="#40086" title="(String)Class[_]">doLoadClass</a>(<a href="#40115" title="String">className</a>)
			<span class="keyword">else</span>
				<a href="#40121" title="java.lang.Class[_]">loaded</a>
			
		<span title="Unit" class="keyword">if</span>(<a href="#40116" title="Boolean">resolve</a>)
			<a href="#6834" title="(java.lang.Class[_])Unit">resolveClass</a>(<a href="#40122" title="java.lang.Class[_ &gt;: _$3 with ?0]">found</a>)
		<a href="#40122" title="java.lang.Class[_ &gt;: _$3 with ?0]">found</a>
	}
	<span class="keyword">protected</span> <span class="keyword">def</span> <a title="(String)Class[_]" id="40086">doLoadClass</a>(<a title="String" id="40126">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_]
	<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String)Class[_]" id="40087">selfLoadClass</a>(<a title="String" id="40165">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_] = <span class="keyword">super</span>.<span title="(java.lang.String,Boolean)java.lang.Class[_]">loadClass</span>(<a href="#40165" title="String">className</a>, <span title="Boolean(false)" class="keyword">false</span>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class IntermediateLoader extends sbt.LoaderBase with NotNull with ScalaObject" id="8649">IntermediateLoader</a>(<a title="Array[java.net.URL]" id="40189">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40190">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>) <span class="keyword">extends</span> <a href="#6834" title="sbt.LoaderBase">LoaderBase</a>(<a href="#40189" title="Array[java.net.URL]">urls</a>, <a href="#40190" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(String)Class[_]" id="40185">doLoadClass</a>(<a title="String" id="40191">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span class="comment">// if this loader is asked to load an sbt class, it must be because the project we are building is sbt itself,</span>
		 <span class="comment">// so we want to load the version of classes on the project classpath, not the parent</span>
		<span title="java.lang.Class[_51]" class="keyword">if</span>(<a href="#40191" title="String">className</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<a href="#7393" title="object sbt.Loaders">Loaders</a>.<a href="#40198" title="=&gt; java.lang.String">SbtPackage</a>))
			<a href="#8649" title="(java.lang.String)java.lang.Class[_]">findClass</a>(<a href="#40191" title="String">className</a>)
		<span class="keyword">else</span>
			<a href="#40087" title="(String)Class[_]">selfLoadClass</a>(<a href="#40191" title="String">className</a>)
	}
}
<span class="comment">/** Delegates class loading to `parent` for all classes included by `filter`.  An attempt to load classes excluded by `filter`
* results in a `ClassNotFoundException`.*/</span>
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class FilteredLoader extends java.lang.ClassLoader with NotNull with ScalaObject" id="11589">FilteredLoader</a>(<a title="java.lang.ClassLoader" id="33268">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="sbt.ClassFilter" id="33269">filter</a>: <a href="#2110" title="sbt.ClassFilter">ClassFilter</a>) <span class="keyword">extends</span> <span title="java.lang.ClassLoader">ClassLoader</span>(<a href="#33268" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span title="(Boolean)Unit">require</span>(<a href="#33268" title="java.lang.ClassLoader">parent</a> <span title="(AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	<span class="keyword">def</span> <a title="(java.lang.ClassLoader,Iterable[String])sbt.FilteredLoader" id="33263" class="keyword">this</a>(<a title="java.lang.ClassLoader" id="33266">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="Iterable[String]" id="33267">excludePackages</a>: <span title="Iterable[String]">Iterable</span>[String]) = <a href="#11589" title="FilteredLoader.this.type" class="keyword">this</a>(<a href="#33266" title="java.lang.ClassLoader">parent</a>, <span title="sbt.ExcludePackagesFilter" class="keyword">new</span> <a href="#10098" title="sbt.ExcludePackagesFilter">ExcludePackagesFilter</a>(<a href="#33267" title="Iterable[String]">excludePackages</a>))
	
	@<span title="throws">throws</span>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="33264">loadClass</a>(<a title="String" id="40245">className</a>: <span title="String">String</span>, <a title="Boolean" id="40246">resolve</a>: <span title="Boolean">Boolean</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span title="java.lang.Class[?0]" class="keyword">if</span>(<a href="#33269" title="sbt.ClassFilter">filter</a>.<a href="#33270" title="(String)Boolean">include</a>(<a href="#40245" title="String">className</a>))
			<span class="keyword">super</span>.<span title="(java.lang.String,Boolean)java.lang.Class[_]">loadClass</span>(<a href="#40245" title="String">className</a>, <a href="#40246" title="Boolean">resolve</a>)
		<span class="keyword">else</span>
			<span title="Nothing" class="keyword">throw</span> <a title="(java.lang.String)java.lang.ClassNotFoundException" id="32491" class="keyword">new</a> <a title="java.lang.ClassNotFoundException" id="1674">ClassNotFoundException</a>(<a href="#40245" title="String">className</a>)
	}
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class SelectiveLoader extends java.net.URLClassLoader with NotNull with ScalaObject" id="10215">SelectiveLoader</a>(<a title="Array[java.net.URL]" id="40276">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40277">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="sbt.ClassFilter" id="40278">filter</a>: <a href="#2110" title="sbt.ClassFilter">ClassFilter</a>) <span class="keyword">extends</span> <span title="java.net.URLClassLoader">URLClassLoader</span>(<a href="#40276" title="Array[java.net.URL]">urls</a>, <a href="#40277" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span title="(Boolean)Unit">require</span>(<a href="#40277" title="java.lang.ClassLoader">parent</a> <span title="(AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>) <span class="comment">// included because a null parent is legitimate in Java</span>
	<span class="keyword">def</span> <a title="(Array[java.net.URL],java.lang.ClassLoader,Iterable[String])sbt.SelectiveLoader" id="40270" class="keyword">this</a>(<a title="Array[java.net.URL]" id="40299">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40300">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="Iterable[String]" id="40301">includePackages</a>: <span title="Iterable[String]">Iterable</span>[String]) = <a href="#10215" title="SelectiveLoader.this.type" class="keyword">this</a>(<a href="#40299" title="Array[java.net.URL]">urls</a>, <a href="#40300" title="java.lang.ClassLoader">parent</a>, <span title="sbt.IncludePackagesFilter" class="keyword">new</span> <a href="#7362" title="sbt.IncludePackagesFilter">IncludePackagesFilter</a>(<a href="#40301" title="Iterable[String]">includePackages</a>))
	
	@<span title="throws">throws</span>(<span title="java.lang.Class[java.lang.ClassNotFoundException]">classOf</span>[ClassNotFoundException])
	<span class="keyword">override</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String,Boolean)Class[_]" id="40271">loadClass</a>(<a title="String" id="40310">className</a>: <span title="String">String</span>, <a title="Boolean" id="40311">resolve</a>: <span title="Boolean">Boolean</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span title="java.lang.Class[_52]" class="keyword">if</span>(<a href="#40278" title="sbt.ClassFilter">filter</a>.<a href="#33270" title="(String)Boolean">include</a>(<a href="#40310" title="String">className</a>))
			<span class="keyword">super</span>.<span title="(java.lang.String,Boolean)java.lang.Class[_]">loadClass</span>(<a href="#40310" title="String">className</a>, <a href="#40311" title="Boolean">resolve</a>)
		<span class="keyword">else</span>
		{
			<span class="keyword">val</span> <a title="java.lang.Class[_]" id="40326">loaded</a> = <a href="#40277" title="java.lang.ClassLoader">parent</a>.<span title="(java.lang.String)java.lang.Class[_]">loadClass</span>(<a href="#40310" title="String">className</a>)
			<span title="Unit" class="keyword">if</span>(<a href="#40311" title="Boolean">resolve</a>)
				<a href="#10215" title="(java.lang.Class[_])Unit">resolveClass</a>(<a href="#40326" title="java.lang.Class[_]">loaded</a>)
			<a href="#40326" title="java.lang.Class[_]">loaded</a>
		}
	}
}
<span class="keyword">private</span> <span class="keyword">trait</span> <a title="trait ClassFilter extends java.lang.Object" id="2110">ClassFilter</a>
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="33270">include</a>(<a title="String" id="40251">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span>
}
<span class="keyword">private</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class PackageFilter extends java.lang.Object with sbt.ClassFilter with ScalaObject" id="8331">PackageFilter</a>(<a title="Iterable[String]" id="40355">packages</a>: <span title="Iterable[String]">Iterable</span>[String]) <span class="keyword">extends</span> <a href="#2110" title="sbt.ClassFilter">ClassFilter</a>
{
	<span title="(Boolean)Unit">require</span>(<a href="#40355" title="Iterable[String]">packages</a>.<a title="((String) =&gt; Boolean)Boolean" id="16282">forall</a>(<a href="#40358" title="String">_</a>.<span title="(java.lang.String)Boolean">endsWith</span>(<span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span>)))
	<span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(String)Boolean" id="40238">matches</a>(<a title="String" id="40359">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#40355" title="Iterable[String]">packages</a>.<a title="((String) =&gt; Boolean)Boolean" id="16283">exists</a>(<a href="#40359" title="String">className</a>.<a href="#40362" title="(java.lang.String)Boolean">startsWith</a>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class ExcludePackagesFilter extends sbt.PackageFilter with ScalaObject" id="10098">ExcludePackagesFilter</a>(<a title="Iterable[String]" id="40243">exclude</a>: <span title="Iterable[String]">Iterable</span>[String]) <span class="keyword">extends</span> <a href="#8331" title="sbt.PackageFilter">PackageFilter</a>(<a href="#40243" title="Iterable[String]">exclude</a>)
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="40242">include</a>(<a title="String" id="40366">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <span title="=&gt; Boolean">!</span><a href="#40238" title="(String)Boolean">matches</a>(<a href="#40366" title="String">className</a>)
}
<span class="keyword">private</span> <span class="keyword">class</span> <a title="class IncludePackagesFilter extends sbt.PackageFilter with ScalaObject" id="7362">IncludePackagesFilter</a>(<a title="Iterable[String]" id="40308">include</a>: <span title="Iterable[String]">Iterable</span>[String]) <span class="keyword">extends</span> <a href="#8331" title="sbt.PackageFilter">PackageFilter</a>(<a href="#40308" title="Iterable[String]">include</a>)
{
	<span class="keyword">def</span> <a title="(String)Boolean" id="40307">include</a>(<a title="String" id="40369">className</a>: <span title="String">String</span>): <span title="Boolean">Boolean</span> = <a href="#40238" title="(String)Boolean">matches</a>(<a href="#40369" title="String">className</a>)
}

<span class="keyword">private</span> <span class="keyword">class</span> <a title="class LazyFrameworkLoader extends sbt.LoaderBase with NotNull with ScalaObject" id="10554">LazyFrameworkLoader</a>(<a title="String" id="40385">runnerClassName</a>: <span title="String">String</span>, <a title="Array[java.net.URL]" id="40386">urls</a>: <span title="Array[java.net.URL]">Array</span>[URL], <a title="java.lang.ClassLoader" id="40387">parent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>, <a title="java.lang.ClassLoader" id="40388">grandparent</a>: <span title="java.lang.ClassLoader">ClassLoader</span>)
	<span class="keyword">extends</span> <a href="#6834" title="sbt.LoaderBase">LoaderBase</a>(<a href="#40386" title="Array[java.net.URL]">urls</a>, <a href="#40387" title="java.lang.ClassLoader">parent</a>) <span class="keyword">with</span> <span title="NotNull">NotNull</span>
{
	<span class="keyword">def</span> <a title="(String)Class[_]" id="40379">doLoadClass</a>(<a title="String" id="40389">className</a>: <span title="String">String</span>): <span title="Class[_]">Class</span>[_] =
	{
		<span title="java.lang.Class[_54]" class="keyword">if</span>(<a href="#7393" title="object sbt.Loaders">Loaders</a>.<a href="#40200" title="(String,String)Boolean">isNestedOrSelf</a>(<a href="#40389" title="String">className</a>, <a href="#40385" title="String">runnerClassName</a>))
			<a href="#10554" title="(java.lang.String)java.lang.Class[_]">findClass</a>(<a href="#40389" title="String">className</a>)
		<span class="keyword">else</span> <span title="java.lang.Class[_53]" class="keyword">if</span>(<a href="#7393" title="object sbt.Loaders">Loaders</a>.<a href="#40201" title="(String)Boolean">isSbtClass</a>(<a href="#40389" title="String">className</a>)) <span class="comment">// we circumvent the parent loader because we know that we want the</span>
			<a href="#40388" title="java.lang.ClassLoader">grandparent</a>.<span title="(java.lang.String)java.lang.Class[_]">loadClass</span>(<a href="#40389" title="String">className</a>)              <span class="comment">// version of sbt that is currently the builder (not the project being built)</span>
		<span class="keyword">else</span>
			<a href="#40387" title="java.lang.ClassLoader">parent</a>.<span title="(java.lang.String)java.lang.Class[_]">loadClass</span>(<a href="#40389" title="String">className</a>)
	}
}
<span class="keyword">private</span> <span class="keyword">object</span> <a title="object sbt.Loaders" id="7393">Loaders</a>
{
	<span class="keyword">val</span> <a title="java.lang.String" id="40198">SbtPackage</a> = <span title="java.lang.String(&quot;sbt.&quot;)" class="string">&quot;sbt.&quot;</span>
	<span class="keyword">def</span> <a title="(String,String)Boolean" id="40200">isNestedOrSelf</a>(<a title="String" id="40394">className</a>: <span title="String">String</span>, <a title="String" id="40395">checkAgainst</a>: <span title="String">String</span>) =
		<a href="#40394" title="String">className</a> <span title="(AnyRef)Boolean">==</span> <a href="#40395" title="String">checkAgainst</a> <span title="(Boolean)Boolean">||</span> <a href="#40394" title="String">className</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<a href="#40395" title="String">checkAgainst</a> <span title="(Any)java.lang.String">+</span> <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span>)
	<span class="keyword">def</span> <a title="(String)Boolean" id="40201">isSbtClass</a>(<a title="String" id="40400">className</a>: <span title="String">String</span>) = <a href="#40400" title="String">className</a>.<span title="(java.lang.String)Boolean">startsWith</span>(<a href="#7393" title="object sbt.Loaders">Loaders</a>.<a href="#40198" title="=&gt; java.lang.String">SbtPackage</a>)
}
        </pre>
    </body>
</html>